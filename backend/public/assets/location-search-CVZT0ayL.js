import{c as ge,r as a,z as P,P as j,W as K,j as k,b as V,D as Re,t as Ce}from"./index-28yYTQYt.js";import{I as je}from"./loading-button-BkylZ5sb.js";import{u as Ne}from"./useQuery-fXf16oON.js";import{R as Ae,P as $e,O as Fe,C as Me}from"./index.esm-Bnp_jBhY.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],pt=ge("check",De);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],gt=ge("navigation",Pe);function Le(e,n){const[t,u]=a.useState(e);return a.useEffect(()=>{const o=setTimeout(()=>{u(e)},n);return()=>{clearTimeout(o)}},[e,n]),t}var me=1,_e=.9,Ke=.8,Ve=.17,ee=.1,te=.999,qe=.9999,ze=.99,Te=/[\\\/_+.#"@\[\(\{&]/,Oe=/[\\\/_+.#"@\[\(\{&]/g,Be=/[\s-]/,be=/[\s-]/g;function ne(e,n,t,u,o,s,d){if(s===n.length)return o===e.length?me:ze;var f=`${o},${s}`;if(d[f]!==void 0)return d[f];for(var b=u.charAt(s),i=t.indexOf(b,o),h=0,p,g,y,R;i>=0;)p=ne(e,n,t,u,i+1,s+1,d),p>h&&(i===o?p*=me:Te.test(e.charAt(i-1))?(p*=Ke,y=e.slice(o,i-1).match(Oe),y&&o>0&&(p*=Math.pow(te,y.length))):Be.test(e.charAt(i-1))?(p*=_e,R=e.slice(o,i-1).match(be),R&&o>0&&(p*=Math.pow(te,R.length))):(p*=Ve,o>0&&(p*=Math.pow(te,i-o))),e.charAt(i)!==n.charAt(s)&&(p*=qe)),(p<ee&&t.charAt(i-1)===u.charAt(s+1)||u.charAt(s+1)===u.charAt(s)&&t.charAt(i-1)!==u.charAt(s))&&(g=ne(e,n,t,u,i+1,s+2,d),g*ee>p&&(p=g*ee)),p>h&&(h=p),i=t.indexOf(b,i+1);return d[f]=h,h}function he(e){return e.toLowerCase().replace(be," ")}function Ue(e,n,t){return e=t&&t.length>0?`${e+" "+t.join(" ")}`:e,ne(e,n,he(e),he(n),0,0,{})}var _='[cmdk-group=""]',re='[cmdk-group-items=""]',Ge='[cmdk-group-heading=""]',xe='[cmdk-item=""]',ve=`${xe}:not([aria-disabled="true"])`,ae="cmdk-item-select",M="data-value",Qe=(e,n,t)=>Ue(e,n,t),we=a.createContext(void 0),q=()=>a.useContext(we),ke=a.createContext(void 0),le=()=>a.useContext(ke),ye=a.createContext(void 0),Ee=a.forwardRef((e,n)=>{let t=D(()=>{var r,c;return{search:"",value:(c=(r=e.value)!=null?r:e.defaultValue)!=null?c:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),u=D(()=>new Set),o=D(()=>new Map),s=D(()=>new Map),d=D(()=>new Set),f=Se(e),{label:b,children:i,value:h,onValueChange:p,filter:g,shouldFilter:y,loop:R,disablePointerSelection:U=!1,vimBindings:N=!0,...z}=e,G=P(),oe=P(),Q=P(),A=a.useRef(null),w=at();$(()=>{if(h!==void 0){let r=h.trim();t.current.value=r,S.emit()}},[h]),$(()=>{w(6,ue)},[]);let S=a.useMemo(()=>({subscribe:r=>(d.current.add(r),()=>d.current.delete(r)),snapshot:()=>t.current,setState:(r,c,m)=>{var l,v,x,I;if(!Object.is(t.current[r],c)){if(t.current[r]=c,r==="search")X(),H(),w(1,J);else if(r==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let E=document.getElementById(Q);E?E.focus():(l=document.getElementById(G))==null||l.focus()}if(w(7,()=>{var E;t.current.selectedItemId=(E=F())==null?void 0:E.id,S.emit()}),m||w(5,ue),((v=f.current)==null?void 0:v.value)!==void 0){let E=c??"";(I=(x=f.current).onValueChange)==null||I.call(x,E);return}}S.emit()}},emit:()=>{d.current.forEach(r=>r())}}),[]),W=a.useMemo(()=>({value:(r,c,m)=>{var l;c!==((l=s.current.get(r))==null?void 0:l.value)&&(s.current.set(r,{value:c,keywords:m}),t.current.filtered.items.set(r,ie(c,m)),w(2,()=>{H(),S.emit()}))},item:(r,c)=>(u.current.add(r),c&&(o.current.has(c)?o.current.get(c).add(r):o.current.set(c,new Set([r]))),w(3,()=>{X(),H(),t.current.value||J(),S.emit()}),()=>{s.current.delete(r),u.current.delete(r),t.current.filtered.items.delete(r);let m=F();w(4,()=>{X(),(m==null?void 0:m.getAttribute("id"))===r&&J(),S.emit()})}),group:r=>(o.current.has(r)||o.current.set(r,new Set),()=>{s.current.delete(r),o.current.delete(r)}),filter:()=>f.current.shouldFilter,label:b||e["aria-label"],getDisablePointerSelection:()=>f.current.disablePointerSelection,listId:G,inputId:Q,labelId:oe,listInnerRef:A}),[]);function ie(r,c){var m,l;let v=(l=(m=f.current)==null?void 0:m.filter)!=null?l:Qe;return r?v(r,t.current.search,c):0}function H(){if(!t.current.search||f.current.shouldFilter===!1)return;let r=t.current.filtered.items,c=[];t.current.filtered.groups.forEach(l=>{let v=o.current.get(l),x=0;v.forEach(I=>{let E=r.get(I);x=Math.max(E,x)}),c.push([l,x])});let m=A.current;L().sort((l,v)=>{var x,I;let E=l.getAttribute("id"),T=v.getAttribute("id");return((x=r.get(T))!=null?x:0)-((I=r.get(E))!=null?I:0)}).forEach(l=>{let v=l.closest(re);v?v.appendChild(l.parentElement===v?l:l.closest(`${re} > *`)):m.appendChild(l.parentElement===m?l:l.closest(`${re} > *`))}),c.sort((l,v)=>v[1]-l[1]).forEach(l=>{var v;let x=(v=A.current)==null?void 0:v.querySelector(`${_}[${M}="${encodeURIComponent(l[0])}"]`);x==null||x.parentElement.appendChild(x)})}function J(){let r=L().find(m=>m.getAttribute("aria-disabled")!=="true"),c=r==null?void 0:r.getAttribute(M);S.setState("value",c||void 0)}function X(){var r,c,m,l;if(!t.current.search||f.current.shouldFilter===!1){t.current.filtered.count=u.current.size;return}t.current.filtered.groups=new Set;let v=0;for(let x of u.current){let I=(c=(r=s.current.get(x))==null?void 0:r.value)!=null?c:"",E=(l=(m=s.current.get(x))==null?void 0:m.keywords)!=null?l:[],T=ie(I,E);t.current.filtered.items.set(x,T),T>0&&v++}for(let[x,I]of o.current)for(let E of I)if(t.current.filtered.items.get(E)>0){t.current.filtered.groups.add(x);break}t.current.filtered.count=v}function ue(){var r,c,m;let l=F();l&&(((r=l.parentElement)==null?void 0:r.firstChild)===l&&((m=(c=l.closest(_))==null?void 0:c.querySelector(Ge))==null||m.scrollIntoView({block:"nearest"})),l.scrollIntoView({block:"nearest"}))}function F(){var r;return(r=A.current)==null?void 0:r.querySelector(`${xe}[aria-selected="true"]`)}function L(){var r;return Array.from(((r=A.current)==null?void 0:r.querySelectorAll(ve))||[])}function Y(r){let c=L()[r];c&&S.setState("value",c.getAttribute(M))}function Z(r){var c;let m=F(),l=L(),v=l.findIndex(I=>I===m),x=l[v+r];(c=f.current)!=null&&c.loop&&(x=v+r<0?l[l.length-1]:v+r===l.length?l[0]:l[v+r]),x&&S.setState("value",x.getAttribute(M))}function se(r){let c=F(),m=c==null?void 0:c.closest(_),l;for(;m&&!l;)m=r>0?rt(m,_):nt(m,_),l=m==null?void 0:m.querySelector(ve);l?S.setState("value",l.getAttribute(M)):Z(r)}let ce=()=>Y(L().length-1),de=r=>{r.preventDefault(),r.metaKey?ce():r.altKey?se(1):Z(1)},fe=r=>{r.preventDefault(),r.metaKey?Y(0):r.altKey?se(-1):Z(-1)};return a.createElement(j.div,{ref:n,tabIndex:-1,...z,"cmdk-root":"",onKeyDown:r=>{var c;(c=z.onKeyDown)==null||c.call(z,r);let m=r.nativeEvent.isComposing||r.keyCode===229;if(!(r.defaultPrevented||m))switch(r.key){case"n":case"j":{N&&r.ctrlKey&&de(r);break}case"ArrowDown":{de(r);break}case"p":case"k":{N&&r.ctrlKey&&fe(r);break}case"ArrowUp":{fe(r);break}case"Home":{r.preventDefault(),Y(0);break}case"End":{r.preventDefault(),ce();break}case"Enter":{r.preventDefault();let l=F();if(l){let v=new Event(ae);l.dispatchEvent(v)}}}}},a.createElement("label",{"cmdk-label":"",htmlFor:W.inputId,id:W.labelId,style:ot},b),B(e,r=>a.createElement(ke.Provider,{value:S},a.createElement(we.Provider,{value:W},r))))}),We=a.forwardRef((e,n)=>{var t,u;let o=P(),s=a.useRef(null),d=a.useContext(ye),f=q(),b=Se(e),i=(u=(t=b.current)==null?void 0:t.forceMount)!=null?u:d==null?void 0:d.forceMount;$(()=>{if(!i)return f.item(o,d==null?void 0:d.id)},[i]);let h=Ie(o,s,[e.value,e.children,s],e.keywords),p=le(),g=C(w=>w.value&&w.value===h.current),y=C(w=>i||f.filter()===!1?!0:w.search?w.filtered.items.get(o)>0:!0);a.useEffect(()=>{let w=s.current;if(!(!w||e.disabled))return w.addEventListener(ae,R),()=>w.removeEventListener(ae,R)},[y,e.onSelect,e.disabled]);function R(){var w,S;U(),(S=(w=b.current).onSelect)==null||S.call(w,h.current)}function U(){p.setState("value",h.current,!0)}if(!y)return null;let{disabled:N,value:z,onSelect:G,forceMount:oe,keywords:Q,...A}=e;return a.createElement(j.div,{ref:K(s,n),...A,id:o,"cmdk-item":"",role:"option","aria-disabled":!!N,"aria-selected":!!g,"data-disabled":!!N,"data-selected":!!g,onPointerMove:N||f.getDisablePointerSelection()?void 0:U,onClick:N?void 0:R},e.children)}),He=a.forwardRef((e,n)=>{let{heading:t,children:u,forceMount:o,...s}=e,d=P(),f=a.useRef(null),b=a.useRef(null),i=P(),h=q(),p=C(y=>o||h.filter()===!1?!0:y.search?y.filtered.groups.has(d):!0);$(()=>h.group(d),[]),Ie(d,f,[e.value,e.heading,b]);let g=a.useMemo(()=>({id:d,forceMount:o}),[o]);return a.createElement(j.div,{ref:K(f,n),...s,"cmdk-group":"",role:"presentation",hidden:p?void 0:!0},t&&a.createElement("div",{ref:b,"cmdk-group-heading":"","aria-hidden":!0,id:i},t),B(e,y=>a.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":t?i:void 0},a.createElement(ye.Provider,{value:g},y))))}),Je=a.forwardRef((e,n)=>{let{alwaysRender:t,...u}=e,o=a.useRef(null),s=C(d=>!d.search);return!t&&!s?null:a.createElement(j.div,{ref:K(o,n),...u,"cmdk-separator":"",role:"separator"})}),Xe=a.forwardRef((e,n)=>{let{onValueChange:t,...u}=e,o=e.value!=null,s=le(),d=C(i=>i.search),f=C(i=>i.selectedItemId),b=q();return a.useEffect(()=>{e.value!=null&&s.setState("search",e.value)},[e.value]),a.createElement(j.input,{ref:n,...u,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":b.listId,"aria-labelledby":b.labelId,"aria-activedescendant":f,id:b.inputId,type:"text",value:o?e.value:d,onChange:i=>{o||s.setState("search",i.target.value),t==null||t(i.target.value)}})}),Ye=a.forwardRef((e,n)=>{let{children:t,label:u="Suggestions",...o}=e,s=a.useRef(null),d=a.useRef(null),f=C(i=>i.selectedItemId),b=q();return a.useEffect(()=>{if(d.current&&s.current){let i=d.current,h=s.current,p,g=new ResizeObserver(()=>{p=requestAnimationFrame(()=>{let y=i.offsetHeight;h.style.setProperty("--cmdk-list-height",y.toFixed(1)+"px")})});return g.observe(i),()=>{cancelAnimationFrame(p),g.unobserve(i)}}},[]),a.createElement(j.div,{ref:K(s,n),...o,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":f,"aria-label":u,id:b.listId},B(e,i=>a.createElement("div",{ref:K(d,b.listInnerRef),"cmdk-list-sizer":""},i)))}),Ze=a.forwardRef((e,n)=>{let{open:t,onOpenChange:u,overlayClassName:o,contentClassName:s,container:d,...f}=e;return a.createElement(Ae,{open:t,onOpenChange:u},a.createElement($e,{container:d},a.createElement(Fe,{"cmdk-overlay":"",className:o}),a.createElement(Me,{"aria-label":e.label,"cmdk-dialog":"",className:s},a.createElement(Ee,{ref:n,...f}))))}),et=a.forwardRef((e,n)=>C(t=>t.filtered.count===0)?a.createElement(j.div,{ref:n,...e,"cmdk-empty":"",role:"presentation"}):null),tt=a.forwardRef((e,n)=>{let{progress:t,children:u,label:o="Loading...",...s}=e;return a.createElement(j.div,{ref:n,...s,"cmdk-loading":"",role:"progressbar","aria-valuenow":t,"aria-valuemin":0,"aria-valuemax":100,"aria-label":o},B(e,d=>a.createElement("div",{"aria-hidden":!0},d)))}),O=Object.assign(Ee,{List:Ye,Item:We,Input:Xe,Group:He,Separator:Je,Dialog:Ze,Empty:et,Loading:tt});function rt(e,n){let t=e.nextElementSibling;for(;t;){if(t.matches(n))return t;t=t.nextElementSibling}}function nt(e,n){let t=e.previousElementSibling;for(;t;){if(t.matches(n))return t;t=t.previousElementSibling}}function Se(e){let n=a.useRef(e);return $(()=>{n.current=e}),n}var $=typeof window>"u"?a.useEffect:a.useLayoutEffect;function D(e){let n=a.useRef();return n.current===void 0&&(n.current=e()),n}function C(e){let n=le(),t=()=>e(n.snapshot());return a.useSyncExternalStore(n.subscribe,t,t)}function Ie(e,n,t,u=[]){let o=a.useRef(),s=q();return $(()=>{var d;let f=(()=>{var i;for(let h of t){if(typeof h=="string")return h.trim();if(typeof h=="object"&&"current"in h)return h.current?(i=h.current.textContent)==null?void 0:i.trim():o.current}})(),b=u.map(i=>i.trim());s.value(e,f,b),(d=n.current)==null||d.setAttribute(M,f),o.current=f}),o}var at=()=>{let[e,n]=a.useState(),t=D(()=>new Map);return $(()=>{t.current.forEach(u=>u()),t.current=new Map},[e]),(u,o)=>{t.current.set(u,o),n({})}};function lt(e){let n=e.type;return typeof n=="function"?n(e.props):"render"in n?n.render(e.props):e}function B({asChild:e,children:n},t){return e&&a.isValidElement(n)?a.cloneElement(lt(n),{ref:n.ref},t(n.props.children)):t(n)}var ot={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};function it({className:e,...n}){return k.jsx(O,{"data-slot":"command",className:V("bg-popover text-popover-foreground flex h-full w-full flex-col overflow-hidden rounded-md",e),...n})}function ut({className:e,...n}){return k.jsx(O.List,{"data-slot":"command-list",className:V("max-h-[300px] scroll-py-1 overflow-x-hidden overflow-y-auto",e),...n})}function st({className:e,...n}){return k.jsx(O.Group,{"data-slot":"command-group",className:V("text-foreground [&_[cmdk-group-heading]]:text-muted-foreground overflow-hidden p-1 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium",e),...n})}function pe({className:e,...n}){return k.jsx(O.Item,{"data-slot":"command-item",className:V("data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled=true]:pointer-events-none data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...n})}const ct=(e,n)=>!e&&!n?"📍":e==="restaurant"||n==="amenity"?"🍽️":e==="hotel"||e==="guest_house"||n==="tourism"?"🏨":e==="attraction"||e==="museum"?"🎯":e==="park"||n==="leisure"?"�":e==="shop"||n==="shop"?"🛍️":e==="fuel"||n==="amenity"?"⛽":e==="hospital"||e==="clinic"?"🏥":e==="school"||e==="university"?"🎓":e==="bank"?"🏦":e==="place_of_worship"?"⛪":e==="aerodrome"?"✈️":e==="station"||n==="railway"?"🚇":e==="bus_stop"?"🚌":"📍",dt=async(e,n)=>{if(!e||e.length<3)return[];const t=new URL("https://nominatim.openstreetmap.org/search");t.searchParams.set("format","json"),t.searchParams.set("q",e),t.searchParams.set("limit","20"),t.searchParams.set("addressdetails","1"),t.searchParams.set("extratags","1"),n&&t.searchParams.set("viewbox",`${(n.lng-.1).toFixed(2)},${(n.lat+.1).toFixed(2)},${(n.lng+.1).toFixed(2)},${(n.lat-.1).toFixed(2)}`);try{const u=await fetch(t.toString());if(!u.ok)throw new Error("Nominatim search failed");return await u.json()}catch(u){return console.error("Nominatim search error:",u),Ce.error("Search failed. Please try again."),[]}};function bt({onSelect:e,referenceLocation:n,...t}){const[u,o]=a.useState(""),[s,d]=a.useState(!1),f=Le(u,300),{data:b,isFetching:i,dataUpdatedAt:h}=Ne({queryKey:["nominatim-search",f],queryFn:()=>dt(f,n),initialData:[],enabled:u.length>2});a.useEffect(()=>{},[h]);const p=g=>{const y={lat:parseFloat(g.lat),lng:parseFloat(g.lon)};e(y,g),d(!1)};return k.jsxs("div",{className:"relative",children:[k.jsx(je,{...t,placeholder:"Search restaurants, landmarks, addresses...",value:u,onChange:g=>o(g.target.value),onFocus:()=>d(!0),onBlur:()=>{setTimeout(()=>d(!1),100)},className:V(t.className,"pr-10")}),i&&k.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:k.jsx(Re,{className:"relative",color:"white",size:15})}),s&&!i&&k.jsx("div",{className:"absolute top-16/12 left-0 right-0 z-9999 overflow-auto",children:k.jsx(it,{className:"rounded-lg bg-primary",children:k.jsx(ut,{className:"max-h-60",children:k.jsxs(st,{children:[b.map(g=>k.jsxs(pe,{onSelect:()=>p(g),className:"cursor-pointer transition-colors bg-transparent! hover:bg-secondary/20!",children:[k.jsx("span",{className:"mr-2 text-lg",children:ct(g.type,g.class)}),k.jsxs("div",{className:"flex-1 min-w-0",children:[k.jsx("div",{className:"font-medium text-sm text-secondary truncate",children:g.display_name.split(",")[0]}),k.jsx("div",{className:"text-xs text-muted truncate",children:g.display_name})]})]},g.place_id)),b.length===0&&k.jsx(pe,{disabled:!0,className:"text-muted",children:u.length>2?"No results found":"Type at least 3 characters to search"})]})})})})]})}export{pt as C,bt as L,gt as N};

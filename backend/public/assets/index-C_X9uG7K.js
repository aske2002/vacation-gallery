var $n=Object.defineProperty;var di=n=>{throw TypeError(n)};var Jn=(n,e,t)=>e in n?$n(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Pe=(n,e,t)=>Jn(n,typeof e!="symbol"?e+"":e,t),Ar=(n,e,t)=>e.has(n)||di("Cannot "+t);var Ir=(n,e,t)=>(Ar(n,e,"read from private field"),t?t.call(n):e.get(n)),Er=(n,e,t)=>e.has(n)?di("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),fi=(n,e,t,a)=>(Ar(n,e,"write to private field"),a?a.call(n,t):e.set(n,t),t),$t=(n,e,t)=>(Ar(n,e,"access private method"),t);import{c as wt,r as le,j as u,f as Qn,g as Zn,P as Wr,q as ea,d as Ui,h as ci,s as ta,b as ra,_ as ia,B as Fe,S as na,t as Ke,p as aa,D as sa,v as oa}from"./index-28yYTQYt.js";import{h as la,e as ji,g as da}from"./photo-grid-BudCFOp9.js";import{b as fa,a as Ht,I as ui}from"./loading-button-BkylZ5sb.js";import{P as ca}from"./protected-route-Cc9bn1vD.js";import{e as ua,h as ha,i as ma,a as pa,j as ga,k as ya,u as wa,l as va,f as hi}from"./useVacationGalleryApi-CYdJb4Ya.js";import{D as Sa,a as ba,d as xa,b as Ca,h as _a,f as ka,g as Pa,e as mi}from"./date-input-67k-hZ35.js";import{P as Aa}from"./progress-CAbXND6h.js";import{u as Ia,T as Gi}from"./index-BH9_JX7X.js";import{C as Ea,N as zi}from"./location-search-CVZT0ayL.js";import{u as Hi,X as Fa}from"./index.esm-Bnp_jBhY.js";import{P as Or}from"./plus-CX1HuEan.js";import{C as sr,a as or,b as Vi,c as Wi,f as Da}from"./card-Da7qCGoe.js";import{B as Ra}from"./openstreetmap-C_Emiqu9.js";import{A as Ta,a as La}from"./alert-D6SHa7up.js";import{F as Ma,a as Jt,b as Qt,c as Zt,d as er,e as tr}from"./form-DdwsN0VQ.js";import"./useQuery-fXf16oON.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Na=[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],Oa=wt("camera",Na);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ba=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["circle",{cx:"10",cy:"12",r:"2",key:"737tya"}],["path",{d:"m20 17-1.296-1.296a2.41 2.41 0 0 0-3.408 0L9 22",key:"wt3hpn"}]],Xi=wt("file-image",Ba);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ua=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],ja=wt("square-check-big",Ua);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ga=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],za=wt("square-pen",Ga);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ha=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],Va=wt("square",Ha);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wa=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Xa=wt("triangle-alert",Wa);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qa=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],pi=wt("upload",qa);var gr=typeof self<"u"?self:global;const Vt=typeof navigator<"u",Ka=Vt&&typeof HTMLImageElement>"u",fr=!(typeof global>"u"||typeof process>"u"||!process.versions||!process.versions.node),yr=gr.Buffer,rr=gr.BigInt,wr=!!yr,Ya=n=>n;function cr(n,e=Ya){if(fr)try{return typeof require=="function"?Promise.resolve(e(require(n))):import(n).then(e)}catch{console.warn(`Couldn't load ${n}`)}}let Xr=gr.fetch;const $a=n=>Xr=n;if(!gr.fetch){const n=cr("http",a=>a),e=cr("https",a=>a),t=(a,{headers:l}={})=>new Promise(async(c,p)=>{let{port:m,hostname:P,pathname:A,protocol:k,search:F}=new URL(a);const L={method:"GET",hostname:P,path:encodeURI(A)+F,headers:l};m!==""&&(L.port=Number(m));const D=(k==="https:"?await e:await n).request(L,U=>{if(U.statusCode===301||U.statusCode===302){let $=new URL(U.headers.location,a).toString();return t($,{headers:l}).then(c).catch(p)}c({status:U.statusCode,arrayBuffer:()=>new Promise($=>{let de=[];U.on("data",fe=>de.push(fe)),U.on("end",()=>$(Buffer.concat(de)))})})});D.on("error",p),D.end()});$a(t)}function W(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}const ur=n=>qi(n)?void 0:n,Ja=n=>n!==void 0;function qi(n){return n===void 0||(n instanceof Map?n.size===0:Object.values(n).filter(Ja).length===0)}function Se(n){let e=new Error(n);throw delete e.stack,e}function ft(n){return(n=function(e){for(;e.endsWith("\0");)e=e.slice(0,-1);return e}(n).trim())===""?void 0:n}function Br(n){let e=function(t){let a=0;return t.ifd0.enabled&&(a+=1024),t.exif.enabled&&(a+=2048),t.makerNote&&(a+=2048),t.userComment&&(a+=1024),t.gps.enabled&&(a+=512),t.interop.enabled&&(a+=100),t.ifd1.enabled&&(a+=1024),a+2048}(n);return n.jfif.enabled&&(e+=50),n.xmp.enabled&&(e+=2e4),n.iptc.enabled&&(e+=14e3),n.icc.enabled&&(e+=6e3),e}const Ur=n=>String.fromCharCode.apply(null,n),gi=typeof TextDecoder<"u"?new TextDecoder("utf-8"):void 0;function Ki(n){return gi?gi.decode(n):wr?Buffer.from(n).toString("utf8"):decodeURIComponent(escape(Ur(n)))}class De{static from(e,t){return e instanceof this&&e.le===t?e:new De(e,void 0,void 0,t)}constructor(e,t=0,a,l){if(typeof l=="boolean"&&(this.le=l),Array.isArray(e)&&(e=new Uint8Array(e)),e===0)this.byteOffset=0,this.byteLength=0;else if(e instanceof ArrayBuffer){a===void 0&&(a=e.byteLength-t);let c=new DataView(e,t,a);this._swapDataView(c)}else if(e instanceof Uint8Array||e instanceof DataView||e instanceof De){a===void 0&&(a=e.byteLength-t),(t+=e.byteOffset)+a>e.byteOffset+e.byteLength&&Se("Creating view outside of available memory in ArrayBuffer");let c=new DataView(e.buffer,t,a);this._swapDataView(c)}else if(typeof e=="number"){let c=new DataView(new ArrayBuffer(e));this._swapDataView(c)}else Se("Invalid input argument for BufferView: "+e)}_swapArrayBuffer(e){this._swapDataView(new DataView(e))}_swapBuffer(e){this._swapDataView(new DataView(e.buffer,e.byteOffset,e.byteLength))}_swapDataView(e){this.dataView=e,this.buffer=e.buffer,this.byteOffset=e.byteOffset,this.byteLength=e.byteLength}_lengthToEnd(e){return this.byteLength-e}set(e,t,a=De){return e instanceof DataView||e instanceof De?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer&&(e=new Uint8Array(e)),e instanceof Uint8Array||Se("BufferView.set(): Invalid data argument."),this.toUint8().set(e,t),new a(this,t,e.byteLength)}subarray(e,t){return t=t||this._lengthToEnd(e),new De(this,e,t)}toUint8(){return new Uint8Array(this.buffer,this.byteOffset,this.byteLength)}getUint8Array(e,t){return new Uint8Array(this.buffer,this.byteOffset+e,t)}getString(e=0,t=this.byteLength){return Ki(this.getUint8Array(e,t))}getLatin1String(e=0,t=this.byteLength){let a=this.getUint8Array(e,t);return Ur(a)}getUnicodeString(e=0,t=this.byteLength){const a=[];for(let l=0;l<t&&e+l<this.byteLength;l+=2)a.push(this.getUint16(e+l));return Ur(a)}getInt8(e){return this.dataView.getInt8(e)}getUint8(e){return this.dataView.getUint8(e)}getInt16(e,t=this.le){return this.dataView.getInt16(e,t)}getInt32(e,t=this.le){return this.dataView.getInt32(e,t)}getUint16(e,t=this.le){return this.dataView.getUint16(e,t)}getUint32(e,t=this.le){return this.dataView.getUint32(e,t)}getFloat32(e,t=this.le){return this.dataView.getFloat32(e,t)}getFloat64(e,t=this.le){return this.dataView.getFloat64(e,t)}getFloat(e,t=this.le){return this.dataView.getFloat32(e,t)}getDouble(e,t=this.le){return this.dataView.getFloat64(e,t)}getUintBytes(e,t,a){switch(t){case 1:return this.getUint8(e,a);case 2:return this.getUint16(e,a);case 4:return this.getUint32(e,a);case 8:return this.getUint64&&this.getUint64(e,a)}}getUint(e,t,a){switch(t){case 8:return this.getUint8(e,a);case 16:return this.getUint16(e,a);case 32:return this.getUint32(e,a);case 64:return this.getUint64&&this.getUint64(e,a)}}toString(e){return this.dataView.toString(e,this.constructor.name)}ensureChunk(){}}function jr(n,e){Se(`${n} '${e}' was not loaded, try using full build of exifr.`)}class qr extends Map{constructor(e){super(),this.kind=e}get(e,t){return this.has(e)||jr(this.kind,e),t&&(e in t||function(a,l){Se(`Unknown ${a} '${l}'.`)}(this.kind,e),t[e].enabled||jr(this.kind,e)),super.get(e)}keyList(){return Array.from(this.keys())}}var Ve=new qr("file parser"),ve=new qr("segment parser"),We=new qr("file reader");function Qa(n,e){return typeof n=="string"?yi(n,e):Vt&&!Ka&&n instanceof HTMLImageElement?yi(n.src,e):n instanceof Uint8Array||n instanceof ArrayBuffer||n instanceof DataView?new De(n):Vt&&n instanceof Blob?Gr(n,e,"blob",pt):void Se("Invalid input argument")}function yi(n,e){return(t=n).startsWith("data:")||t.length>1e4?zr(n,e,"base64"):fr&&n.includes("://")?Gr(n,e,"url",mt):fr?zr(n,e,"fs"):Vt?Gr(n,e,"url",mt):void Se("Invalid input argument");var t}async function Gr(n,e,t,a){return We.has(t)?zr(n,e,t):a?async function(l,c){let p=await c(l);return new De(p)}(n,a):void Se(`Parser ${t} is not loaded`)}async function zr(n,e,t){let a=new(We.get(t))(n,e);return await a.read(),a}const mt=n=>Xr(n).then(e=>e.arrayBuffer()),pt=n=>new Promise((e,t)=>{let a=new FileReader;a.onloadend=()=>e(a.result||new ArrayBuffer),a.onerror=t,a.readAsArrayBuffer(n)});class Za extends Map{get tagKeys(){return this.allKeys||(this.allKeys=Array.from(this.keys())),this.allKeys}get tagValues(){return this.allValues||(this.allValues=Array.from(this.values())),this.allValues}}function ye(n,e,t){let a=new Za;for(let[l,c]of t)a.set(l,c);if(Array.isArray(e))for(let l of e)n.set(l,a);else n.set(e,a);return a}function gt(n,e,t){let a,l=n.get(e);for(a of t)l.set(a[0],a[1])}const Ce=new Map,je=new Map,it=new Map,Ze=["chunked","firstChunkSize","firstChunkSizeNode","firstChunkSizeBrowser","chunkSize","chunkLimit"],At=["jfif","xmp","icc","iptc","ihdr"],yt=["tiff",...At],pe=["ifd0","ifd1","exif","gps","interop"],et=[...yt,...pe],tt=["makerNote","userComment"],It=["translateKeys","translateValues","reviveValues","multiSegment"],rt=[...It,"sanitize","mergeOutput","silentErrors"];class Yi{get translate(){return this.translateKeys||this.translateValues||this.reviveValues}}class Ot extends Yi{get needed(){return this.enabled||this.deps.size>0}constructor(e,t,a,l){if(super(),W(this,"enabled",!1),W(this,"skip",new Set),W(this,"pick",new Set),W(this,"deps",new Set),W(this,"translateKeys",!1),W(this,"translateValues",!1),W(this,"reviveValues",!1),this.key=e,this.enabled=t,this.parse=this.enabled,this.applyInheritables(l),this.canBeFiltered=pe.includes(e),this.canBeFiltered&&(this.dict=Ce.get(e)),a!==void 0)if(Array.isArray(a))this.parse=this.enabled=!0,this.canBeFiltered&&a.length>0&&this.translateTagSet(a,this.pick);else if(typeof a=="object"){if(this.enabled=!0,this.parse=a.parse!==!1,this.canBeFiltered){let{pick:c,skip:p}=a;c&&c.length>0&&this.translateTagSet(c,this.pick),p&&p.length>0&&this.translateTagSet(p,this.skip)}this.applyInheritables(a)}else a===!0||a===!1?this.parse=this.enabled=a:Se(`Invalid options argument: ${a}`)}applyInheritables(e){let t,a;for(t of It)a=e[t],a!==void 0&&(this[t]=a)}translateTagSet(e,t){if(this.dict){let a,l,{tagKeys:c,tagValues:p}=this.dict;for(a of e)typeof a=="string"?(l=p.indexOf(a),l===-1&&(l=c.indexOf(Number(a))),l!==-1&&t.add(Number(c[l]))):t.add(a)}else for(let a of e)t.add(a)}finalizeFilters(){!this.enabled&&this.deps.size>0?(this.enabled=!0,hr(this.pick,this.deps)):this.enabled&&this.pick.size>0&&hr(this.pick,this.deps)}}var Ae={jfif:!1,tiff:!0,xmp:!1,icc:!1,iptc:!1,ifd0:!0,ifd1:!1,exif:!0,gps:!0,interop:!1,ihdr:void 0,makerNote:!1,userComment:!1,multiSegment:!1,skip:[],pick:[],translateKeys:!0,translateValues:!0,reviveValues:!0,sanitize:!0,mergeOutput:!0,silentErrors:!0,chunked:!0,firstChunkSize:void 0,firstChunkSizeNode:512,firstChunkSizeBrowser:65536,chunkSize:65536,chunkLimit:5},wi=new Map;class vt extends Yi{static useCached(e){let t=wi.get(e);return t!==void 0||(t=new this(e),wi.set(e,t)),t}constructor(e){super(),e===!0?this.setupFromTrue():e===void 0?this.setupFromUndefined():Array.isArray(e)?this.setupFromArray(e):typeof e=="object"?this.setupFromObject(e):Se(`Invalid options argument ${e}`),this.firstChunkSize===void 0&&(this.firstChunkSize=Vt?this.firstChunkSizeBrowser:this.firstChunkSizeNode),this.mergeOutput&&(this.ifd1.enabled=!1),this.filterNestedSegmentTags(),this.traverseTiffDependencyTree(),this.checkLoadedPlugins()}setupFromUndefined(){let e;for(e of Ze)this[e]=Ae[e];for(e of rt)this[e]=Ae[e];for(e of tt)this[e]=Ae[e];for(e of et)this[e]=new Ot(e,Ae[e],void 0,this)}setupFromTrue(){let e;for(e of Ze)this[e]=Ae[e];for(e of rt)this[e]=Ae[e];for(e of tt)this[e]=!0;for(e of et)this[e]=new Ot(e,!0,void 0,this)}setupFromArray(e){let t;for(t of Ze)this[t]=Ae[t];for(t of rt)this[t]=Ae[t];for(t of tt)this[t]=Ae[t];for(t of et)this[t]=new Ot(t,!1,void 0,this);this.setupGlobalFilters(e,void 0,pe)}setupFromObject(e){let t;for(t of(pe.ifd0=pe.ifd0||pe.image,pe.ifd1=pe.ifd1||pe.thumbnail,Object.assign(this,e),Ze))this[t]=Fr(e[t],Ae[t]);for(t of rt)this[t]=Fr(e[t],Ae[t]);for(t of tt)this[t]=Fr(e[t],Ae[t]);for(t of yt)this[t]=new Ot(t,Ae[t],e[t],this);for(t of pe)this[t]=new Ot(t,Ae[t],e[t],this.tiff);this.setupGlobalFilters(e.pick,e.skip,pe,et),e.tiff===!0?this.batchEnableWithBool(pe,!0):e.tiff===!1?this.batchEnableWithUserValue(pe,e):Array.isArray(e.tiff)?this.setupGlobalFilters(e.tiff,void 0,pe):typeof e.tiff=="object"&&this.setupGlobalFilters(e.tiff.pick,e.tiff.skip,pe)}batchEnableWithBool(e,t){for(let a of e)this[a].enabled=t}batchEnableWithUserValue(e,t){for(let a of e){let l=t[a];this[a].enabled=l!==!1&&l!==void 0}}setupGlobalFilters(e,t,a,l=a){if(e&&e.length){for(let p of l)this[p].enabled=!1;let c=vi(e,a);for(let[p,m]of c)hr(this[p].pick,m),this[p].enabled=!0}else if(t&&t.length){let c=vi(t,a);for(let[p,m]of c)hr(this[p].skip,m)}}filterNestedSegmentTags(){let{ifd0:e,exif:t,xmp:a,iptc:l,icc:c}=this;this.makerNote?t.deps.add(37500):t.skip.add(37500),this.userComment?t.deps.add(37510):t.skip.add(37510),a.enabled||e.skip.add(700),l.enabled||e.skip.add(33723),c.enabled||e.skip.add(34675)}traverseTiffDependencyTree(){let{ifd0:e,exif:t,gps:a,interop:l}=this;l.needed&&(t.deps.add(40965),e.deps.add(40965)),t.needed&&e.deps.add(34665),a.needed&&e.deps.add(34853),this.tiff.enabled=pe.some(c=>this[c].enabled===!0)||this.makerNote||this.userComment;for(let c of pe)this[c].finalizeFilters()}get onlyTiff(){return!At.map(e=>this[e].enabled).some(e=>e===!0)&&this.tiff.enabled}checkLoadedPlugins(){for(let e of yt)this[e].enabled&&!ve.has(e)&&jr("segment parser",e)}}function vi(n,e){let t,a,l,c,p=[];for(l of e){for(c of(t=Ce.get(l),a=[],t))(n.includes(c[0])||n.includes(c[1]))&&a.push(c[0]);a.length&&p.push([l,a])}return p}function Fr(n,e){return n!==void 0?n:e!==void 0?e:void 0}function hr(n,e){for(let t of e)n.add(t)}W(vt,"default",Ae);class at{constructor(e){W(this,"parsers",{}),W(this,"output",{}),W(this,"errors",[]),W(this,"pushToErrors",t=>this.errors.push(t)),this.options=vt.useCached(e)}async read(e){this.file=await Qa(e,this.options)}setup(){if(this.fileParser)return;let{file:e}=this,t=e.getUint16(0);for(let[a,l]of Ve)if(l.canHandle(e,t))return this.fileParser=new l(this.options,this.file,this.parsers),e[a]=!0;this.file.close&&this.file.close(),Se("Unknown file format")}async parse(){let{output:e,errors:t}=this;return this.setup(),this.options.silentErrors?(await this.executeParsers().catch(this.pushToErrors),t.push(...this.fileParser.errors)):await this.executeParsers(),this.file.close&&this.file.close(),this.options.silentErrors&&t.length>0&&(e.errors=t),ur(e)}async executeParsers(){let{output:e}=this;await this.fileParser.parse();let t=Object.values(this.parsers).map(async a=>{let l=await a.parse();a.assignToOutput(e,l)});this.options.silentErrors&&(t=t.map(a=>a.catch(this.pushToErrors))),await Promise.all(t)}async extractThumbnail(){this.setup();let{options:e,file:t}=this,a=ve.get("tiff",e);var l;if(t.tiff?l={start:0,type:"tiff"}:t.jpeg&&(l=await this.fileParser.getOrFindSegment("tiff")),l===void 0)return;let c=await this.fileParser.ensureSegmentChunk(l),p=this.parsers.tiff=new a(c,e,t),m=await p.extractThumbnail();return t.close&&t.close(),m}}async function vr(n,e){let t=new at(e);return await t.read(n),t.parse()}var es=Object.freeze({__proto__:null,parse:vr,Exifr:at,fileParsers:Ve,segmentParsers:ve,fileReaders:We,tagKeys:Ce,tagValues:je,tagRevivers:it,createDictionary:ye,extendDictionary:gt,fetchUrlAsArrayBuffer:mt,readBlobAsArrayBuffer:pt,chunkedProps:Ze,otherSegments:At,segments:yt,tiffBlocks:pe,segmentsAndBlocks:et,tiffExtractables:tt,inheritables:It,allFormatters:rt,Options:vt});class Sr{constructor(e,t,a){W(this,"errors",[]),W(this,"ensureSegmentChunk",async l=>{let c=l.start,p=l.size||65536;if(this.file.chunked)if(this.file.available(c,p))l.chunk=this.file.subarray(c,p);else try{l.chunk=await this.file.readChunk(c,p)}catch(m){Se(`Couldn't read segment: ${JSON.stringify(l)}. ${m.message}`)}else this.file.byteLength>c+p?l.chunk=this.file.subarray(c,p):l.size===void 0?l.chunk=this.file.subarray(c):Se("Segment unreachable: "+JSON.stringify(l));return l.chunk}),this.extendOptions&&this.extendOptions(e),this.options=e,this.file=t,this.parsers=a}injectSegment(e,t){this.options[e].enabled&&this.createParser(e,t)}createParser(e,t){let a=new(ve.get(e))(t,this.options,this.file);return this.parsers[e]=a}createParsers(e){for(let t of e){let{type:a,chunk:l}=t,c=this.options[a];if(c&&c.enabled){let p=this.parsers[a];p&&p.append||p||this.createParser(a,l)}}}async readSegments(e){let t=e.map(this.ensureSegmentChunk);await Promise.all(t)}}class Ue{static findPosition(e,t){let a=e.getUint16(t+2)+2,l=typeof this.headerLength=="function"?this.headerLength(e,t,a):this.headerLength,c=t+l,p=a-l;return{offset:t,length:a,headerLength:l,start:c,size:p,end:c+p}}static parse(e,t={}){return new this(e,new vt({[this.type]:t}),e).parse()}normalizeInput(e){return e instanceof De?e:new De(e)}constructor(e,t={},a){W(this,"errors",[]),W(this,"raw",new Map),W(this,"handleError",l=>{if(!this.options.silentErrors)throw l;this.errors.push(l.message)}),this.chunk=this.normalizeInput(e),this.file=a,this.type=this.constructor.type,this.globalOptions=this.options=t,this.localOptions=t[this.type],this.canTranslate=this.localOptions&&this.localOptions.translate}translate(){this.canTranslate&&(this.translated=this.translateBlock(this.raw,this.type))}get output(){return this.translated?this.translated:this.raw?Object.fromEntries(this.raw):void 0}translateBlock(e,t){let a=it.get(t),l=je.get(t),c=Ce.get(t),p=this.options[t],m=p.reviveValues&&!!a,P=p.translateValues&&!!l,A=p.translateKeys&&!!c,k={};for(let[F,L]of e)m&&a.has(F)?L=a.get(F)(L):P&&l.has(F)&&(L=this.translateValue(L,l.get(F))),A&&c.has(F)&&(F=c.get(F)||F),k[F]=L;return k}translateValue(e,t){return t[e]||t.DEFAULT||e}assignToOutput(e,t){this.assignObjectToOutput(e,this.constructor.type,t)}assignObjectToOutput(e,t,a){if(this.globalOptions.mergeOutput)return Object.assign(e,a);e[t]?Object.assign(e[t],a):e[t]=a}}W(Ue,"headerLength",4),W(Ue,"type",void 0),W(Ue,"multiSegment",!1),W(Ue,"canHandle",()=>!1);function ts(n){return n===192||n===194||n===196||n===219||n===221||n===218||n===254}function rs(n){return n>=224&&n<=239}function is(n,e,t){for(let[a,l]of ve)if(l.canHandle(n,e,t))return a}class Si extends Sr{constructor(...e){super(...e),W(this,"appSegments",[]),W(this,"jpegSegments",[]),W(this,"unknownSegments",[])}static canHandle(e,t){return t===65496}async parse(){await this.findAppSegments(),await this.readSegments(this.appSegments),this.mergeMultiSegments(),this.createParsers(this.mergedAppSegments||this.appSegments)}setupSegmentFinderArgs(e){e===!0?(this.findAll=!0,this.wanted=new Set(ve.keyList())):(e=e===void 0?ve.keyList().filter(t=>this.options[t].enabled):e.filter(t=>this.options[t].enabled&&ve.has(t)),this.findAll=!1,this.remaining=new Set(e),this.wanted=new Set(e)),this.unfinishedMultiSegment=!1}async findAppSegments(e=0,t){this.setupSegmentFinderArgs(t);let{file:a,findAll:l,wanted:c,remaining:p}=this;if(!l&&this.file.chunked&&(l=Array.from(c).some(m=>{let P=ve.get(m),A=this.options[m];return P.multiSegment&&A.multiSegment}),l&&await this.file.readWhole()),e=this.findAppSegmentsInRange(e,a.byteLength),!this.options.onlyTiff&&a.chunked){let m=!1;for(;p.size>0&&!m&&(a.canReadNextChunk||this.unfinishedMultiSegment);){let{nextChunkOffset:P}=a,A=this.appSegments.some(k=>!this.file.available(k.offset||k.start,k.length||k.size));if(m=e>P&&!A?!await a.readNextChunk(e):!await a.readNextChunk(P),(e=this.findAppSegmentsInRange(e,a.byteLength))===void 0)return}}}findAppSegmentsInRange(e,t){t-=2;let a,l,c,p,m,P,{file:A,findAll:k,wanted:F,remaining:L,options:D}=this;for(;e<t;e++)if(A.getUint8(e)===255){if(a=A.getUint8(e+1),rs(a)){if(l=A.getUint16(e+2),c=is(A,e,l),c&&F.has(c)&&(p=ve.get(c),m=p.findPosition(A,e),P=D[c],m.type=c,this.appSegments.push(m),!k&&(p.multiSegment&&P.multiSegment?(this.unfinishedMultiSegment=m.chunkNumber<m.chunkCount,this.unfinishedMultiSegment||L.delete(c)):L.delete(c),L.size===0)))break;D.recordUnknownSegments&&(m=Ue.findPosition(A,e),m.marker=a,this.unknownSegments.push(m)),e+=l+1}else if(ts(a)){if(l=A.getUint16(e+2),a===218&&D.stopAfterSos!==!1)return;D.recordJpegSegments&&this.jpegSegments.push({offset:e,length:l,marker:a}),e+=l+1}}return e}mergeMultiSegments(){if(!this.appSegments.some(t=>t.multiSegment))return;let e=function(t,a){let l,c,p,m=new Map;for(let P=0;P<t.length;P++)l=t[P],c=l[a],m.has(c)?p=m.get(c):m.set(c,p=[]),p.push(l);return Array.from(m)}(this.appSegments,"type");this.mergedAppSegments=e.map(([t,a])=>{let l=ve.get(t,this.options);return l.handleMultiSegments?{type:t,chunk:l.handleMultiSegments(a)}:a[0]})}getSegment(e){return this.appSegments.find(t=>t.type===e)}async getOrFindSegment(e){let t=this.getSegment(e);return t===void 0&&(await this.findAppSegments(0,[e]),t=this.getSegment(e)),t}}W(Si,"type","jpeg"),Ve.set("jpeg",Si);const ns=[void 0,1,1,2,4,8,1,1,2,4,8,4,8,4];class as extends Ue{parseHeader(){var e=this.chunk.getUint16();e===18761?this.le=!0:e===19789&&(this.le=!1),this.chunk.le=this.le,this.headerParsed=!0}parseTags(e,t,a=new Map){let{pick:l,skip:c}=this.options[t];l=new Set(l);let p=l.size>0,m=c.size===0,P=this.chunk.getUint16(e);e+=2;for(let A=0;A<P;A++){let k=this.chunk.getUint16(e);if(p){if(l.has(k)&&(a.set(k,this.parseTag(e,k,t)),l.delete(k),l.size===0))break}else!m&&c.has(k)||a.set(k,this.parseTag(e,k,t));e+=12}return a}parseTag(e,t,a){let{chunk:l}=this,c=l.getUint16(e+2),p=l.getUint32(e+4),m=ns[c];if(m*p<=4?e+=8:e=l.getUint32(e+8),(c<1||c>13)&&Se(`Invalid TIFF value type. block: ${a.toUpperCase()}, tag: ${t.toString(16)}, type: ${c}, offset ${e}`),e>l.byteLength&&Se(`Invalid TIFF value offset. block: ${a.toUpperCase()}, tag: ${t.toString(16)}, type: ${c}, offset ${e} is outside of chunk size ${l.byteLength}`),c===1)return l.getUint8Array(e,p);if(c===2)return ft(l.getString(e,p));if(c===7)return l.getUint8Array(e,p);if(p===1)return this.parseTagValue(c,e);{let P=new(function(k){switch(k){case 1:return Uint8Array;case 3:return Uint16Array;case 4:return Uint32Array;case 5:return Array;case 6:return Int8Array;case 8:return Int16Array;case 9:return Int32Array;case 10:return Array;case 11:return Float32Array;case 12:return Float64Array;default:return Array}}(c))(p),A=m;for(let k=0;k<p;k++)P[k]=this.parseTagValue(c,e),e+=A;return P}}parseTagValue(e,t){let{chunk:a}=this;switch(e){case 1:return a.getUint8(t);case 3:return a.getUint16(t);case 4:return a.getUint32(t);case 5:return a.getUint32(t)/a.getUint32(t+4);case 6:return a.getInt8(t);case 8:return a.getInt16(t);case 9:return a.getInt32(t);case 10:return a.getInt32(t)/a.getInt32(t+4);case 11:return a.getFloat(t);case 12:return a.getDouble(t);case 13:return a.getUint32(t);default:Se(`Invalid tiff type ${e}`)}}}class Dr extends as{static canHandle(e,t){return e.getUint8(t+1)===225&&e.getUint32(t+4)===1165519206&&e.getUint16(t+8)===0}async parse(){this.parseHeader();let{options:e}=this;return e.ifd0.enabled&&await this.parseIfd0Block(),e.exif.enabled&&await this.safeParse("parseExifBlock"),e.gps.enabled&&await this.safeParse("parseGpsBlock"),e.interop.enabled&&await this.safeParse("parseInteropBlock"),e.ifd1.enabled&&await this.safeParse("parseThumbnailBlock"),this.createOutput()}safeParse(e){let t=this[e]();return t.catch!==void 0&&(t=t.catch(this.handleError)),t}findIfd0Offset(){this.ifd0Offset===void 0&&(this.ifd0Offset=this.chunk.getUint32(4))}findIfd1Offset(){if(this.ifd1Offset===void 0){this.findIfd0Offset();let e=this.chunk.getUint16(this.ifd0Offset),t=this.ifd0Offset+2+12*e;this.ifd1Offset=this.chunk.getUint32(t)}}parseBlock(e,t){let a=new Map;return this[t]=a,this.parseTags(e,t,a),a}async parseIfd0Block(){if(this.ifd0)return;let{file:e}=this;this.findIfd0Offset(),this.ifd0Offset<8&&Se("Malformed EXIF data"),!e.chunked&&this.ifd0Offset>e.byteLength&&Se(`IFD0 offset points to outside of file.
this.ifd0Offset: ${this.ifd0Offset}, file.byteLength: ${e.byteLength}`),e.tiff&&await e.ensureChunk(this.ifd0Offset,Br(this.options));let t=this.parseBlock(this.ifd0Offset,"ifd0");return t.size!==0?(this.exifOffset=t.get(34665),this.interopOffset=t.get(40965),this.gpsOffset=t.get(34853),this.xmp=t.get(700),this.iptc=t.get(33723),this.icc=t.get(34675),this.options.sanitize&&(t.delete(34665),t.delete(40965),t.delete(34853),t.delete(700),t.delete(33723),t.delete(34675)),t):void 0}async parseExifBlock(){if(this.exif||(this.ifd0||await this.parseIfd0Block(),this.exifOffset===void 0))return;this.file.tiff&&await this.file.ensureChunk(this.exifOffset,Br(this.options));let e=this.parseBlock(this.exifOffset,"exif");return this.interopOffset||(this.interopOffset=e.get(40965)),this.makerNote=e.get(37500),this.userComment=e.get(37510),this.options.sanitize&&(e.delete(40965),e.delete(37500),e.delete(37510)),this.unpack(e,41728),this.unpack(e,41729),e}unpack(e,t){let a=e.get(t);a&&a.length===1&&e.set(t,a[0])}async parseGpsBlock(){if(this.gps||(this.ifd0||await this.parseIfd0Block(),this.gpsOffset===void 0))return;let e=this.parseBlock(this.gpsOffset,"gps");return e&&e.has(2)&&e.has(4)&&(e.set("latitude",bi(...e.get(2),e.get(1))),e.set("longitude",bi(...e.get(4),e.get(3)))),e}async parseInteropBlock(){if(!this.interop&&(this.ifd0||await this.parseIfd0Block(),this.interopOffset!==void 0||this.exif||await this.parseExifBlock(),this.interopOffset!==void 0))return this.parseBlock(this.interopOffset,"interop")}async parseThumbnailBlock(e=!1){if(!this.ifd1&&!this.ifd1Parsed&&(!this.options.mergeOutput||e))return this.findIfd1Offset(),this.ifd1Offset>0&&(this.parseBlock(this.ifd1Offset,"ifd1"),this.ifd1Parsed=!0),this.ifd1}async extractThumbnail(){if(this.headerParsed||this.parseHeader(),this.ifd1Parsed||await this.parseThumbnailBlock(!0),this.ifd1===void 0)return;let e=this.ifd1.get(513),t=this.ifd1.get(514);return this.chunk.getUint8Array(e,t)}get image(){return this.ifd0}get thumbnail(){return this.ifd1}createOutput(){let e,t,a,l={};for(t of pe)if(e=this[t],!qi(e))if(a=this.canTranslate?this.translateBlock(e,t):Object.fromEntries(e),this.options.mergeOutput){if(t==="ifd1")continue;Object.assign(l,a)}else l[t]=a;return this.makerNote&&(l.makerNote=this.makerNote),this.userComment&&(l.userComment=this.userComment),l}assignToOutput(e,t){if(this.globalOptions.mergeOutput)Object.assign(e,t);else for(let[a,l]of Object.entries(t))this.assignObjectToOutput(e,a,l)}}function bi(n,e,t,a){var l=n+e/60+t/3600;return a!=="S"&&a!=="W"||(l*=-1),l}W(Dr,"type","tiff"),W(Dr,"headerLength",10),ve.set("tiff",Dr);var ss=Object.freeze({__proto__:null,default:es,Exifr:at,fileParsers:Ve,segmentParsers:ve,fileReaders:We,tagKeys:Ce,tagValues:je,tagRevivers:it,createDictionary:ye,extendDictionary:gt,fetchUrlAsArrayBuffer:mt,readBlobAsArrayBuffer:pt,chunkedProps:Ze,otherSegments:At,segments:yt,tiffBlocks:pe,segmentsAndBlocks:et,tiffExtractables:tt,inheritables:It,allFormatters:rt,Options:vt,parse:vr});const Kr={ifd0:!1,ifd1:!1,exif:!1,gps:!1,interop:!1,sanitize:!1,reviveValues:!0,translateKeys:!1,translateValues:!1,mergeOutput:!1},Yr=Object.assign({},Kr,{firstChunkSize:4e4,gps:[1,2,3,4]});async function $i(n){let e=new at(Yr);await e.read(n);let t=await e.parse();if(t&&t.gps){let{latitude:a,longitude:l}=t.gps;return{latitude:a,longitude:l}}}const $r=Object.assign({},Kr,{tiff:!1,ifd1:!0,mergeOutput:!1});async function Ji(n){let e=new at($r);await e.read(n);let t=await e.extractThumbnail();return t&&wr?yr.from(t):t}async function Qi(n){let e=await this.thumbnail(n);if(e!==void 0){let t=new Blob([e]);return URL.createObjectURL(t)}}const Jr=Object.assign({},Kr,{firstChunkSize:4e4,ifd0:[274]});async function Qr(n){let e=new at(Jr);await e.read(n);let t=await e.parse();if(t&&t.ifd0)return t.ifd0[274]}const Zr=Object.freeze({1:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:0,rad:0},2:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:0,rad:0},3:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:180,rad:180*Math.PI/180},4:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:180,rad:180*Math.PI/180},5:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:90,rad:90*Math.PI/180},6:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:90,rad:90*Math.PI/180},7:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:270,rad:270*Math.PI/180},8:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:270,rad:270*Math.PI/180}});let ct=!0,ut=!0;if(typeof navigator=="object"){let n=navigator.userAgent;if(n.includes("iPad")||n.includes("iPhone")){let e=n.match(/OS (\d+)_(\d+)/);if(e){let[,t,a]=e;ct=Number(t)+.1*Number(a)<13.4,ut=!1}}else if(n.includes("OS X 10")){let[,e]=n.match(/OS X 10[_.](\d+)/);ct=ut=Number(e)<15}if(n.includes("Chrome/")){let[,e]=n.match(/Chrome\/(\d+)/);ct=ut=Number(e)<81}else if(n.includes("Firefox/")){let[,e]=n.match(/Firefox\/(\d+)/);ct=ut=Number(e)<77}}async function Zi(n){let e=await Qr(n);return Object.assign({canvas:ct,css:ut},Zr[e])}class os extends De{constructor(...e){super(...e),W(this,"ranges",new ls),this.byteLength!==0&&this.ranges.add(0,this.byteLength)}_tryExtend(e,t,a){if(e===0&&this.byteLength===0&&a){let l=new DataView(a.buffer||a,a.byteOffset,a.byteLength);this._swapDataView(l)}else{let l=e+t;if(l>this.byteLength){let{dataView:c}=this._extend(l);this._swapDataView(c)}}}_extend(e){let t;t=wr?yr.allocUnsafe(e):new Uint8Array(e);let a=new DataView(t.buffer,t.byteOffset,t.byteLength);return t.set(new Uint8Array(this.buffer,this.byteOffset,this.byteLength),0),{uintView:t,dataView:a}}subarray(e,t,a=!1){return t=t||this._lengthToEnd(e),a&&this._tryExtend(e,t),this.ranges.add(e,t),super.subarray(e,t)}set(e,t,a=!1){a&&this._tryExtend(t,e.byteLength,e);let l=super.set(e,t);return this.ranges.add(t,l.byteLength),l}async ensureChunk(e,t){this.chunked&&(this.ranges.available(e,t)||await this.readChunk(e,t))}available(e,t){return this.ranges.available(e,t)}}class ls{constructor(){W(this,"list",[])}get length(){return this.list.length}add(e,t,a=0){let l=e+t,c=this.list.filter(p=>xi(e,p.offset,l)||xi(e,p.end,l));if(c.length>0){e=Math.min(e,...c.map(m=>m.offset)),l=Math.max(l,...c.map(m=>m.end)),t=l-e;let p=c.shift();p.offset=e,p.length=t,p.end=l,this.list=this.list.filter(m=>!c.includes(m))}else this.list.push({offset:e,length:t,end:l})}available(e,t){let a=e+t;return this.list.some(l=>l.offset<=e&&a<=l.end)}}function xi(n,e,t){return n<=e&&e<=t}class br extends os{constructor(e,t){super(0),W(this,"chunksRead",0),this.input=e,this.options=t}async readWhole(){this.chunked=!1,await this.readChunk(this.nextChunkOffset)}async readChunked(){this.chunked=!0,await this.readChunk(0,this.options.firstChunkSize)}async readNextChunk(e=this.nextChunkOffset){if(this.fullyRead)return this.chunksRead++,!1;let t=this.options.chunkSize,a=await this.readChunk(e,t);return!!a&&a.byteLength===t}async readChunk(e,t){if(this.chunksRead++,(t=this.safeWrapAddress(e,t))!==0)return this._readChunk(e,t)}safeWrapAddress(e,t){return this.size!==void 0&&e+t>this.size?Math.max(0,this.size-e):t}get nextChunkOffset(){if(this.ranges.list.length!==0)return this.ranges.list[0].length}get canReadNextChunk(){return this.chunksRead<this.options.chunkLimit}get fullyRead(){return this.size!==void 0&&this.nextChunkOffset===this.size}read(){return this.options.chunked?this.readChunked():this.readWhole()}close(){}}We.set("blob",class extends br{async readWhole(){this.chunked=!1;let n=await pt(this.input);this._swapArrayBuffer(n)}readChunked(){return this.chunked=!0,this.size=this.input.size,super.readChunked()}async _readChunk(n,e){let t=e?n+e:void 0,a=this.input.slice(n,t),l=await pt(a);return this.set(l,n,!0)}});var ds=Object.freeze({__proto__:null,default:ss,Exifr:at,fileParsers:Ve,segmentParsers:ve,fileReaders:We,tagKeys:Ce,tagValues:je,tagRevivers:it,createDictionary:ye,extendDictionary:gt,fetchUrlAsArrayBuffer:mt,readBlobAsArrayBuffer:pt,chunkedProps:Ze,otherSegments:At,segments:yt,tiffBlocks:pe,segmentsAndBlocks:et,tiffExtractables:tt,inheritables:It,allFormatters:rt,Options:vt,parse:vr,gpsOnlyOptions:Yr,gps:$i,thumbnailOnlyOptions:$r,thumbnail:Ji,thumbnailUrl:Qi,orientationOnlyOptions:Jr,orientation:Qr,rotations:Zr,get rotateCanvas(){return ct},get rotateCss(){return ut},rotation:Zi});We.set("url",class extends br{async readWhole(){this.chunked=!1;let n=await mt(this.input);n instanceof ArrayBuffer?this._swapArrayBuffer(n):n instanceof Uint8Array&&this._swapBuffer(n)}async _readChunk(n,e){let t=e?n+e-1:void 0,a=this.options.httpHeaders||{};(n||t)&&(a.range=`bytes=${[n,t].join("-")}`);let l=await Xr(this.input,{headers:a}),c=await l.arrayBuffer(),p=c.byteLength;if(l.status!==416)return p!==e&&(this.size=n+p),this.set(c,n,!0)}});De.prototype.getUint64=function(n){let e=this.getUint32(n),t=this.getUint32(n+4);return e<1048575?e<<32|t:typeof rr!==void 0?(console.warn("Using BigInt because of type 64uint but JS can only handle 53b numbers."),rr(e)<<rr(32)|rr(t)):void Se("Trying to read 64b value but JS can only handle 53b numbers.")};class fs extends Sr{parseBoxes(e=0){let t=[];for(;e<this.file.byteLength-4;){let a=this.parseBoxHead(e);if(t.push(a),a.length===0)break;e+=a.length}return t}parseSubBoxes(e){e.boxes=this.parseBoxes(e.start)}findBox(e,t){return e.boxes===void 0&&this.parseSubBoxes(e),e.boxes.find(a=>a.kind===t)}parseBoxHead(e){let t=this.file.getUint32(e),a=this.file.getString(e+4,4),l=e+8;return t===1&&(t=this.file.getUint64(e+8),l+=8),{offset:e,length:t,kind:a,start:l}}parseBoxFullHead(e){if(e.version!==void 0)return;let t=this.file.getUint32(e.start);e.version=t>>24,e.start+=4}}class en extends fs{static canHandle(e,t){if(t!==0)return!1;let a=e.getUint16(2);if(a>50)return!1;let l=16,c=[];for(;l<a;)c.push(e.getString(l,4)),l+=4;return c.includes(this.type)}async parse(){let e=this.file.getUint32(0),t=this.parseBoxHead(e);for(;t.kind!=="meta";)e+=t.length,await this.file.ensureChunk(e,16),t=this.parseBoxHead(e);await this.file.ensureChunk(t.offset,t.length),this.parseBoxFullHead(t),this.parseSubBoxes(t),this.options.icc.enabled&&await this.findIcc(t),this.options.tiff.enabled&&await this.findExif(t)}async registerSegment(e,t,a){await this.file.ensureChunk(t,a);let l=this.file.subarray(t,a);this.createParser(e,l)}async findIcc(e){let t=this.findBox(e,"iprp");if(t===void 0)return;let a=this.findBox(t,"ipco");if(a===void 0)return;let l=this.findBox(a,"colr");l!==void 0&&await this.registerSegment("icc",l.offset+12,l.length)}async findExif(e){let t=this.findBox(e,"iinf");if(t===void 0)return;let a=this.findBox(e,"iloc");if(a===void 0)return;let l=this.findExifLocIdInIinf(t),c=this.findExtentInIloc(a,l);if(c===void 0)return;let[p,m]=c;await this.file.ensureChunk(p,m);let P=4+this.file.getUint32(p);p+=P,m-=P,await this.registerSegment("tiff",p,m)}findExifLocIdInIinf(e){this.parseBoxFullHead(e);let t,a,l,c,p=e.start,m=this.file.getUint16(p);for(p+=2;m--;){if(t=this.parseBoxHead(p),this.parseBoxFullHead(t),a=t.start,t.version>=2&&(l=t.version===3?4:2,c=this.file.getString(a+l+2,4),c==="Exif"))return this.file.getUintBytes(a,l);p+=t.length}}get8bits(e){let t=this.file.getUint8(e);return[t>>4,15&t]}findExtentInIloc(e,t){this.parseBoxFullHead(e);let a=e.start,[l,c]=this.get8bits(a++),[p,m]=this.get8bits(a++),P=e.version===2?4:2,A=e.version===1||e.version===2?2:0,k=m+l+c,F=e.version===2?4:2,L=this.file.getUintBytes(a,F);for(a+=F;L--;){let D=this.file.getUintBytes(a,P);a+=P+A+2+p;let U=this.file.getUint16(a);if(a+=2,D===t)return U>1&&console.warn(`ILOC box has more than one extent but we're only processing one
Please create an issue at https://github.com/MikeKovarik/exifr with this file`),[this.file.getUintBytes(a+m,l),this.file.getUintBytes(a+m+l,c)];a+=U*k}}}class tn extends en{}W(tn,"type","heic");class Ci extends en{}W(Ci,"type","avif"),Ve.set("heic",tn),Ve.set("avif",Ci),ye(Ce,["ifd0","ifd1"],[[256,"ImageWidth"],[257,"ImageHeight"],[258,"BitsPerSample"],[259,"Compression"],[262,"PhotometricInterpretation"],[270,"ImageDescription"],[271,"Make"],[272,"Model"],[273,"StripOffsets"],[274,"Orientation"],[277,"SamplesPerPixel"],[278,"RowsPerStrip"],[279,"StripByteCounts"],[282,"XResolution"],[283,"YResolution"],[284,"PlanarConfiguration"],[296,"ResolutionUnit"],[301,"TransferFunction"],[305,"Software"],[306,"ModifyDate"],[315,"Artist"],[316,"HostComputer"],[317,"Predictor"],[318,"WhitePoint"],[319,"PrimaryChromaticities"],[513,"ThumbnailOffset"],[514,"ThumbnailLength"],[529,"YCbCrCoefficients"],[530,"YCbCrSubSampling"],[531,"YCbCrPositioning"],[532,"ReferenceBlackWhite"],[700,"ApplicationNotes"],[33432,"Copyright"],[33723,"IPTC"],[34665,"ExifIFD"],[34675,"ICC"],[34853,"GpsIFD"],[330,"SubIFD"],[40965,"InteropIFD"],[40091,"XPTitle"],[40092,"XPComment"],[40093,"XPAuthor"],[40094,"XPKeywords"],[40095,"XPSubject"]]),ye(Ce,"exif",[[33434,"ExposureTime"],[33437,"FNumber"],[34850,"ExposureProgram"],[34852,"SpectralSensitivity"],[34855,"ISO"],[34858,"TimeZoneOffset"],[34859,"SelfTimerMode"],[34864,"SensitivityType"],[34865,"StandardOutputSensitivity"],[34866,"RecommendedExposureIndex"],[34867,"ISOSpeed"],[34868,"ISOSpeedLatitudeyyy"],[34869,"ISOSpeedLatitudezzz"],[36864,"ExifVersion"],[36867,"DateTimeOriginal"],[36868,"CreateDate"],[36873,"GooglePlusUploadCode"],[36880,"OffsetTime"],[36881,"OffsetTimeOriginal"],[36882,"OffsetTimeDigitized"],[37121,"ComponentsConfiguration"],[37122,"CompressedBitsPerPixel"],[37377,"ShutterSpeedValue"],[37378,"ApertureValue"],[37379,"BrightnessValue"],[37380,"ExposureCompensation"],[37381,"MaxApertureValue"],[37382,"SubjectDistance"],[37383,"MeteringMode"],[37384,"LightSource"],[37385,"Flash"],[37386,"FocalLength"],[37393,"ImageNumber"],[37394,"SecurityClassification"],[37395,"ImageHistory"],[37396,"SubjectArea"],[37500,"MakerNote"],[37510,"UserComment"],[37520,"SubSecTime"],[37521,"SubSecTimeOriginal"],[37522,"SubSecTimeDigitized"],[37888,"AmbientTemperature"],[37889,"Humidity"],[37890,"Pressure"],[37891,"WaterDepth"],[37892,"Acceleration"],[37893,"CameraElevationAngle"],[40960,"FlashpixVersion"],[40961,"ColorSpace"],[40962,"ExifImageWidth"],[40963,"ExifImageHeight"],[40964,"RelatedSoundFile"],[41483,"FlashEnergy"],[41486,"FocalPlaneXResolution"],[41487,"FocalPlaneYResolution"],[41488,"FocalPlaneResolutionUnit"],[41492,"SubjectLocation"],[41493,"ExposureIndex"],[41495,"SensingMethod"],[41728,"FileSource"],[41729,"SceneType"],[41730,"CFAPattern"],[41985,"CustomRendered"],[41986,"ExposureMode"],[41987,"WhiteBalance"],[41988,"DigitalZoomRatio"],[41989,"FocalLengthIn35mmFormat"],[41990,"SceneCaptureType"],[41991,"GainControl"],[41992,"Contrast"],[41993,"Saturation"],[41994,"Sharpness"],[41996,"SubjectDistanceRange"],[42016,"ImageUniqueID"],[42032,"OwnerName"],[42033,"SerialNumber"],[42034,"LensInfo"],[42035,"LensMake"],[42036,"LensModel"],[42037,"LensSerialNumber"],[42080,"CompositeImage"],[42081,"CompositeImageCount"],[42082,"CompositeImageExposureTimes"],[42240,"Gamma"],[59932,"Padding"],[59933,"OffsetSchema"],[65e3,"OwnerName"],[65001,"SerialNumber"],[65002,"Lens"],[65100,"RawFile"],[65101,"Converter"],[65102,"WhiteBalance"],[65105,"Exposure"],[65106,"Shadows"],[65107,"Brightness"],[65108,"Contrast"],[65109,"Saturation"],[65110,"Sharpness"],[65111,"Smoothness"],[65112,"MoireFilter"],[40965,"InteropIFD"]]),ye(Ce,"gps",[[0,"GPSVersionID"],[1,"GPSLatitudeRef"],[2,"GPSLatitude"],[3,"GPSLongitudeRef"],[4,"GPSLongitude"],[5,"GPSAltitudeRef"],[6,"GPSAltitude"],[7,"GPSTimeStamp"],[8,"GPSSatellites"],[9,"GPSStatus"],[10,"GPSMeasureMode"],[11,"GPSDOP"],[12,"GPSSpeedRef"],[13,"GPSSpeed"],[14,"GPSTrackRef"],[15,"GPSTrack"],[16,"GPSImgDirectionRef"],[17,"GPSImgDirection"],[18,"GPSMapDatum"],[19,"GPSDestLatitudeRef"],[20,"GPSDestLatitude"],[21,"GPSDestLongitudeRef"],[22,"GPSDestLongitude"],[23,"GPSDestBearingRef"],[24,"GPSDestBearing"],[25,"GPSDestDistanceRef"],[26,"GPSDestDistance"],[27,"GPSProcessingMethod"],[28,"GPSAreaInformation"],[29,"GPSDateStamp"],[30,"GPSDifferential"],[31,"GPSHPositioningError"]]),ye(je,["ifd0","ifd1"],[[274,{1:"Horizontal (normal)",2:"Mirror horizontal",3:"Rotate 180",4:"Mirror vertical",5:"Mirror horizontal and rotate 270 CW",6:"Rotate 90 CW",7:"Mirror horizontal and rotate 90 CW",8:"Rotate 270 CW"}],[296,{1:"None",2:"inches",3:"cm"}]]);let Gt=ye(je,"exif",[[34850,{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"}],[37121,{0:"-",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}],[37383,{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"}],[37384,{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"}],[37385,{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"}],[41495,{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"}],[41728,{1:"Film Scanner",2:"Reflection Print Scanner",3:"Digital Camera"}],[41729,{1:"Directly photographed"}],[41985,{0:"Normal",1:"Custom",2:"HDR (no original saved)",3:"HDR (original saved)",4:"Original (for HDR)",6:"Panorama",7:"Portrait HDR",8:"Portrait"}],[41986,{0:"Auto",1:"Manual",2:"Auto bracket"}],[41987,{0:"Auto",1:"Manual"}],[41990,{0:"Standard",1:"Landscape",2:"Portrait",3:"Night",4:"Other"}],[41991,{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"}],[41996,{0:"Unknown",1:"Macro",2:"Close",3:"Distant"}],[42080,{0:"Unknown",1:"Not a Composite Image",2:"General Composite Image",3:"Composite Image Captured While Shooting"}]]);const _i={1:"No absolute unit of measurement",2:"Inch",3:"Centimeter"};Gt.set(37392,_i),Gt.set(41488,_i);const Rr={0:"Normal",1:"Low",2:"High"};function ki(n){return typeof n=="object"&&n.length!==void 0?n[0]:n}function Pi(n){let e=Array.from(n).slice(1);return e[1]>15&&(e=e.map(t=>String.fromCharCode(t))),e[2]!=="0"&&e[2]!==0||e.pop(),e.join(".")}function Tr(n){if(typeof n=="string"){var[e,t,a,l,c,p]=n.trim().split(/[-: ]/g).map(Number),m=new Date(e,t-1,a);return Number.isNaN(l)||Number.isNaN(c)||Number.isNaN(p)||(m.setHours(l),m.setMinutes(c),m.setSeconds(p)),Number.isNaN(+m)?n:m}}function Bt(n){if(typeof n=="string")return n;let e=[];if(n[1]===0&&n[n.length-1]===0)for(let t=0;t<n.length;t+=2)e.push(Ai(n[t+1],n[t]));else for(let t=0;t<n.length;t+=2)e.push(Ai(n[t],n[t+1]));return ft(String.fromCodePoint(...e))}function Ai(n,e){return n<<8|e}Gt.set(41992,Rr),Gt.set(41993,Rr),Gt.set(41994,Rr),ye(it,["ifd0","ifd1"],[[50827,function(n){return typeof n!="string"?Ki(n):n}],[306,Tr],[40091,Bt],[40092,Bt],[40093,Bt],[40094,Bt],[40095,Bt]]),ye(it,"exif",[[40960,Pi],[36864,Pi],[36867,Tr],[36868,Tr],[40962,ki],[40963,ki]]),ye(it,"gps",[[0,n=>Array.from(n).join(".")],[7,n=>Array.from(n).join(":")]]);class Lr extends Ue{static canHandle(e,t){return e.getUint8(t+1)===225&&e.getUint32(t+4)===1752462448&&e.getString(t+4,20)==="http://ns.adobe.com/"}static headerLength(e,t){return e.getString(t+4,34)==="http://ns.adobe.com/xmp/extension/"?79:33}static findPosition(e,t){let a=super.findPosition(e,t);return a.multiSegment=a.extended=a.headerLength===79,a.multiSegment?(a.chunkCount=e.getUint8(t+72),a.chunkNumber=e.getUint8(t+76),e.getUint8(t+77)!==0&&a.chunkNumber++):(a.chunkCount=1/0,a.chunkNumber=-1),a}static handleMultiSegments(e){return e.map(t=>t.chunk.getString()).join("")}normalizeInput(e){return typeof e=="string"?e:De.from(e).getString()}parse(e=this.chunk){if(!this.localOptions.parse)return e;e=function(c){let p={},m={};for(let P of sn)p[P]=[],m[P]=0;return c.replace(ms,(P,A,k)=>{if(A==="<"){let F=++m[k];return p[k].push(F),`${P}#${F}`}return`${P}#${p[k].pop()}`})}(e);let t=xt.findAll(e,"rdf","Description");t.length===0&&t.push(new xt("rdf","Description",void 0,e));let a,l={};for(let c of t)for(let p of c.properties)a=hs(p.ns,l),rn(p,a);return function(c){let p;for(let m in c)p=c[m]=ur(c[m]),p===void 0&&delete c[m];return ur(c)}(l)}assignToOutput(e,t){if(this.localOptions.parse)for(let[a,l]of Object.entries(t))switch(a){case"tiff":this.assignObjectToOutput(e,"ifd0",l);break;case"exif":this.assignObjectToOutput(e,"exif",l);break;case"xmlns":break;default:this.assignObjectToOutput(e,a,l)}else e.xmp=t}}W(Lr,"type","xmp"),W(Lr,"multiSegment",!0),ve.set("xmp",Lr);class mr{static findAll(e){return nn(e,/([a-zA-Z0-9-]+):([a-zA-Z0-9-]+)=("[^"]*"|'[^']*')/gm).map(mr.unpackMatch)}static unpackMatch(e){let t=e[1],a=e[2],l=e[3].slice(1,-1);return l=an(l),new mr(t,a,l)}constructor(e,t,a){this.ns=e,this.name=t,this.value=a}serialize(){return this.value}}class xt{static findAll(e,t,a){if(t!==void 0||a!==void 0){t=t||"[\\w\\d-]+",a=a||"[\\w\\d-]+";var l=new RegExp(`<(${t}):(${a})(#\\d+)?((\\s+?[\\w\\d-:]+=("[^"]*"|'[^']*'))*\\s*)(\\/>|>([\\s\\S]*?)<\\/\\1:\\2\\3>)`,"gm")}else l=/<([\w\d-]+):([\w\d-]+)(#\d+)?((\s+?[\w\d-:]+=("[^"]*"|'[^']*'))*\s*)(\/>|>([\s\S]*?)<\/\1:\2\3>)/gm;return nn(e,l).map(xt.unpackMatch)}static unpackMatch(e){let t=e[1],a=e[2],l=e[4],c=e[8];return new xt(t,a,l,c)}constructor(e,t,a,l){this.ns=e,this.name=t,this.attrString=a,this.innerXml=l,this.attrs=mr.findAll(a),this.children=xt.findAll(l),this.value=this.children.length===0?an(l):void 0,this.properties=[...this.attrs,...this.children]}get isPrimitive(){return this.value!==void 0&&this.attrs.length===0&&this.children.length===0}get isListContainer(){return this.children.length===1&&this.children[0].isList}get isList(){let{ns:e,name:t}=this;return e==="rdf"&&(t==="Seq"||t==="Bag"||t==="Alt")}get isListItem(){return this.ns==="rdf"&&this.name==="li"}serialize(){if(this.properties.length===0&&this.value===void 0)return;if(this.isPrimitive)return this.value;if(this.isListContainer)return this.children[0].serialize();if(this.isList)return us(this.children.map(cs));if(this.isListItem&&this.children.length===1&&this.attrs.length===0)return this.children[0].serialize();let e={};for(let t of this.properties)rn(t,e);return this.value!==void 0&&(e.value=this.value),ur(e)}}function rn(n,e){let t=n.serialize();t!==void 0&&(e[n.name]=t)}var cs=n=>n.serialize(),us=n=>n.length===1?n[0]:n,hs=(n,e)=>e[n]?e[n]:e[n]={};function nn(n,e){let t,a=[];if(!n)return a;for(;(t=e.exec(n))!==null;)a.push(t);return a}function an(n){if(function(a){return a==null||a==="null"||a==="undefined"||a===""||a.trim()===""}(n))return;let e=Number(n);if(!Number.isNaN(e))return e;let t=n.toLowerCase();return t==="true"||t!=="false"&&n.trim()}const sn=["rdf:li","rdf:Seq","rdf:Bag","rdf:Alt","rdf:Description"],ms=new RegExp(`(<|\\/)(${sn.join("|")})`,"g");var ps=Object.freeze({__proto__:null,default:ds,Exifr:at,fileParsers:Ve,segmentParsers:ve,fileReaders:We,tagKeys:Ce,tagValues:je,tagRevivers:it,createDictionary:ye,extendDictionary:gt,fetchUrlAsArrayBuffer:mt,readBlobAsArrayBuffer:pt,chunkedProps:Ze,otherSegments:At,segments:yt,tiffBlocks:pe,segmentsAndBlocks:et,tiffExtractables:tt,inheritables:It,allFormatters:rt,Options:vt,parse:vr,gpsOnlyOptions:Yr,gps:$i,thumbnailOnlyOptions:$r,thumbnail:Ji,thumbnailUrl:Qi,orientationOnlyOptions:Jr,orientation:Qr,rotations:Zr,get rotateCanvas(){return ct},get rotateCss(){return ut},rotation:Zi});let Ii=cr("fs",n=>n.promises);We.set("fs",class extends br{async readWhole(){this.chunked=!1,this.fs=await Ii;let n=await this.fs.readFile(this.input);this._swapBuffer(n)}async readChunked(){this.chunked=!0,this.fs=await Ii,await this.open(),await this.readChunk(0,this.options.firstChunkSize)}async open(){this.fh===void 0&&(this.fh=await this.fs.open(this.input,"r"),this.size=(await this.fh.stat(this.input)).size)}async _readChunk(n,e){this.fh===void 0&&await this.open(),n+e>this.size&&(e=this.size-n);var t=this.subarray(n,e,!0);return await this.fh.read(t.dataView,0,e,n),t}async close(){if(this.fh){let n=this.fh;this.fh=void 0,await n.close()}}});We.set("base64",class extends br{constructor(...n){super(...n),this.input=this.input.replace(/^data:([^;]+);base64,/gim,""),this.size=this.input.length/4*3,this.input.endsWith("==")?this.size-=2:this.input.endsWith("=")&&(this.size-=1)}async _readChunk(n,e){let t,a,l=this.input;n===void 0?(n=0,t=0,a=0):(t=4*Math.floor(n/3),a=n-t/4*3),e===void 0&&(e=this.size);let c=n+e,p=t+4*Math.ceil(c/3);l=l.slice(t,p);let m=Math.min(e,this.size-n);if(wr){let P=yr.from(l,"base64").slice(a,a+m);return this.set(P,n,!0)}{let P=this.subarray(n,m,!0),A=atob(l),k=P.toUint8();for(let F=0;F<m;F++)k[F]=A.charCodeAt(a+F);return P}}});class Ei extends Sr{static canHandle(e,t){return t===18761||t===19789}extendOptions(e){let{ifd0:t,xmp:a,iptc:l,icc:c}=e;a.enabled&&t.deps.add(700),l.enabled&&t.deps.add(33723),c.enabled&&t.deps.add(34675),t.finalizeFilters()}async parse(){let{tiff:e,xmp:t,iptc:a,icc:l}=this.options;if(e.enabled||t.enabled||a.enabled||l.enabled){let c=Math.max(Br(this.options),this.options.chunkSize);await this.file.ensureChunk(0,c),this.createParser("tiff",this.file),this.parsers.tiff.parseHeader(),await this.parsers.tiff.parseIfd0Block(),this.adaptTiffPropAsSegment("xmp"),this.adaptTiffPropAsSegment("iptc"),this.adaptTiffPropAsSegment("icc")}}adaptTiffPropAsSegment(e){if(this.parsers.tiff[e]){let t=this.parsers.tiff[e];this.injectSegment(e,t)}}}W(Ei,"type","tiff"),Ve.set("tiff",Ei);let gs=cr("zlib");const ys=["ihdr","iccp","text","itxt","exif"];class Fi extends Sr{constructor(...e){super(...e),W(this,"catchError",t=>this.errors.push(t)),W(this,"metaChunks",[]),W(this,"unknownChunks",[])}static canHandle(e,t){return t===35152&&e.getUint32(0)===2303741511&&e.getUint32(4)===218765834}async parse(){let{file:e}=this;await this.findPngChunksInRange(8,e.byteLength),await this.readSegments(this.metaChunks),this.findIhdr(),this.parseTextChunks(),await this.findExif().catch(this.catchError),await this.findXmp().catch(this.catchError),await this.findIcc().catch(this.catchError)}async findPngChunksInRange(e,t){let{file:a}=this;for(;e<t;){let l=a.getUint32(e),c=a.getUint32(e+4),p=a.getString(e+4,4).toLowerCase(),m=l+4+4+4,P={type:p,offset:e,length:m,start:e+4+4,size:l,marker:c};ys.includes(p)?this.metaChunks.push(P):this.unknownChunks.push(P),e+=m}}parseTextChunks(){let e=this.metaChunks.filter(t=>t.type==="text");for(let t of e){let[a,l]=this.file.getString(t.start,t.size).split("\0");this.injectKeyValToIhdr(a,l)}}injectKeyValToIhdr(e,t){let a=this.parsers.ihdr;a&&a.raw.set(e,t)}findIhdr(){let e=this.metaChunks.find(t=>t.type==="ihdr");e&&this.options.ihdr.enabled!==!1&&this.createParser("ihdr",e.chunk)}async findExif(){let e=this.metaChunks.find(t=>t.type==="exif");e&&this.injectSegment("tiff",e.chunk)}async findXmp(){let e=this.metaChunks.filter(t=>t.type==="itxt");for(let t of e)t.chunk.getString(0,17)==="XML:com.adobe.xmp"&&this.injectSegment("xmp",t.chunk)}async findIcc(){let e=this.metaChunks.find(m=>m.type==="iccp");if(!e)return;let{chunk:t}=e,a=t.getUint8Array(0,81),l=0;for(;l<80&&a[l]!==0;)l++;let c=l+2,p=t.getString(0,l);if(this.injectKeyValToIhdr("ProfileName",p),fr){let m=await gs,P=t.getUint8Array(c);P=m.inflateSync(P),this.injectSegment("icc",P)}}}W(Fi,"type","png"),Ve.set("png",Fi),ye(Ce,"interop",[[1,"InteropIndex"],[2,"InteropVersion"],[4096,"RelatedImageFileFormat"],[4097,"RelatedImageWidth"],[4098,"RelatedImageHeight"]]),gt(Ce,"ifd0",[[11,"ProcessingSoftware"],[254,"SubfileType"],[255,"OldSubfileType"],[263,"Thresholding"],[264,"CellWidth"],[265,"CellLength"],[266,"FillOrder"],[269,"DocumentName"],[280,"MinSampleValue"],[281,"MaxSampleValue"],[285,"PageName"],[286,"XPosition"],[287,"YPosition"],[290,"GrayResponseUnit"],[297,"PageNumber"],[321,"HalftoneHints"],[322,"TileWidth"],[323,"TileLength"],[332,"InkSet"],[337,"TargetPrinter"],[18246,"Rating"],[18249,"RatingPercent"],[33550,"PixelScale"],[34264,"ModelTransform"],[34377,"PhotoshopSettings"],[50706,"DNGVersion"],[50707,"DNGBackwardVersion"],[50708,"UniqueCameraModel"],[50709,"LocalizedCameraModel"],[50736,"DNGLensInfo"],[50739,"ShadowScale"],[50740,"DNGPrivateData"],[33920,"IntergraphMatrix"],[33922,"ModelTiePoint"],[34118,"SEMInfo"],[34735,"GeoTiffDirectory"],[34736,"GeoTiffDoubleParams"],[34737,"GeoTiffAsciiParams"],[50341,"PrintIM"],[50721,"ColorMatrix1"],[50722,"ColorMatrix2"],[50723,"CameraCalibration1"],[50724,"CameraCalibration2"],[50725,"ReductionMatrix1"],[50726,"ReductionMatrix2"],[50727,"AnalogBalance"],[50728,"AsShotNeutral"],[50729,"AsShotWhiteXY"],[50730,"BaselineExposure"],[50731,"BaselineNoise"],[50732,"BaselineSharpness"],[50734,"LinearResponseLimit"],[50735,"CameraSerialNumber"],[50741,"MakerNoteSafety"],[50778,"CalibrationIlluminant1"],[50779,"CalibrationIlluminant2"],[50781,"RawDataUniqueID"],[50827,"OriginalRawFileName"],[50828,"OriginalRawFileData"],[50831,"AsShotICCProfile"],[50832,"AsShotPreProfileMatrix"],[50833,"CurrentICCProfile"],[50834,"CurrentPreProfileMatrix"],[50879,"ColorimetricReference"],[50885,"SRawType"],[50898,"PanasonicTitle"],[50899,"PanasonicTitle2"],[50931,"CameraCalibrationSig"],[50932,"ProfileCalibrationSig"],[50933,"ProfileIFD"],[50934,"AsShotProfileName"],[50936,"ProfileName"],[50937,"ProfileHueSatMapDims"],[50938,"ProfileHueSatMapData1"],[50939,"ProfileHueSatMapData2"],[50940,"ProfileToneCurve"],[50941,"ProfileEmbedPolicy"],[50942,"ProfileCopyright"],[50964,"ForwardMatrix1"],[50965,"ForwardMatrix2"],[50966,"PreviewApplicationName"],[50967,"PreviewApplicationVersion"],[50968,"PreviewSettingsName"],[50969,"PreviewSettingsDigest"],[50970,"PreviewColorSpace"],[50971,"PreviewDateTime"],[50972,"RawImageDigest"],[50973,"OriginalRawFileDigest"],[50981,"ProfileLookTableDims"],[50982,"ProfileLookTableData"],[51043,"TimeCodes"],[51044,"FrameRate"],[51058,"TStop"],[51081,"ReelName"],[51089,"OriginalDefaultFinalSize"],[51090,"OriginalBestQualitySize"],[51091,"OriginalDefaultCropSize"],[51105,"CameraLabel"],[51107,"ProfileHueSatMapEncoding"],[51108,"ProfileLookTableEncoding"],[51109,"BaselineExposureOffset"],[51110,"DefaultBlackRender"],[51111,"NewRawImageDigest"],[51112,"RawToPreviewGain"]]);let Di=[[273,"StripOffsets"],[279,"StripByteCounts"],[288,"FreeOffsets"],[289,"FreeByteCounts"],[291,"GrayResponseCurve"],[292,"T4Options"],[293,"T6Options"],[300,"ColorResponseUnit"],[320,"ColorMap"],[324,"TileOffsets"],[325,"TileByteCounts"],[326,"BadFaxLines"],[327,"CleanFaxData"],[328,"ConsecutiveBadFaxLines"],[330,"SubIFD"],[333,"InkNames"],[334,"NumberofInks"],[336,"DotRange"],[338,"ExtraSamples"],[339,"SampleFormat"],[340,"SMinSampleValue"],[341,"SMaxSampleValue"],[342,"TransferRange"],[343,"ClipPath"],[344,"XClipPathUnits"],[345,"YClipPathUnits"],[346,"Indexed"],[347,"JPEGTables"],[351,"OPIProxy"],[400,"GlobalParametersIFD"],[401,"ProfileType"],[402,"FaxProfile"],[403,"CodingMethods"],[404,"VersionYear"],[405,"ModeNumber"],[433,"Decode"],[434,"DefaultImageColor"],[435,"T82Options"],[437,"JPEGTables"],[512,"JPEGProc"],[515,"JPEGRestartInterval"],[517,"JPEGLosslessPredictors"],[518,"JPEGPointTransforms"],[519,"JPEGQTables"],[520,"JPEGDCTables"],[521,"JPEGACTables"],[559,"StripRowCounts"],[999,"USPTOMiscellaneous"],[18247,"XP_DIP_XML"],[18248,"StitchInfo"],[28672,"SonyRawFileType"],[28688,"SonyToneCurve"],[28721,"VignettingCorrection"],[28722,"VignettingCorrParams"],[28724,"ChromaticAberrationCorrection"],[28725,"ChromaticAberrationCorrParams"],[28726,"DistortionCorrection"],[28727,"DistortionCorrParams"],[29895,"SonyCropTopLeft"],[29896,"SonyCropSize"],[32781,"ImageID"],[32931,"WangTag1"],[32932,"WangAnnotation"],[32933,"WangTag3"],[32934,"WangTag4"],[32953,"ImageReferencePoints"],[32954,"RegionXformTackPoint"],[32955,"WarpQuadrilateral"],[32956,"AffineTransformMat"],[32995,"Matteing"],[32996,"DataType"],[32997,"ImageDepth"],[32998,"TileDepth"],[33300,"ImageFullWidth"],[33301,"ImageFullHeight"],[33302,"TextureFormat"],[33303,"WrapModes"],[33304,"FovCot"],[33305,"MatrixWorldToScreen"],[33306,"MatrixWorldToCamera"],[33405,"Model2"],[33421,"CFARepeatPatternDim"],[33422,"CFAPattern2"],[33423,"BatteryLevel"],[33424,"KodakIFD"],[33445,"MDFileTag"],[33446,"MDScalePixel"],[33447,"MDColorTable"],[33448,"MDLabName"],[33449,"MDSampleInfo"],[33450,"MDPrepDate"],[33451,"MDPrepTime"],[33452,"MDFileUnits"],[33589,"AdventScale"],[33590,"AdventRevision"],[33628,"UIC1Tag"],[33629,"UIC2Tag"],[33630,"UIC3Tag"],[33631,"UIC4Tag"],[33918,"IntergraphPacketData"],[33919,"IntergraphFlagRegisters"],[33921,"INGRReserved"],[34016,"Site"],[34017,"ColorSequence"],[34018,"IT8Header"],[34019,"RasterPadding"],[34020,"BitsPerRunLength"],[34021,"BitsPerExtendedRunLength"],[34022,"ColorTable"],[34023,"ImageColorIndicator"],[34024,"BackgroundColorIndicator"],[34025,"ImageColorValue"],[34026,"BackgroundColorValue"],[34027,"PixelIntensityRange"],[34028,"TransparencyIndicator"],[34029,"ColorCharacterization"],[34030,"HCUsage"],[34031,"TrapIndicator"],[34032,"CMYKEquivalent"],[34152,"AFCP_IPTC"],[34232,"PixelMagicJBIGOptions"],[34263,"JPLCartoIFD"],[34306,"WB_GRGBLevels"],[34310,"LeafData"],[34687,"TIFF_FXExtensions"],[34688,"MultiProfiles"],[34689,"SharedData"],[34690,"T88Options"],[34732,"ImageLayer"],[34750,"JBIGOptions"],[34856,"Opto-ElectricConvFactor"],[34857,"Interlace"],[34908,"FaxRecvParams"],[34909,"FaxSubAddress"],[34910,"FaxRecvTime"],[34929,"FedexEDR"],[34954,"LeafSubIFD"],[37387,"FlashEnergy"],[37388,"SpatialFrequencyResponse"],[37389,"Noise"],[37390,"FocalPlaneXResolution"],[37391,"FocalPlaneYResolution"],[37392,"FocalPlaneResolutionUnit"],[37397,"ExposureIndex"],[37398,"TIFF-EPStandardID"],[37399,"SensingMethod"],[37434,"CIP3DataFile"],[37435,"CIP3Sheet"],[37436,"CIP3Side"],[37439,"StoNits"],[37679,"MSDocumentText"],[37680,"MSPropertySetStorage"],[37681,"MSDocumentTextPosition"],[37724,"ImageSourceData"],[40965,"InteropIFD"],[40976,"SamsungRawPointersOffset"],[40977,"SamsungRawPointersLength"],[41217,"SamsungRawByteOrder"],[41218,"SamsungRawUnknown"],[41484,"SpatialFrequencyResponse"],[41485,"Noise"],[41489,"ImageNumber"],[41490,"SecurityClassification"],[41491,"ImageHistory"],[41494,"TIFF-EPStandardID"],[41995,"DeviceSettingDescription"],[42112,"GDALMetadata"],[42113,"GDALNoData"],[44992,"ExpandSoftware"],[44993,"ExpandLens"],[44994,"ExpandFilm"],[44995,"ExpandFilterLens"],[44996,"ExpandScanner"],[44997,"ExpandFlashLamp"],[46275,"HasselbladRawImage"],[48129,"PixelFormat"],[48130,"Transformation"],[48131,"Uncompressed"],[48132,"ImageType"],[48256,"ImageWidth"],[48257,"ImageHeight"],[48258,"WidthResolution"],[48259,"HeightResolution"],[48320,"ImageOffset"],[48321,"ImageByteCount"],[48322,"AlphaOffset"],[48323,"AlphaByteCount"],[48324,"ImageDataDiscard"],[48325,"AlphaDataDiscard"],[50215,"OceScanjobDesc"],[50216,"OceApplicationSelector"],[50217,"OceIDNumber"],[50218,"OceImageLogic"],[50255,"Annotations"],[50459,"HasselbladExif"],[50547,"OriginalFileName"],[50560,"USPTOOriginalContentType"],[50656,"CR2CFAPattern"],[50710,"CFAPlaneColor"],[50711,"CFALayout"],[50712,"LinearizationTable"],[50713,"BlackLevelRepeatDim"],[50714,"BlackLevel"],[50715,"BlackLevelDeltaH"],[50716,"BlackLevelDeltaV"],[50717,"WhiteLevel"],[50718,"DefaultScale"],[50719,"DefaultCropOrigin"],[50720,"DefaultCropSize"],[50733,"BayerGreenSplit"],[50737,"ChromaBlurRadius"],[50738,"AntiAliasStrength"],[50752,"RawImageSegmentation"],[50780,"BestQualityScale"],[50784,"AliasLayerMetadata"],[50829,"ActiveArea"],[50830,"MaskedAreas"],[50935,"NoiseReductionApplied"],[50974,"SubTileBlockSize"],[50975,"RowInterleaveFactor"],[51008,"OpcodeList1"],[51009,"OpcodeList2"],[51022,"OpcodeList3"],[51041,"NoiseProfile"],[51114,"CacheVersion"],[51125,"DefaultUserCrop"],[51157,"NikonNEFInfo"],[65024,"KdcIFD"]];gt(Ce,"ifd0",Di),gt(Ce,"exif",Di),ye(je,"gps",[[23,{M:"Magnetic North",T:"True North"}],[25,{K:"Kilometers",M:"Miles",N:"Nautical Miles"}]]);class Mr extends Ue{static canHandle(e,t){return e.getUint8(t+1)===224&&e.getUint32(t+4)===1246120262&&e.getUint8(t+8)===0}parse(){return this.parseTags(),this.translate(),this.output}parseTags(){this.raw=new Map([[0,this.chunk.getUint16(0)],[2,this.chunk.getUint8(2)],[3,this.chunk.getUint16(3)],[5,this.chunk.getUint16(5)],[7,this.chunk.getUint8(7)],[8,this.chunk.getUint8(8)]])}}W(Mr,"type","jfif"),W(Mr,"headerLength",9),ve.set("jfif",Mr),ye(Ce,"jfif",[[0,"JFIFVersion"],[2,"ResolutionUnit"],[3,"XResolution"],[5,"YResolution"],[7,"ThumbnailWidth"],[8,"ThumbnailHeight"]]);class Ri extends Ue{parse(){return this.parseTags(),this.translate(),this.output}parseTags(){this.raw=new Map([[0,this.chunk.getUint32(0)],[4,this.chunk.getUint32(4)],[8,this.chunk.getUint8(8)],[9,this.chunk.getUint8(9)],[10,this.chunk.getUint8(10)],[11,this.chunk.getUint8(11)],[12,this.chunk.getUint8(12)],...Array.from(this.raw)])}}W(Ri,"type","ihdr"),ve.set("ihdr",Ri),ye(Ce,"ihdr",[[0,"ImageWidth"],[4,"ImageHeight"],[8,"BitDepth"],[9,"ColorType"],[10,"Compression"],[11,"Filter"],[12,"Interlace"]]),ye(je,"ihdr",[[9,{0:"Grayscale",2:"RGB",3:"Palette",4:"Grayscale with Alpha",6:"RGB with Alpha",DEFAULT:"Unknown"}],[10,{0:"Deflate/Inflate",DEFAULT:"Unknown"}],[11,{0:"Adaptive",DEFAULT:"Unknown"}],[12,{0:"Noninterlaced",1:"Adam7 Interlace",DEFAULT:"Unknown"}]]);class lr extends Ue{static canHandle(e,t){return e.getUint8(t+1)===226&&e.getUint32(t+4)===1229144927}static findPosition(e,t){let a=super.findPosition(e,t);return a.chunkNumber=e.getUint8(t+16),a.chunkCount=e.getUint8(t+17),a.multiSegment=a.chunkCount>1,a}static handleMultiSegments(e){return function(t){let a=function(l){let c=l[0].constructor,p=0;for(let A of l)p+=A.length;let m=new c(p),P=0;for(let A of l)m.set(A,P),P+=A.length;return m}(t.map(l=>l.chunk.toUint8()));return new De(a)}(e)}parse(){return this.raw=new Map,this.parseHeader(),this.parseTags(),this.translate(),this.output}parseHeader(){let{raw:e}=this;this.chunk.byteLength<84&&Se("ICC header is too short");for(let[t,a]of Object.entries(ws)){t=parseInt(t,10);let l=a(this.chunk,t);l!=="\0\0\0\0"&&e.set(t,l)}}parseTags(){let e,t,a,l,c,{raw:p}=this,m=this.chunk.getUint32(128),P=132,A=this.chunk.byteLength;for(;m--;){if(e=this.chunk.getString(P,4),t=this.chunk.getUint32(P+4),a=this.chunk.getUint32(P+8),l=this.chunk.getString(t,4),t+a>A)return void console.warn("reached the end of the first ICC chunk. Enable options.tiff.multiSegment to read all ICC segments.");c=this.parseTag(l,t,a),c!==void 0&&c!=="\0\0\0\0"&&p.set(e,c),P+=12}}parseTag(e,t,a){switch(e){case"desc":return this.parseDesc(t);case"mluc":return this.parseMluc(t);case"text":return this.parseText(t,a);case"sig ":return this.parseSig(t)}if(!(t+a>this.chunk.byteLength))return this.chunk.getUint8Array(t,a)}parseDesc(e){let t=this.chunk.getUint32(e+8)-1;return ft(this.chunk.getString(e+12,t))}parseText(e,t){return ft(this.chunk.getString(e+8,t-8))}parseSig(e){return ft(this.chunk.getString(e+8,4))}parseMluc(e){let{chunk:t}=this,a=t.getUint32(e+8),l=t.getUint32(e+12),c=e+16,p=[];for(let m=0;m<a;m++){let P=t.getString(c+0,2),A=t.getString(c+2,2),k=t.getUint32(c+4),F=t.getUint32(c+8)+e,L=ft(t.getUnicodeString(F,k));p.push({lang:P,country:A,text:L}),c+=l}return a===1?p[0].text:p}translateValue(e,t){return typeof e=="string"?t[e]||t[e.toLowerCase()]||e:t[e]||e}}W(lr,"type","icc"),W(lr,"multiSegment",!0),W(lr,"headerLength",18);const ws={4:qe,8:function(n,e){return[n.getUint8(e),n.getUint8(e+1)>>4,n.getUint8(e+1)%16].map(t=>t.toString(10)).join(".")},12:qe,16:qe,20:qe,24:function(n,e){const t=n.getUint16(e),a=n.getUint16(e+2)-1,l=n.getUint16(e+4),c=n.getUint16(e+6),p=n.getUint16(e+8),m=n.getUint16(e+10);return new Date(Date.UTC(t,a,l,c,p,m))},36:qe,40:qe,48:qe,52:qe,64:(n,e)=>n.getUint32(e),80:qe};function qe(n,e){return ft(n.getString(e,4))}ve.set("icc",lr),ye(Ce,"icc",[[4,"ProfileCMMType"],[8,"ProfileVersion"],[12,"ProfileClass"],[16,"ColorSpaceData"],[20,"ProfileConnectionSpace"],[24,"ProfileDateTime"],[36,"ProfileFileSignature"],[40,"PrimaryPlatform"],[44,"CMMFlags"],[48,"DeviceManufacturer"],[52,"DeviceModel"],[56,"DeviceAttributes"],[64,"RenderingIntent"],[68,"ConnectionSpaceIlluminant"],[80,"ProfileCreator"],[84,"ProfileID"],["Header","ProfileHeader"],["MS00","WCSProfiles"],["bTRC","BlueTRC"],["bXYZ","BlueMatrixColumn"],["bfd","UCRBG"],["bkpt","MediaBlackPoint"],["calt","CalibrationDateTime"],["chad","ChromaticAdaptation"],["chrm","Chromaticity"],["ciis","ColorimetricIntentImageState"],["clot","ColorantTableOut"],["clro","ColorantOrder"],["clrt","ColorantTable"],["cprt","ProfileCopyright"],["crdi","CRDInfo"],["desc","ProfileDescription"],["devs","DeviceSettings"],["dmdd","DeviceModelDesc"],["dmnd","DeviceMfgDesc"],["dscm","ProfileDescriptionML"],["fpce","FocalPlaneColorimetryEstimates"],["gTRC","GreenTRC"],["gXYZ","GreenMatrixColumn"],["gamt","Gamut"],["kTRC","GrayTRC"],["lumi","Luminance"],["meas","Measurement"],["meta","Metadata"],["mmod","MakeAndModel"],["ncl2","NamedColor2"],["ncol","NamedColor"],["ndin","NativeDisplayInfo"],["pre0","Preview0"],["pre1","Preview1"],["pre2","Preview2"],["ps2i","PS2RenderingIntent"],["ps2s","PostScript2CSA"],["psd0","PostScript2CRD0"],["psd1","PostScript2CRD1"],["psd2","PostScript2CRD2"],["psd3","PostScript2CRD3"],["pseq","ProfileSequenceDesc"],["psid","ProfileSequenceIdentifier"],["psvm","PS2CRDVMSize"],["rTRC","RedTRC"],["rXYZ","RedMatrixColumn"],["resp","OutputResponse"],["rhoc","ReflectionHardcopyOrigColorimetry"],["rig0","PerceptualRenderingIntentGamut"],["rig2","SaturationRenderingIntentGamut"],["rpoc","ReflectionPrintOutputColorimetry"],["sape","SceneAppearanceEstimates"],["scoe","SceneColorimetryEstimates"],["scrd","ScreeningDesc"],["scrn","Screening"],["targ","CharTarget"],["tech","Technology"],["vcgt","VideoCardGamma"],["view","ViewingConditions"],["vued","ViewingCondDesc"],["wtpt","MediaWhitePoint"]]);const ir={"4d2p":"Erdt Systems",AAMA:"Aamazing Technologies",ACER:"Acer",ACLT:"Acolyte Color Research",ACTI:"Actix Sytems",ADAR:"Adara Technology",ADBE:"Adobe",ADI:"ADI Systems",AGFA:"Agfa Graphics",ALMD:"Alps Electric",ALPS:"Alps Electric",ALWN:"Alwan Color Expertise",AMTI:"Amiable Technologies",AOC:"AOC International",APAG:"Apago",APPL:"Apple Computer",AST:"AST","AT&T":"AT&T",BAEL:"BARBIERI electronic",BRCO:"Barco NV",BRKP:"Breakpoint",BROT:"Brother",BULL:"Bull",BUS:"Bus Computer Systems","C-IT":"C-Itoh",CAMR:"Intel",CANO:"Canon",CARR:"Carroll Touch",CASI:"Casio",CBUS:"Colorbus PL",CEL:"Crossfield",CELx:"Crossfield",CGS:"CGS Publishing Technologies International",CHM:"Rochester Robotics",CIGL:"Colour Imaging Group, London",CITI:"Citizen",CL00:"Candela",CLIQ:"Color IQ",CMCO:"Chromaco",CMiX:"CHROMiX",COLO:"Colorgraphic Communications",COMP:"Compaq",COMp:"Compeq/Focus Technology",CONR:"Conrac Display Products",CORD:"Cordata Technologies",CPQ:"Compaq",CPRO:"ColorPro",CRN:"Cornerstone",CTX:"CTX International",CVIS:"ColorVision",CWC:"Fujitsu Laboratories",DARI:"Darius Technology",DATA:"Dataproducts",DCP:"Dry Creek Photo",DCRC:"Digital Contents Resource Center, Chung-Ang University",DELL:"Dell Computer",DIC:"Dainippon Ink and Chemicals",DICO:"Diconix",DIGI:"Digital","DL&C":"Digital Light & Color",DPLG:"Doppelganger",DS:"Dainippon Screen",DSOL:"DOOSOL",DUPN:"DuPont",EPSO:"Epson",ESKO:"Esko-Graphics",ETRI:"Electronics and Telecommunications Research Institute",EVER:"Everex Systems",EXAC:"ExactCODE",Eizo:"Eizo",FALC:"Falco Data Products",FF:"Fuji Photo Film",FFEI:"FujiFilm Electronic Imaging",FNRD:"Fnord Software",FORA:"Fora",FORE:"Forefront Technology",FP:"Fujitsu",FPA:"WayTech Development",FUJI:"Fujitsu",FX:"Fuji Xerox",GCC:"GCC Technologies",GGSL:"Global Graphics Software",GMB:"Gretagmacbeth",GMG:"GMG",GOLD:"GoldStar Technology",GOOG:"Google",GPRT:"Giantprint",GTMB:"Gretagmacbeth",GVC:"WayTech Development",GW2K:"Sony",HCI:"HCI",HDM:"Heidelberger Druckmaschinen",HERM:"Hermes",HITA:"Hitachi America",HP:"Hewlett-Packard",HTC:"Hitachi",HiTi:"HiTi Digital",IBM:"IBM",IDNT:"Scitex",IEC:"Hewlett-Packard",IIYA:"Iiyama North America",IKEG:"Ikegami Electronics",IMAG:"Image Systems",IMI:"Ingram Micro",INTC:"Intel",INTL:"N/A (INTL)",INTR:"Intra Electronics",IOCO:"Iocomm International Technology",IPS:"InfoPrint Solutions Company",IRIS:"Scitex",ISL:"Ichikawa Soft Laboratory",ITNL:"N/A (ITNL)",IVM:"IVM",IWAT:"Iwatsu Electric",Idnt:"Scitex",Inca:"Inca Digital Printers",Iris:"Scitex",JPEG:"Joint Photographic Experts Group",JSFT:"Jetsoft Development",JVC:"JVC Information Products",KART:"Scitex",KFC:"KFC Computek Components",KLH:"KLH Computers",KMHD:"Konica Minolta",KNCA:"Konica",KODA:"Kodak",KYOC:"Kyocera",Kart:"Scitex",LCAG:"Leica",LCCD:"Leeds Colour",LDAK:"Left Dakota",LEAD:"Leading Technology",LEXM:"Lexmark International",LINK:"Link Computer",LINO:"Linotronic",LITE:"Lite-On",Leaf:"Leaf",Lino:"Linotronic",MAGC:"Mag Computronic",MAGI:"MAG Innovision",MANN:"Mannesmann",MICN:"Micron Technology",MICR:"Microtek",MICV:"Microvitec",MINO:"Minolta",MITS:"Mitsubishi Electronics America",MITs:"Mitsuba",MNLT:"Minolta",MODG:"Modgraph",MONI:"Monitronix",MONS:"Monaco Systems",MORS:"Morse Technology",MOTI:"Motive Systems",MSFT:"Microsoft",MUTO:"MUTOH INDUSTRIES",Mits:"Mitsubishi Electric",NANA:"NANAO",NEC:"NEC",NEXP:"NexPress Solutions",NISS:"Nissei Sangyo America",NKON:"Nikon",NONE:"none",OCE:"Oce Technologies",OCEC:"OceColor",OKI:"Oki",OKID:"Okidata",OKIP:"Okidata",OLIV:"Olivetti",OLYM:"Olympus",ONYX:"Onyx Graphics",OPTI:"Optiquest",PACK:"Packard Bell",PANA:"Matsushita Electric Industrial",PANT:"Pantone",PBN:"Packard Bell",PFU:"PFU",PHIL:"Philips Consumer Electronics",PNTX:"HOYA",POne:"Phase One A/S",PREM:"Premier Computer Innovations",PRIN:"Princeton Graphic Systems",PRIP:"Princeton Publishing Labs",QLUX:"Hong Kong",QMS:"QMS",QPCD:"QPcard AB",QUAD:"QuadLaser",QUME:"Qume",RADI:"Radius",RDDx:"Integrated Color Solutions",RDG:"Roland DG",REDM:"REDMS Group",RELI:"Relisys",RGMS:"Rolf Gierling Multitools",RICO:"Ricoh",RNLD:"Edmund Ronald",ROYA:"Royal",RPC:"Ricoh Printing Systems",RTL:"Royal Information Electronics",SAMP:"Sampo",SAMS:"Samsung",SANT:"Jaime Santana Pomares",SCIT:"Scitex",SCRN:"Dainippon Screen",SDP:"Scitex",SEC:"Samsung",SEIK:"Seiko Instruments",SEIk:"Seikosha",SGUY:"ScanGuy.com",SHAR:"Sharp Laboratories",SICC:"International Color Consortium",SONY:"Sony",SPCL:"SpectraCal",STAR:"Star",STC:"Sampo Technology",Scit:"Scitex",Sdp:"Scitex",Sony:"Sony",TALO:"Talon Technology",TAND:"Tandy",TATU:"Tatung",TAXA:"TAXAN America",TDS:"Tokyo Denshi Sekei",TECO:"TECO Information Systems",TEGR:"Tegra",TEKT:"Tektronix",TI:"Texas Instruments",TMKR:"TypeMaker",TOSB:"Toshiba",TOSH:"Toshiba",TOTK:"TOTOKU ELECTRIC",TRIU:"Triumph",TSBT:"Toshiba",TTX:"TTX Computer Products",TVM:"TVM Professional Monitor",TW:"TW Casper",ULSX:"Ulead Systems",UNIS:"Unisys",UTZF:"Utz Fehlau & Sohn",VARI:"Varityper",VIEW:"Viewsonic",VISL:"Visual communication",VIVO:"Vivo Mobile Communication",WANG:"Wang",WLBR:"Wilbur Imaging",WTG2:"Ware To Go",WYSE:"WYSE Technology",XERX:"Xerox",XRIT:"X-Rite",ZRAN:"Zoran",Zebr:"Zebra Technologies",appl:"Apple Computer",bICC:"basICColor",berg:"bergdesign",ceyd:"Integrated Color Solutions",clsp:"MacDermid ColorSpan",ds:"Dainippon Screen",dupn:"DuPont",ffei:"FujiFilm Electronic Imaging",flux:"FluxData",iris:"Scitex",kart:"Scitex",lcms:"Little CMS",lino:"Linotronic",none:"none",ob4d:"Erdt Systems",obic:"Medigraph",quby:"Qubyx Sarl",scit:"Scitex",scrn:"Dainippon Screen",sdp:"Scitex",siwi:"SIWI GRAFIKA",yxym:"YxyMaster"},Ti={scnr:"Scanner",mntr:"Monitor",prtr:"Printer",link:"Device Link",abst:"Abstract",spac:"Color Space Conversion Profile",nmcl:"Named Color",cenc:"ColorEncodingSpace profile",mid:"MultiplexIdentification profile",mlnk:"MultiplexLink profile",mvis:"MultiplexVisualization profile",nkpf:"Nikon Input Device Profile (NON-STANDARD!)"};ye(je,"icc",[[4,ir],[12,Ti],[40,Object.assign({},ir,Ti)],[48,ir],[80,ir],[64,{0:"Perceptual",1:"Relative Colorimetric",2:"Saturation",3:"Absolute Colorimetric"}],["tech",{amd:"Active Matrix Display",crt:"Cathode Ray Tube Display",kpcd:"Photo CD",pmd:"Passive Matrix Display",dcam:"Digital Camera",dcpj:"Digital Cinema Projector",dmpc:"Digital Motion Picture Camera",dsub:"Dye Sublimation Printer",epho:"Electrophotographic Printer",esta:"Electrostatic Printer",flex:"Flexography",fprn:"Film Writer",fscn:"Film Scanner",grav:"Gravure",ijet:"Ink Jet Printer",imgs:"Photo Image Setter",mpfr:"Motion Picture Film Recorder",mpfs:"Motion Picture Film Scanner",offs:"Offset Lithography",pjtv:"Projection Television",rpho:"Photographic Paper Printer",rscn:"Reflective Scanner",silk:"Silkscreen",twax:"Thermal Wax Printer",vidc:"Video Camera",vidm:"Video Monitor"}]]);class nr extends Ue{static canHandle(e,t,a){return e.getUint8(t+1)===237&&e.getString(t+4,9)==="Photoshop"&&this.containsIptc8bim(e,t,a)!==void 0}static headerLength(e,t,a){let l,c=this.containsIptc8bim(e,t,a);if(c!==void 0)return l=e.getUint8(t+c+7),l%2!=0&&(l+=1),l===0&&(l=4),c+8+l}static containsIptc8bim(e,t,a){for(let l=0;l<a;l++)if(this.isIptcSegmentHead(e,t+l))return l}static isIptcSegmentHead(e,t){return e.getUint8(t)===56&&e.getUint32(t)===943868237&&e.getUint16(t+4)===1028}parse(){let{raw:e}=this,t=this.chunk.byteLength-1,a=!1;for(let l=0;l<t;l++)if(this.chunk.getUint8(l)===28&&this.chunk.getUint8(l+1)===2){a=!0;let c=this.chunk.getUint16(l+3),p=this.chunk.getUint8(l+2),m=this.chunk.getLatin1String(l+5,c);e.set(p,this.pluralizeValue(e.get(p),m)),l+=4+c}else if(a)break;return this.translate(),this.output}pluralizeValue(e,t){return e!==void 0?e instanceof Array?(e.push(t),e):[e,t]:t}}W(nr,"type","iptc"),W(nr,"translateValues",!1),W(nr,"reviveValues",!1),ve.set("iptc",nr),ye(Ce,"iptc",[[0,"ApplicationRecordVersion"],[3,"ObjectTypeReference"],[4,"ObjectAttributeReference"],[5,"ObjectName"],[7,"EditStatus"],[8,"EditorialUpdate"],[10,"Urgency"],[12,"SubjectReference"],[15,"Category"],[20,"SupplementalCategories"],[22,"FixtureIdentifier"],[25,"Keywords"],[26,"ContentLocationCode"],[27,"ContentLocationName"],[30,"ReleaseDate"],[35,"ReleaseTime"],[37,"ExpirationDate"],[38,"ExpirationTime"],[40,"SpecialInstructions"],[42,"ActionAdvised"],[45,"ReferenceService"],[47,"ReferenceDate"],[50,"ReferenceNumber"],[55,"DateCreated"],[60,"TimeCreated"],[62,"DigitalCreationDate"],[63,"DigitalCreationTime"],[65,"OriginatingProgram"],[70,"ProgramVersion"],[75,"ObjectCycle"],[80,"Byline"],[85,"BylineTitle"],[90,"City"],[92,"Sublocation"],[95,"State"],[100,"CountryCode"],[101,"Country"],[103,"OriginalTransmissionReference"],[105,"Headline"],[110,"Credit"],[115,"Source"],[116,"CopyrightNotice"],[118,"Contact"],[120,"Caption"],[121,"LocalCaption"],[122,"Writer"],[125,"RasterizedCaption"],[130,"ImageType"],[131,"ImageOrientation"],[135,"LanguageIdentifier"],[150,"AudioType"],[151,"AudioSamplingRate"],[152,"AudioSamplingResolution"],[153,"AudioDuration"],[154,"AudioOutcue"],[184,"JobID"],[185,"MasterDocumentID"],[186,"ShortDocumentID"],[187,"UniqueDocumentID"],[188,"OwnerID"],[200,"ObjectPreviewFileFormat"],[201,"ObjectPreviewFileVersion"],[202,"ObjectPreviewData"],[221,"Prefs"],[225,"ClassifyState"],[228,"SimilarityIndex"],[230,"DocumentNotes"],[231,"DocumentHistory"],[232,"ExifCameraInfo"],[255,"CatalogSets"]]),ye(je,"iptc",[[10,{0:"0 (reserved)",1:"1 (most urgent)",2:"2",3:"3",4:"4",5:"5 (normal urgency)",6:"6",7:"7",8:"8 (least urgent)",9:"9 (user-defined priority)"}],[75,{a:"Morning",b:"Both Morning and Evening",p:"Evening"}],[131,{L:"Landscape",P:"Portrait",S:"Square"}]]);var vs=function(n,e,t,a){function l(c){return c instanceof t?c:new t(function(p){p(c)})}return new(t||(t=Promise))(function(c,p){function m(k){try{A(a.next(k))}catch(F){p(F)}}function P(k){try{A(a.throw(k))}catch(F){p(F)}}function A(k){k.done?c(k.value):l(k.value).then(m,P)}A((a=a.apply(n,e||[])).next())})};function Li(n){return vs(this,void 0,void 0,function*(){try{const e=yield ps.parse(n);console.log(e);const t={};if(e!=null&&e.latitude&&(e!=null&&e.longitude)&&(t.latitude=e.latitude,t.longitude=e.longitude),e!=null&&e.altitude&&(t.altitude=e.altitude),e!=null&&e.DateTimeOriginal?t.taken_at=new Date(e.DateTimeOriginal).toISOString():e!=null&&e.DateTime&&(t.taken_at=new Date(e.DateTime).toISOString()),e!=null&&e.Make&&(t.camera_make=e.Make.toString().trim()),e!=null&&e.Model&&(t.camera_model=e.Model.toString().trim()),e!=null&&e.ISO&&(t.iso=parseInt(e.ISO.toString())),e!=null&&e.FNumber&&(t.aperture=`f/${e.FNumber}`),e!=null&&e.ExposureTime){const a=parseFloat(e.ExposureTime.toString());a<1?t.shutter_speed=`1/${Math.round(1/a)}`:t.shutter_speed=`${a}s`}return e!=null&&e.FocalLength&&(t.focal_length=parseFloat(e.FocalLength.toString())),t}catch(e){return console.warn("Failed to extract EXIF data:",e),{}}})}var xr="Checkbox",[Ss,Yo]=Qn(xr),[bs,ei]=Ss(xr);function xs(n){const{__scopeCheckbox:e,checked:t,children:a,defaultChecked:l,disabled:c,form:p,name:m,onCheckedChange:P,required:A,value:k="on",internal_do_not_use_render:F}=n,[L,D]=ea({prop:t,defaultProp:l??!1,onChange:P,caller:xr}),[U,$]=le.useState(null),[de,fe]=le.useState(null),ce=le.useRef(!1),xe=U?!!p||!!U.closest("form"):!0,ge={checked:L,disabled:c,setChecked:D,control:U,setControl:$,name:m,form:p,value:k,hasConsumerStoppedPropagationRef:ce,required:A,defaultChecked:nt(l)?!1:l,isFormControl:xe,bubbleInput:de,setBubbleInput:fe};return u.jsx(bs,{scope:e,...ge,children:Cs(F)?F(ge):a})}var on="CheckboxTrigger",ln=le.forwardRef(({__scopeCheckbox:n,onKeyDown:e,onClick:t,...a},l)=>{const{control:c,value:p,disabled:m,checked:P,required:A,setControl:k,setChecked:F,hasConsumerStoppedPropagationRef:L,isFormControl:D,bubbleInput:U}=ei(on,n),$=Ui(l,k),de=le.useRef(P);return le.useEffect(()=>{const fe=c==null?void 0:c.form;if(fe){const ce=()=>F(de.current);return fe.addEventListener("reset",ce),()=>fe.removeEventListener("reset",ce)}},[c,F]),u.jsx(Wr.button,{type:"button",role:"checkbox","aria-checked":nt(P)?"mixed":P,"aria-required":A,"data-state":mn(P),"data-disabled":m?"":void 0,disabled:m,value:p,...a,ref:$,onKeyDown:ci(e,fe=>{fe.key==="Enter"&&fe.preventDefault()}),onClick:ci(t,fe=>{F(ce=>nt(ce)?!0:!ce),U&&D&&(L.current=fe.isPropagationStopped(),L.current||fe.stopPropagation())})})});ln.displayName=on;var dn=le.forwardRef((n,e)=>{const{__scopeCheckbox:t,name:a,checked:l,defaultChecked:c,required:p,disabled:m,value:P,onCheckedChange:A,form:k,...F}=n;return u.jsx(xs,{__scopeCheckbox:t,checked:l,defaultChecked:c,disabled:m,required:p,onCheckedChange:A,name:a,form:k,value:P,internal_do_not_use_render:({isFormControl:L})=>u.jsxs(u.Fragment,{children:[u.jsx(ln,{...F,ref:e,__scopeCheckbox:t}),L&&u.jsx(hn,{__scopeCheckbox:t})]})})});dn.displayName=xr;var fn="CheckboxIndicator",cn=le.forwardRef((n,e)=>{const{__scopeCheckbox:t,forceMount:a,...l}=n,c=ei(fn,t);return u.jsx(Zn,{present:a||nt(c.checked)||c.checked===!0,children:u.jsx(Wr.span,{"data-state":mn(c.checked),"data-disabled":c.disabled?"":void 0,...l,ref:e,style:{pointerEvents:"none",...n.style}})})});cn.displayName=fn;var un="CheckboxBubbleInput",hn=le.forwardRef(({__scopeCheckbox:n,...e},t)=>{const{control:a,hasConsumerStoppedPropagationRef:l,checked:c,defaultChecked:p,required:m,disabled:P,name:A,value:k,form:F,bubbleInput:L,setBubbleInput:D}=ei(un,n),U=Ui(t,D),$=Ia(c),de=ta(a);le.useEffect(()=>{const ce=L;if(!ce)return;const xe=window.HTMLInputElement.prototype,v=Object.getOwnPropertyDescriptor(xe,"checked").set,S=!l.current;if($!==c&&v){const x=new Event("click",{bubbles:S});ce.indeterminate=nt(c),v.call(ce,nt(c)?!1:c),ce.dispatchEvent(x)}},[L,$,c,l]);const fe=le.useRef(nt(c)?!1:c);return u.jsx(Wr.input,{type:"checkbox","aria-hidden":!0,defaultChecked:p??fe.current,required:m,disabled:P,name:A,value:k,form:F,...e,tabIndex:-1,ref:U,style:{...e.style,...de,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});hn.displayName=un;function Cs(n){return typeof n=="function"}function nt(n){return n==="indeterminate"}function mn(n){return nt(n)?"indeterminate":n?"checked":"unchecked"}function _s({className:n,...e}){return u.jsx(dn,{"data-slot":"checkbox",className:ra("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",n),...e,children:u.jsx(cn,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:u.jsx(Ea,{className:"size-3.5"})})})}var kt,Pt,dr,ht;let ks=(ht=class{constructor(e){Er(this,Pt);Pe(this,"fields");Er(this,kt);this.fields=e,fi(this,kt,this.fields.reduce((t,a)=>t+a.builder.size,0))}get size(){return Ir(this,kt)}field(e,t){return new ht([...this.fields,{name:e,builder:t,offset:Ir(this,kt)}])}override(e,t){const a=this.fields.reduce((l,c)=>{const p=l.at(-1),m=p?p.offset+p.builder.size:0;return l.push(c.name===e?{name:e,builder:t,offset:m}:{...c,offset:m}),l},[]);return new ht(a)}proxy(e){return $t(this,Pt,dr).call(this,e,!0)}read(e){const t=$t(this,Pt,dr).call(this,e);return Object.fromEntries(Object.entries(t))}write(e,t){const a=$t(this,Pt,dr).call(this,t);for(const l of this.fields.map(c=>c.name))a[l]=e[l]}},kt=new WeakMap,Pt=new WeakSet,dr=function(e,t=!1){const{buf:a,offset:l=0,endian:c="little"}=e,p=this,m=Object.fromEntries(p.fields.map(A=>[A.name,!0])),P=new Proxy(m,{get(A,k){if(typeof k!="string")return;const F=p.fields.find(L=>L.name===k);if(F)return t&&typeof F.builder.proxy=="function"?F.builder.proxy({buf:a,offset:l+F.offset,endian:c},P):F.builder.read({buf:a,offset:l+F.offset,endian:c},P)},set(A,k,F){if(typeof k!="string")return!1;const L=p.fields.find(D=>D.name===k);return!L||typeof L.builder.write!="function"?!1:(L.builder.write(F,{buf:a,offset:l+L.offset,endian:c},P),!0)}});return P},ht);const ke="big";function be(n){return new DataView(n.buffer)}function Ps(n){return be(n.buf).getUint8(n.offset||0)}function As(n,e){be(e.buf).setUint8(e.offset||0,n)}function Is(n){return be(n.buf).getInt8(n.offset||0)}function Es(n,e){be(e.buf).setInt8(e.offset||0,n)}function Fs(n){return be(n.buf).getUint16(n.offset||0,n.endian!==ke)}function Ds(n,e){be(e.buf).setUint16(e.offset||0,n,e.endian!==ke)}function Rs(n){return be(n.buf).getInt16(n.offset||0,n.endian!==ke)}function Ts(n,e){be(e.buf).setInt16(e.offset||0,n,e.endian!==ke)}function Ct(n){return be(n.buf).getUint32(n.offset||0,n.endian!==ke)}function Ls(n,e){be(e.buf).setUint32(e.offset||0,n,e.endian!==ke)}function pn(n){return be(n.buf).getInt32(n.offset||0,n.endian!==ke)}function Ms(n,e){be(e.buf).setInt32(e.offset||0,n,e.endian!==ke)}function Ns(n){return be(n.buf).getBigUint64(n.offset||0,n.endian!==ke)}function Os(n,e){be(e.buf).setBigUint64(e.offset||0,n,e.endian!==ke)}function Bs(n){return be(n.buf).getBigInt64(n.offset||0,n.endian!==ke)}function Us(n,e){be(e.buf).setBigInt64(e.offset||0,n,e.endian!==ke)}function js(n){return be(n.buf).getFloat32(n.offset||0,n.endian!==ke)}function Gs(n,e){be(e.buf).setFloat32(e.offset||0,n,e.endian!==ke)}function zs(n){return be(n.buf).getFloat64(n.offset||0,n.endian!==ke)}function Hs(n,e){be(e.buf).setFloat64(e.offset||0,n,e.endian!==ke)}function C(n,e){const t=(a,l,c=!0)=>new Proxy(Array.from({length:e}),{get(p,m){const P=Reflect.get(p,m);if(P!==void 0||typeof m=="symbol")return P;const A=Number(m);if(A<0||e<=A)return;const{offset:k=0}=a;return c&&typeof n.proxy=="function"?n.proxy({...a,offset:k+A*n.size},{}):n.read({...a,offset:k+A*n.size},{})},set(p,m,P){var F;if(typeof m=="symbol")return!1;const A=Number(m);if(!Number.isFinite(A))return!1;const{offset:k=0}=a;return typeof n.write!="function"?!1:((F=n.write)==null||F.call(n,P,{...a,offset:k+A*n.size},{}),!0)}});return{size:e*n.size,proxy:t,read(a,l){return t(a,l,!1).slice()},write(a,l,c){if(typeof n.write!="function")return;const{offset:p=0}=l;for(let m=0;m<e;m++)n.write(a[m],{...l,offset:p+m*n.size},c)}}}function Vs(n,e){return{size:4,read(t,a){const l=Ct(t),c=a[e];return Array.from({length:c},(p,m)=>n.read({...t,offset:l+m*n.size},{}))}}}const j={size:1,read:Ps,write:As},bt={size:1,read:Is,write:Es},gn={size:2,read:Fs,write:Ds},Y={size:2,read:Rs,write:Ts},B={size:4,read:Ct,write:Ls},ee={size:4,read:pn,write:Ms},Ut={size:8,read:Ns,write:Os},Ws={size:8,read:Bs,write:Us},O={size:4,read:js,write:Gs},Me={size:8,read:zs,write:Hs};function ti(n,e){return{size:n.size,read(t,a){var p;const l=n.read(t,a),c=(p=Object.entries(e).find(([m,P])=>P===l))==null?void 0:p[0];if(c===void 0)throw new Error(`Unknown enum value: ${l}`);return c},write(t,a,l){var p;const c=e[t];if(c===void 0)throw new Error(`Unknown enum variant: ${String(t)}`);return(p=n.write)==null?void 0:p.call(n,c,a,l)}}}const Hr=n=>new TextDecoder().decode(n),Mi=n=>new TextEncoder().encode(n);function Nr(n){return{size:4,read(e){const t=Ct(e),a=e.buf.indexOf(0,t);return(n??Hr)(e.buf.slice(t,a))}}}function me(n,e={}){const{nullTermination:t=!0,decode:a=Hr,encode:l=Mi}=e;return{size:n,read(c){const{buf:p,offset:m=0}=c,P=t?p.indexOf(0,m):m+n;return(a??Hr)(p.slice(m,P))},write(c,p){const{buf:m,offset:P=0}=p,A=(l??Mi)(c);for(let k=0;k<n;k++)m[P+k]=k<A.length?A[k]:0}}}function Cr(n){const e=l=>{const c=Ct(l);return c===0?null:n.read({...l,offset:c},{})},t=n.write?(l,c)=>{var m;if(l===null)throw new Error("Cannot write null pointer");const p=Ct(c);if(p===0)throw new Error("Cannot write to null pointer");(m=n.write)==null||m.call(n,l,{...c,offset:p},{})}:void 0,a=n.proxy?l=>{var p;const c=Ct(l);return c===0?null:((p=n.proxy)==null?void 0:p.call(n,{...l,offset:c},{}))??null}:void 0;return{size:4,read:e,write:t,proxy:a}}class ue extends ks{constructor(){super([])}}function Xs(){return ti(B,{LIBRAW_IMAGE_BITMAP:2,LIBRAW_IMAGE_H265:4,LIBRAW_IMAGE_JPEG:1,LIBRAW_IMAGE_JPEGXL:3})}function qs(){return ti(B,{LIBRAW_THUMBNAIL_BITMAP:2,LIBRAW_THUMBNAIL_BITMAP16:3,LIBRAW_THUMBNAIL_H265:6,LIBRAW_THUMBNAIL_JPEG:1,LIBRAW_THUMBNAIL_JPEGXL:7,LIBRAW_THUMBNAIL_LAYER:4,LIBRAW_THUMBNAIL_ROLLEI:5,LIBRAW_THUMBNAIL_UNKNOWN:0})}function Ks(){return Ws}function Ys(){return new ue().field("AFInfoData_tag",B).field("AFInfoData_order",Y).field("AFInfoData_version",B).field("AFInfoData_length",B).field("AFInfoData",Cr(J()))}function jt(){return new ue().field("t",Y).field("l",Y).field("b",Y).field("r",Y)}function $s(){return new ue().field("ColorDataVer",ee).field("ColorDataSubVer",ee).field("SpecularWhiteLevel",ee).field("NormalWhiteLevel",ee).field("ChannelBlackLevel",C(ee,4)).field("AverageBlackLevel",ee).field("multishot",C(B,4)).field("MeteringMode",Y).field("SpotMeteringMode",Y).field("FlashMeteringMode",J()).field("FlashExposureLock",Y).field("ExposureMode",Y).field("AESetting",Y).field("ImageStabilization",Y).field("FlashMode",Y).field("FlashActivity",Y).field("FlashBits",Y).field("ManualFlashOutput",Y).field("FlashOutput",Y).field("FlashGuideNumber",Y).field("ContinuousDrive",Y).field("SensorWidth",Y).field("SensorHeight",Y).field("AFMicroAdjMode",ee).field("AFMicroAdjValue",O).field("MakernotesFlip",Y).field("RecordMode",Y).field("SRAWQuality",Y).field("wbi",B).field("RF_lensID",Y).field("AutoLightingOptimizer",ee).field("HighlightTonePriority",ee).field("Quality",Y).field("CanonLog",ee).field("DefaultCropAbsolute",jt()).field("RecommendedImageArea",jt()).field("LeftOpticalBlack",jt()).field("UpperOpticalBlack",jt()).field("ActiveArea",jt()).field("ISOgain",C(Y,2))}function Js(){return new ue().field("MinFocal",O).field("MaxFocal",O).field("MaxAp4MinFocal",O).field("MaxAp4MaxFocal",O)}function Qs(){return new ue().field("ExpoMidPointShift",O).field("DynamicRange",_()).field("FilmMode",_()).field("DynamicRangeSetting",_()).field("DevelopmentDynamicRange",_()).field("AutoDynamicRange",_()).field("DRangePriority",_()).field("DRangePriorityAuto",_()).field("DRangePriorityFixed",_()).field("FujiModel",C(j,33)).field("FujiModel2",C(j,33)).field("BrightnessCompensation",O).field("FocusMode",_()).field("AFMode",_()).field("FocusPixel",C(_(),2)).field("PrioritySettings",_()).field("FocusSettings",B).field("AF_C_Settings",B).field("FocusWarning",_()).field("ImageStabilization",C(_(),3)).field("FlashMode",_()).field("WB_Preset",_()).field("ShutterType",_()).field("ExrMode",_()).field("Macro",_()).field("Rating",B).field("CropMode",_()).field("SerialSignature",C(j,13)).field("SensorID",C(j,5)).field("RAFVersion",C(j,5)).field("RAFDataGeneration",ee).field("RAFDataVersion",_()).field("isTSNERDTS",ee).field("DriveMode",Y).field("BlackLevel",C(_(),9)).field("RAFData_ImageSizeTable",C(B,32)).field("AutoBracketing",ee).field("SequenceNumber",ee).field("SeriesLength",ee).field("PixelShiftOffset",C(O,2)).field("ImageCount",ee)}function Zs(){return new ue().field("latitude",C(O,3)).field("longitude",C(O,3)).field("gpstimestamp",C(O,3)).field("altitude",O).field("altref",j).field("latref",j).field("longref",j).field("gpsstatus",j).field("gpsparsed",j)}function eo(){return new ue().field("BaseISO",ee).field("Gain",Me).field("Sensor",C(j,8)).field("SensorUnit",C(j,64)).field("HostBody",C(j,64)).field("SensorCode",ee).field("SensorSubCode",ee).field("CoatingCode",ee).field("uncropped",ee).field("CaptureSequenceInitiator",C(j,32)).field("SensorUnitConnector",C(j,64)).field("format",ee).field("nIFD_CM",C(ee,2)).field("RecommendedCrop",C(ee,2)).field("mnColorMatrix",C(C(Me,3),4))}function to(){return new ue().field("iso_speed",O).field("shutter",O).field("aperture",O).field("focal_len",O).field("timestamp",bo()).field("shot_order",B).field("gpsdata",C(B,32)).field("parsed_gps",Zs()).field("desc",C(j,512)).field("artist",C(j,64)).field("analogbalance",C(O,4))}function ro(){return new ue().field("guard",C(j,4)).field("make",C(j,64)).field("model",C(j,64)).field("software",C(j,64)).field("normalized_make",C(j,64)).field("normalized_model",C(j,64)).field("maker_index",B).field("raw_count",B).field("dng_version",B).field("is_foveon",B).field("colors",ee).field("filters",B).field("xtrans",C(C(j,6),6)).field("xtrans_abs",C(C(j,6),6)).field("cdesc",C(j,5)).field("xmplen",B).field("xmpdata",Cr(j))}function io(){return new ue().field("BlackLevelTop",_()).field("BlackLevelBottom",_()).field("offset_left",Y).field("offset_top",Y).field("clipBlack",_()).field("clipWhite",_()).field("romm_camDaylight",C(C(O,3),3)).field("romm_camTungsten",C(C(O,3),3)).field("romm_camFluorescent",C(C(O,3),3)).field("romm_camFlash",C(C(O,3),3)).field("romm_camCustom",C(C(O,3),3)).field("romm_camAuto",C(C(O,3),3)).field("val018percent",_()).field("val100percent",_()).field("val170percent",_()).field("MakerNoteKodak8a",Y).field("ISOCalibrationGain",O).field("AnalogISO",O)}function no(){return new ue().field("MinFocal",O).field("MaxFocal",O).field("MaxAp4MinFocal",O).field("MaxAp4MaxFocal",O).field("EXIF_MaxAp",O).field("LensMake",C(j,128)).field("Lens",C(j,128)).field("LensSerial",C(j,128)).field("InternalLensSerial",C(j,128)).field("FocalLengthIn35mmFormat",_()).field("nikon",lo()).field("dng",Js()).field("makernotes",yn())}function yn(){return new ue().field("LensID",Ut).field("Lens",C(j,128)).field("LensFormat",_()).field("LensMount",_()).field("CamID",Ut).field("CameraFormat",_()).field("CameraMount",_()).field("body",C(j,64)).field("FocalType",Y).field("LensFeatures_pre",C(j,16)).field("LensFeatures_suf",C(j,16)).field("MinFocal",O).field("MaxFocal",O).field("MaxAp4MinFocal",O).field("MaxAp4MaxFocal",O).field("MinAp4MinFocal",O).field("MinAp4MaxFocal",O).field("MaxAp",O).field("MinAp",O).field("CurFocal",O).field("CurAp",O).field("MaxAp4CurFocal",O).field("MinAp4CurFocal",O).field("MinFocusDistance",O).field("FocusRangeIndex",O).field("LensFStops",O).field("TeleconverterID",Ut).field("Teleconverter",C(j,128)).field("AdapterID",Ut).field("Adapter",C(j,128)).field("AttachmentID",Ut).field("Attachment",C(j,128)).field("FocalUnits",_()).field("FocalLengthIn35mmFormat",O)}function ao(){return new ue().field("canon",$s()).field("nikon",oo()).field("hasselblad",eo()).field("fuji",Qs()).field("olympus",fo()).field("sony",vo()).field("kodak",io()).field("panasonic",uo()).field("pentax",ho()).field("phaseone",co()).field("ricoh",po()).field("samsung",go()).field("common",so())}function so(){return new ue().field("FlashEC",O).field("FlashGN",O).field("CameraTemperature",O).field("SensorTemperature",O).field("SensorTemperature2",O).field("LensTemperature",O).field("AmbientTemperature",O).field("BatteryTemperature",O).field("exifAmbientTemperature",O).field("exifHumidity",O).field("exifPressure",O).field("exifWaterDepth",O).field("exifAcceleration",O).field("exifCameraElevationAngle",O).field("real_ISO",O).field("exifExposureIndex",O).field("ColorSpace",_()).field("firmware",C(j,128)).field("ExposureCalibrationShift",O).field("afdata",C(Ys(),4)).field("afcount",ee)}function oo(){return new ue().field("ExposureBracketValue",Me).field("ActiveDLighting",_()).field("ShootingMode",_()).field("ImageStabilization",C(J(),7)).field("VibrationReduction",J()).field("VRMode",J()).field("FlashSetting",C(j,13)).field("FlashType",C(j,20)).field("FlashExposureCompensation",C(J(),4)).field("ExternalFlashExposureComp",C(J(),4)).field("FlashExposureBracketValue",C(J(),4)).field("FlashMode",J()).field("FlashExposureCompensation2",bt).field("FlashExposureCompensation3",bt).field("FlashExposureCompensation4",bt).field("FlashSource",J()).field("FlashFirmware",C(J(),2)).field("ExternalFlashFlags",J()).field("FlashControlCommanderMode",J()).field("FlashOutputAndCompensation",J()).field("FlashFocalLength",J()).field("FlashGNDistance",J()).field("FlashGroupControlMode",C(J(),4)).field("FlashGroupOutputAndCompensation",C(J(),4)).field("FlashColorFilter",J()).field("NEFCompression",_()).field("ExposureMode",ee).field("ExposureProgram",ee).field("nMEshots",ee).field("MEgainOn",ee).field("ME_WB",C(Me,4)).field("AFFineTune",J()).field("AFFineTuneIndex",J()).field("AFFineTuneAdj",bt).field("LensDataVersion",B).field("FlashInfoVersion",B).field("ColorBalanceVersion",B).field("key",J()).field("NEFBitDepth",C(_(),4)).field("HighSpeedCropFormat",_()).field("SensorHighSpeedCrop",yo()).field("SensorWidth",_()).field("SensorHeight",_()).field("Active_D_Lighting",_()).field("PictureControlVersion",B).field("PictureControlName",C(j,20)).field("PictureControlBase",C(j,20)).field("ShotInfoVersion",B).field("ShotInfoFirmware",C(j,9)).field("BurstTable_0x0056_len",B).field("BurstTable_0x0056",Cr(J())).field("BurstTable_0x0056_ver",_()).field("BurstTable_0x0056_gid",_()).field("BurstTable_0x0056_fnum",J()).field("MakernotesFlip",Y).field("RollAngle",Me).field("PitchAngle",Me).field("YawAngle",Me)}function lo(){return new ue().field("EffectiveMaxAp",O).field("LensIDNumber",J()).field("LensFStops",J()).field("MCUVersion",J()).field("LensType",J())}function fo(){return new ue().field("CameraType2",C(j,6)).field("ValidBits",_()).field("tagX640",B).field("tagX641",B).field("tagX642",B).field("tagX643",B).field("tagX644",B).field("tagX645",B).field("tagX646",B).field("tagX647",B).field("tagX648",B).field("tagX649",B).field("tagX650",B).field("tagX651",B).field("tagX652",B).field("tagX653",B).field("SensorCalibration",C(ee,2)).field("DriveMode",C(_(),5)).field("ColorSpace",_()).field("FocusMode",C(_(),2)).field("AutoFocus",_()).field("AFPoint",_()).field("AFAreas",C(B,64)).field("AFPointSelected",C(Me,5)).field("AFResult",_()).field("AFFineTune",J()).field("AFFineTuneAdj",C(Y,3)).field("SpecialMode",C(B,3)).field("ZoomStepCount",_()).field("FocusStepCount",_()).field("FocusStepInfinity",_()).field("FocusStepNear",_()).field("FocusDistance",Me).field("AspectFrame",C(_(),4)).field("StackedImage",C(B,2)).field("isLiveND",J()).field("LiveNDfactor",B).field("Panorama_mode",_()).field("Panorama_frameNum",_())}function co(){return new ue().field("Software",C(j,64)).field("SystemType",C(j,64)).field("FirmwareString",C(j,256)).field("SystemModel",C(j,64))}function uo(){return new ue().field("Compression",_()).field("BlackLevelDim",_()).field("BlackLevel",C(O,8)).field("Multishot",B).field("gamma",O).field("HighISOMultiplier",C(ee,3)).field("FocusStepNear",Y).field("FocusStepCount",Y).field("ZoomPosition",B).field("LensManufacturer",B)}function ho(){return new ue().field("DriveMode",C(J(),4)).field("FocusMode",C(_(),2)).field("AFPointSelected",C(_(),2)).field("AFPointSelected_Area",_()).field("AFPointsInFocus_version",ee).field("AFPointsInFocus",B).field("FocusPosition",_()).field("DynamicRangeExpansion",C(J(),4)).field("AFAdjustment",Y).field("AFPointMode",J()).field("MultiExposure",J()).field("Quality",_())}function mo(){return new ue().field("type_",Xs()).field("height",_()).field("width",_()).field("colors",_()).field("bits",_()).field("data_size",B).field("data",C(j,1))}function po(){return new ue().field("AFStatus",_()).field("AFAreaXPosition",C(B,2)).field("AFAreaYPosition",C(B,2)).field("AFAreaMode",_()).field("SensorWidth",B).field("SensorHeight",B).field("CroppedImageWidth",B).field("CroppedImageHeight",B).field("WideAdapter",_()).field("CropMode",_()).field("NDFilter",_()).field("AutoBracketing",_()).field("MacroMode",_()).field("FlashMode",_()).field("FlashExposureComp",Me).field("ManualFlashOutput",Me)}function go(){return new ue().field("ImageSizeFull",C(B,4)).field("ImageSizeCrop",C(B,4)).field("ColorSpace",C(ee,2)).field("key",C(B,11)).field("DigitalGain",Me).field("DeviceType",ee).field("LensFirmware",C(j,32))}function yo(){return new ue().field("cleft",_()).field("ctop",_()).field("cwidth",_()).field("cheight",_())}function wo(){return new ue().field("DriveMode",Y).field("FocusMode",Y).field("MeteringMode",Y).field("AFPoint",Y).field("ExposureMode",Y).field("ExposureProgram",Y).field("ImageStabilization",Y).field("BodySerial",C(j,64)).field("InternalBodySerial",C(j,64))}function vo(){return new ue().field("CameraType",_()).field("Sony0x9400_version",J()).field("Sony0x9400_ReleaseMode2",J()).field("Sony0x9400_SequenceImageNumber",B).field("Sony0x9400_SequenceLength1",J()).field("Sony0x9400_SequenceFileNumber",B).field("Sony0x9400_SequenceLength2",J()).field("AFAreaModeSetting",j).field("AFAreaMode",gn).field("FlexibleSpotPosition",C(_(),2)).field("AFPointSelected",j).field("AFPointSelected_0x201e",j).field("nAFPointsUsed",Y).field("AFPointsUsed",C(j,10)).field("AFTracking",j).field("AFType",j).field("FocusLocation",C(_(),4)).field("FocusPosition",_()).field("AFMicroAdjValue",bt).field("AFMicroAdjOn",bt).field("AFMicroAdjRegisteredLenses",J()).field("VariableLowPassFilter",_()).field("LongExposureNoiseReduction",B).field("HighISONoiseReduction",_()).field("HDR",C(_(),2)).field("group2010",_()).field("group9050",_()).field("len_group9050",_()).field("real_iso_offset",_()).field("MeteringMode_offset",_()).field("ExposureProgram_offset",_()).field("ReleaseMode2_offset",_()).field("MinoltaCamID",B).field("firmware",O).field("ImageCount3_offset",_()).field("ImageCount3",B).field("ElectronicFrontCurtainShutter",B).field("MeteringMode2",_()).field("SonyDateTime",C(j,20)).field("ShotNumberSincePowerUp",B).field("PixelShiftGroupPrefix",_()).field("PixelShiftGroupID",B).field("nShotsInPixelShiftGroup",j).field("numInPixelShiftGroup",j).field("prd_ImageHeight",_()).field("prd_ImageWidth",_()).field("prd_Total_bps",_()).field("prd_Active_bps",_()).field("prd_StorageMethod",_()).field("prd_BayerPattern",_()).field("SonyRawFileType",_()).field("RAWFileType",_()).field("RawSizeType",_()).field("Quality",B).field("FileFormat",_()).field("MetaVersion",C(j,16)).field("AspectRatio",O)}function So(){return new ue().field("tformat",qs()).field("twidth",_()).field("theight",_()).field("tlength",B).field("tcolors",ee).field("thumb",Cr(j))}function bo(){return Ks()}function J(){return j}function _(){return gn}var xo=async function(n={}){var li;var e,t=n,a,l,c=new Promise((r,i)=>{a=r,l=i}),p=typeof window=="object",m=typeof WorkerGlobalScope<"u",P=typeof process=="object"&&((li=process.versions)==null?void 0:li.node)&&process.type!="renderer";if(P){const{createRequire:r}=await ia(()=>import("./__vite-browser-external-BIHI7g3E.js"),[]);var A=r(import.meta.url)}var k=import.meta.url,F="";function L(r){return t.locateFile?t.locateFile(r,F):F+r}var D,U;if(P){var $=A("fs"),de=A("path");k.startsWith("file:")&&(F=de.dirname(A("url").fileURLToPath(k))+"/"),U=r=>{r=q(r)?new URL(r):r;var i=$.readFileSync(r);return i},D=async(r,i=!0)=>{r=q(r)?new URL(r):r;var s=$.readFileSync(r,i?void 0:"utf8");return s},process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2)}else if(p||m){try{F=new URL(".",k).href}catch{}m&&(U=r=>{var i=new XMLHttpRequest;return i.open("GET",r,!1),i.responseType="arraybuffer",i.send(null),new Uint8Array(i.response)}),D=async r=>{if(q(r))return new Promise((s,d)=>{var f=new XMLHttpRequest;f.open("GET",r,!0),f.responseType="arraybuffer",f.onload=()=>{if(f.status==200||f.status==0&&f.response){s(f.response);return}d(f.status)},f.onerror=d,f.send(null)});var i=await fetch(r,{credentials:"same-origin"});if(i.ok)return i.arrayBuffer();throw new Error(i.status+" : "+i.url)}}var fe=console.log.bind(console),ce=console.error.bind(console),xe,ge,v=!1,S,x,I,g,w,T,q=r=>r.startsWith("file://");function X(){var r=ge.buffer;S=new Int8Array(r),I=new Int16Array(r),t.HEAPU8=x=new Uint8Array(r),g=new Int32Array(r),w=new Uint32Array(r),T=new BigInt64Array(r),new BigUint64Array(r)}function H(){if(t.preRun)for(typeof t.preRun=="function"&&(t.preRun=[t.preRun]);t.preRun.length;)Xt(t.preRun.shift());Dt(Tt)}function te(){!t.noFSInit&&!o.initialized&&o.init(),N.o(),o.ignorePermissions=!1}function Q(){if(t.postRun)for(typeof t.postRun=="function"&&(t.postRun=[t.postRun]);t.postRun.length;)Rt(t.postRun.shift());Dt(ot)}var M=0,z=null;function Z(r){var i;M++,(i=t.monitorRunDependencies)==null||i.call(t,M)}function re(r){var s;if(M--,(s=t.monitorRunDependencies)==null||s.call(t,M),M==0&&z){var i=z;z=null,i()}}function Ie(r){var s;(s=t.onAbort)==null||s.call(t,r),r="Aborted("+r+")",ce(r),v=!0,r+=". Build with -sASSERTIONS for more info.";var i=new WebAssembly.RuntimeError(r);throw l(i),i}var he;function Ne(){return t.locateFile?L("libraw.wasm"):new URL("/assets/libraw-5OaPHZTA.wasm",import.meta.url).href}function Ye(r){if(r==he&&xe)return new Uint8Array(xe);if(U)return U(r);throw"both async and sync fetching of the wasm failed"}async function Xe(r){if(!xe)try{var i=await D(r);return new Uint8Array(i)}catch{}return Ye(r)}async function Wt(r,i){try{var s=await Xe(r),d=await WebAssembly.instantiate(s,i);return d}catch(f){ce(`failed to asynchronously prepare wasm: ${f}`),Ie(f)}}async function Et(r,i,s){if(!r&&typeof WebAssembly.instantiateStreaming=="function"&&!q(i)&&!P)try{var d=fetch(i,{credentials:"same-origin"}),f=await WebAssembly.instantiateStreaming(d,s);return f}catch(h){ce(`wasm streaming compile failed: ${h}`),ce("falling back to ArrayBuffer instantiation")}return Wt(i,s)}function Ft(){return{a:Kn}}async function st(){function r(h,y){return N=h.exports,ge=N.n,X(),re(),N}Z();function i(h){return r(h.instance)}var s=Ft();if(t.instantiateWasm)return new Promise((h,y)=>{t.instantiateWasm(s,(b,E)=>{h(r(b))})});he??(he=Ne());try{var d=await Et(xe,he,s),f=i(d);return f}catch(h){return l(h),Promise.reject(h)}}var Dt=r=>{for(;r.length>0;)r.shift()(t)},ot=[],Rt=r=>ot.push(r),Tt=[],Xt=r=>Tt.push(r);class qt{constructor(i){this.excPtr=i,this.ptr=i-24}set_type(i){w[this.ptr+4>>2]=i}get_type(){return w[this.ptr+4>>2]}set_destructor(i){w[this.ptr+8>>2]=i}get_destructor(){return w[this.ptr+8>>2]}set_caught(i){i=i?1:0,S[this.ptr+12]=i}get_caught(){return S[this.ptr+12]!=0}set_rethrown(i){i=i?1:0,S[this.ptr+13]=i}get_rethrown(){return S[this.ptr+13]!=0}init(i,s){this.set_adjusted_ptr(0),this.set_type(i),this.set_destructor(s)}set_adjusted_ptr(i){w[this.ptr+16>>2]=i}get_adjusted_ptr(){return w[this.ptr+16>>2]}}var Lt=0,Ge=(r,i,s)=>{var d=new qt(r);throw d.init(i,s),Lt=r,Lt},ze=()=>{var r=g[+Ee.varargs>>2];return Ee.varargs+=4,r},Te=ze,ie={isAbs:r=>r.charAt(0)==="/",splitPath:r=>{var i=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;return i.exec(r).slice(1)},normalizeArray:(r,i)=>{for(var s=0,d=r.length-1;d>=0;d--){var f=r[d];f==="."?r.splice(d,1):f===".."?(r.splice(d,1),s++):s&&(r.splice(d,1),s--)}if(i)for(;s;s--)r.unshift("..");return r},normalize:r=>{var i=ie.isAbs(r),s=r.slice(-1)==="/";return r=ie.normalizeArray(r.split("/").filter(d=>!!d),!i).join("/"),!r&&!i&&(r="."),r&&s&&(r+="/"),(i?"/":"")+r},dirname:r=>{var i=ie.splitPath(r),s=i[0],d=i[1];return!s&&!d?".":(d&&(d=d.slice(0,-1)),s+d)},basename:r=>r&&r.match(/([^\/]+|\/)\/*$/)[1],join:(...r)=>ie.normalize(r.join("/")),join2:(r,i)=>ie.normalize(r+"/"+i)},lt=()=>{if(P){var r=A("crypto");return i=>r.randomFillSync(i)}return i=>crypto.getRandomValues(i)},$e=r=>{($e=lt())(r)},Je={resolve:(...r)=>{for(var i="",s=!1,d=r.length-1;d>=-1&&!s;d--){var f=d>=0?r[d]:o.cwd();if(typeof f!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!f)return"";i=f+"/"+i,s=ie.isAbs(f)}return i=ie.normalizeArray(i.split("/").filter(h=>!!h),!s).join("/"),(s?"/":"")+i||"."},relative:(r,i)=>{r=Je.resolve(r).slice(1),i=Je.resolve(i).slice(1);function s(V){for(var se=0;se<V.length&&V[se]==="";se++);for(var ae=V.length-1;ae>=0&&V[ae]==="";ae--);return se>ae?[]:V.slice(se,ae-se+1)}for(var d=s(r.split("/")),f=s(i.split("/")),h=Math.min(d.length,f.length),y=h,b=0;b<h;b++)if(d[b]!==f[b]){y=b;break}for(var E=[],b=y;b<d.length;b++)E.push("..");return E=E.concat(f.slice(y)),E.join("/")}},Kt=typeof TextDecoder<"u"?new TextDecoder:void 0,Qe=(r,i=0,s=NaN)=>{for(var d=i+s,f=i;r[f]&&!(f>=d);)++f;if(f-i>16&&r.buffer&&Kt)return Kt.decode(r.subarray(i,f));for(var h="";i<f;){var y=r[i++];if(!(y&128)){h+=String.fromCharCode(y);continue}var b=r[i++]&63;if((y&224)==192){h+=String.fromCharCode((y&31)<<6|b);continue}var E=r[i++]&63;if((y&240)==224?y=(y&15)<<12|b<<6|E:y=(y&7)<<18|b<<12|E<<6|r[i++]&63,y<65536)h+=String.fromCharCode(y);else{var V=y-65536;h+=String.fromCharCode(55296|V>>10,56320|V&1023)}}return h},Mt=[],ri=r=>{for(var i=0,s=0;s<r.length;++s){var d=r.charCodeAt(s);d<=127?i++:d<=2047?i+=2:d>=55296&&d<=57343?(i+=4,++s):i+=3}return i},_r=(r,i,s,d)=>{if(!(d>0))return 0;for(var f=s,h=s+d-1,y=0;y<r.length;++y){var b=r.charCodeAt(y);if(b>=55296&&b<=57343){var E=r.charCodeAt(++y);b=65536+((b&1023)<<10)|E&1023}if(b<=127){if(s>=h)break;i[s++]=b}else if(b<=2047){if(s+1>=h)break;i[s++]=192|b>>6,i[s++]=128|b&63}else if(b<=65535){if(s+2>=h)break;i[s++]=224|b>>12,i[s++]=128|b>>6&63,i[s++]=128|b&63}else{if(s+3>=h)break;i[s++]=240|b>>18,i[s++]=128|b>>12&63,i[s++]=128|b>>6&63,i[s++]=128|b&63}}return i[s]=0,s-f},ii=(r,i,s)=>{var d=ri(r)+1,f=new Array(d),h=_r(r,f,0,f.length);return f.length=h,f},vn=()=>{if(!Mt.length){var r=null;if(P){var i=256,s=Buffer.alloc(i),d=0,f=process.stdin.fd;try{d=$.readSync(f,s,0,i)}catch(h){if(h.toString().includes("EOF"))d=0;else throw h}d>0&&(r=s.slice(0,d).toString("utf-8"))}else typeof window<"u"&&typeof window.prompt=="function"&&(r=window.prompt("Input: "),r!==null&&(r+=`
`));if(!r)return null;Mt=ii(r)}return Mt.shift()},dt={ttys:[],init(){},shutdown(){},register(r,i){dt.ttys[r]={input:[],output:[],ops:i},o.registerDevice(r,dt.stream_ops)},stream_ops:{open(r){var i=dt.ttys[r.node.rdev];if(!i)throw new o.ErrnoError(43);r.tty=i,r.seekable=!1},close(r){r.tty.ops.fsync(r.tty)},fsync(r){r.tty.ops.fsync(r.tty)},read(r,i,s,d,f){if(!r.tty||!r.tty.ops.get_char)throw new o.ErrnoError(60);for(var h=0,y=0;y<d;y++){var b;try{b=r.tty.ops.get_char(r.tty)}catch{throw new o.ErrnoError(29)}if(b===void 0&&h===0)throw new o.ErrnoError(6);if(b==null)break;h++,i[s+y]=b}return h&&(r.node.atime=Date.now()),h},write(r,i,s,d,f){if(!r.tty||!r.tty.ops.put_char)throw new o.ErrnoError(60);try{for(var h=0;h<d;h++)r.tty.ops.put_char(r.tty,i[s+h])}catch{throw new o.ErrnoError(29)}return d&&(r.node.mtime=r.node.ctime=Date.now()),h}},default_tty_ops:{get_char(r){return vn()},put_char(r,i){i===null||i===10?(fe(Qe(r.output)),r.output=[]):i!=0&&r.output.push(i)},fsync(r){var i;((i=r.output)==null?void 0:i.length)>0&&(fe(Qe(r.output)),r.output=[])},ioctl_tcgets(r){return{c_iflag:25856,c_oflag:5,c_cflag:191,c_lflag:35387,c_cc:[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},ioctl_tcsets(r,i,s){return 0},ioctl_tiocgwinsz(r){return[24,80]}},default_tty1_ops:{put_char(r,i){i===null||i===10?(ce(Qe(r.output)),r.output=[]):i!=0&&r.output.push(i)},fsync(r){var i;((i=r.output)==null?void 0:i.length)>0&&(ce(Qe(r.output)),r.output=[])}}},ni=r=>{Ie()},K={ops_table:null,mount(r){return K.createNode(null,"/",16895,0)},createNode(r,i,s,d){if(o.isBlkdev(s)||o.isFIFO(s))throw new o.ErrnoError(63);K.ops_table||(K.ops_table={dir:{node:{getattr:K.node_ops.getattr,setattr:K.node_ops.setattr,lookup:K.node_ops.lookup,mknod:K.node_ops.mknod,rename:K.node_ops.rename,unlink:K.node_ops.unlink,rmdir:K.node_ops.rmdir,readdir:K.node_ops.readdir,symlink:K.node_ops.symlink},stream:{llseek:K.stream_ops.llseek}},file:{node:{getattr:K.node_ops.getattr,setattr:K.node_ops.setattr},stream:{llseek:K.stream_ops.llseek,read:K.stream_ops.read,write:K.stream_ops.write,mmap:K.stream_ops.mmap,msync:K.stream_ops.msync}},link:{node:{getattr:K.node_ops.getattr,setattr:K.node_ops.setattr,readlink:K.node_ops.readlink},stream:{}},chrdev:{node:{getattr:K.node_ops.getattr,setattr:K.node_ops.setattr},stream:o.chrdev_stream_ops}});var f=o.createNode(r,i,s,d);return o.isDir(f.mode)?(f.node_ops=K.ops_table.dir.node,f.stream_ops=K.ops_table.dir.stream,f.contents={}):o.isFile(f.mode)?(f.node_ops=K.ops_table.file.node,f.stream_ops=K.ops_table.file.stream,f.usedBytes=0,f.contents=null):o.isLink(f.mode)?(f.node_ops=K.ops_table.link.node,f.stream_ops=K.ops_table.link.stream):o.isChrdev(f.mode)&&(f.node_ops=K.ops_table.chrdev.node,f.stream_ops=K.ops_table.chrdev.stream),f.atime=f.mtime=f.ctime=Date.now(),r&&(r.contents[i]=f,r.atime=r.mtime=r.ctime=f.atime),f},getFileDataAsTypedArray(r){return r.contents?r.contents.subarray?r.contents.subarray(0,r.usedBytes):new Uint8Array(r.contents):new Uint8Array(0)},expandFileStorage(r,i){var s=r.contents?r.contents.length:0;if(!(s>=i)){var d=1024*1024;i=Math.max(i,s*(s<d?2:1.125)>>>0),s!=0&&(i=Math.max(i,256));var f=r.contents;r.contents=new Uint8Array(i),r.usedBytes>0&&r.contents.set(f.subarray(0,r.usedBytes),0)}},resizeFileStorage(r,i){if(r.usedBytes!=i)if(i==0)r.contents=null,r.usedBytes=0;else{var s=r.contents;r.contents=new Uint8Array(i),s&&r.contents.set(s.subarray(0,Math.min(i,r.usedBytes))),r.usedBytes=i}},node_ops:{getattr(r){var i={};return i.dev=o.isChrdev(r.mode)?r.id:1,i.ino=r.id,i.mode=r.mode,i.nlink=1,i.uid=0,i.gid=0,i.rdev=r.rdev,o.isDir(r.mode)?i.size=4096:o.isFile(r.mode)?i.size=r.usedBytes:o.isLink(r.mode)?i.size=r.link.length:i.size=0,i.atime=new Date(r.atime),i.mtime=new Date(r.mtime),i.ctime=new Date(r.ctime),i.blksize=4096,i.blocks=Math.ceil(i.size/i.blksize),i},setattr(r,i){for(const s of["mode","atime","mtime","ctime"])i[s]!=null&&(r[s]=i[s]);i.size!==void 0&&K.resizeFileStorage(r,i.size)},lookup(r,i){throw K.doesNotExistError},mknod(r,i,s,d){return K.createNode(r,i,s,d)},rename(r,i,s){var d;try{d=o.lookupNode(i,s)}catch{}if(d){if(o.isDir(r.mode))for(var f in d.contents)throw new o.ErrnoError(55);o.hashRemoveNode(d)}delete r.parent.contents[r.name],i.contents[s]=r,r.name=s,i.ctime=i.mtime=r.parent.ctime=r.parent.mtime=Date.now()},unlink(r,i){delete r.contents[i],r.ctime=r.mtime=Date.now()},rmdir(r,i){var s=o.lookupNode(r,i);for(var d in s.contents)throw new o.ErrnoError(55);delete r.contents[i],r.ctime=r.mtime=Date.now()},readdir(r){return[".","..",...Object.keys(r.contents)]},symlink(r,i,s){var d=K.createNode(r,i,41471,0);return d.link=s,d},readlink(r){if(!o.isLink(r.mode))throw new o.ErrnoError(28);return r.link}},stream_ops:{read(r,i,s,d,f){var h=r.node.contents;if(f>=r.node.usedBytes)return 0;var y=Math.min(r.node.usedBytes-f,d);if(y>8&&h.subarray)i.set(h.subarray(f,f+y),s);else for(var b=0;b<y;b++)i[s+b]=h[f+b];return y},write(r,i,s,d,f,h){if(i.buffer===S.buffer&&(h=!1),!d)return 0;var y=r.node;if(y.mtime=y.ctime=Date.now(),i.subarray&&(!y.contents||y.contents.subarray)){if(h)return y.contents=i.subarray(s,s+d),y.usedBytes=d,d;if(y.usedBytes===0&&f===0)return y.contents=i.slice(s,s+d),y.usedBytes=d,d;if(f+d<=y.usedBytes)return y.contents.set(i.subarray(s,s+d),f),d}if(K.expandFileStorage(y,f+d),y.contents.subarray&&i.subarray)y.contents.set(i.subarray(s,s+d),f);else for(var b=0;b<d;b++)y.contents[f+b]=i[s+b];return y.usedBytes=Math.max(y.usedBytes,f+d),d},llseek(r,i,s){var d=i;if(s===1?d+=r.position:s===2&&o.isFile(r.node.mode)&&(d+=r.node.usedBytes),d<0)throw new o.ErrnoError(28);return d},mmap(r,i,s,d,f){if(!o.isFile(r.node.mode))throw new o.ErrnoError(43);var h,y,b=r.node.contents;if(!(f&2)&&b&&b.buffer===S.buffer)y=!1,h=b.byteOffset;else{if(y=!0,h=ni(),!h)throw new o.ErrnoError(48);b&&((s>0||s+i<b.length)&&(b.subarray?b=b.subarray(s,s+i):b=Array.prototype.slice.call(b,s,s+i)),S.set(b,h))}return{ptr:h,allocated:y}},msync(r,i,s,d,f){return K.stream_ops.write(r,i,0,d,s,!1),0}}},Sn=async r=>{var i=await D(r);return new Uint8Array(i)},bn=(...r)=>o.createDataFile(...r),ai=[],xn=(r,i,s,d)=>{typeof Browser<"u"&&Browser.init();var f=!1;return ai.forEach(h=>{f||h.canHandle(i)&&(h.handle(r,i,s,d),f=!0)}),f},Cn=(r,i,s,d,f,h,y,b,E,V)=>{var se=i?Je.resolve(ie.join2(r,i)):r;function ae(oe){function G(ne){V==null||V(),b||bn(r,i,ne,d,f,E),h==null||h(),re()}xn(oe,se,G,()=>{y==null||y(),re()})||G(oe)}Z(),typeof s=="string"?Sn(s).then(ae,y):ae(s)},_n=r=>{var i={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090},s=i[r];if(typeof s>"u")throw new Error(`Unknown file open mode: ${r}`);return s},kr=(r,i)=>{var s=0;return r&&(s|=365),i&&(s|=146),s},o={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,filesystems:null,syncFSRequests:0,readFiles:{},ErrnoError:class{constructor(r){Pe(this,"name","ErrnoError");this.errno=r}},FSStream:class{constructor(){Pe(this,"shared",{})}get object(){return this.node}set object(r){this.node=r}get isRead(){return(this.flags&2097155)!==1}get isWrite(){return(this.flags&2097155)!==0}get isAppend(){return this.flags&1024}get flags(){return this.shared.flags}set flags(r){this.shared.flags=r}get position(){return this.shared.position}set position(r){this.shared.position=r}},FSNode:class{constructor(r,i,s,d){Pe(this,"node_ops",{});Pe(this,"stream_ops",{});Pe(this,"readMode",365);Pe(this,"writeMode",146);Pe(this,"mounted",null);r||(r=this),this.parent=r,this.mount=r.mount,this.id=o.nextInode++,this.name=i,this.mode=s,this.rdev=d,this.atime=this.mtime=this.ctime=Date.now()}get read(){return(this.mode&this.readMode)===this.readMode}set read(r){r?this.mode|=this.readMode:this.mode&=~this.readMode}get write(){return(this.mode&this.writeMode)===this.writeMode}set write(r){r?this.mode|=this.writeMode:this.mode&=~this.writeMode}get isFolder(){return o.isDir(this.mode)}get isDevice(){return o.isChrdev(this.mode)}},lookupPath(r,i={}){if(!r)throw new o.ErrnoError(44);i.follow_mount??(i.follow_mount=!0),ie.isAbs(r)||(r=o.cwd()+"/"+r);e:for(var s=0;s<40;s++){for(var d=r.split("/").filter(V=>!!V),f=o.root,h="/",y=0;y<d.length;y++){var b=y===d.length-1;if(b&&i.parent)break;if(d[y]!=="."){if(d[y]===".."){if(h=ie.dirname(h),o.isRoot(f)){r=h+"/"+d.slice(y+1).join("/");continue e}else f=f.parent;continue}h=ie.join2(h,d[y]);try{f=o.lookupNode(f,d[y])}catch(V){if((V==null?void 0:V.errno)===44&&b&&i.noent_okay)return{path:h};throw V}if(o.isMountpoint(f)&&(!b||i.follow_mount)&&(f=f.mounted.root),o.isLink(f.mode)&&(!b||i.follow)){if(!f.node_ops.readlink)throw new o.ErrnoError(52);var E=f.node_ops.readlink(f);ie.isAbs(E)||(E=ie.dirname(h)+"/"+E),r=E+"/"+d.slice(y+1).join("/");continue e}}}return{path:h,node:f}}throw new o.ErrnoError(32)},getPath(r){for(var i;;){if(o.isRoot(r)){var s=r.mount.mountpoint;return i?s[s.length-1]!=="/"?`${s}/${i}`:s+i:s}i=i?`${r.name}/${i}`:r.name,r=r.parent}},hashName(r,i){for(var s=0,d=0;d<i.length;d++)s=(s<<5)-s+i.charCodeAt(d)|0;return(r+s>>>0)%o.nameTable.length},hashAddNode(r){var i=o.hashName(r.parent.id,r.name);r.name_next=o.nameTable[i],o.nameTable[i]=r},hashRemoveNode(r){var i=o.hashName(r.parent.id,r.name);if(o.nameTable[i]===r)o.nameTable[i]=r.name_next;else for(var s=o.nameTable[i];s;){if(s.name_next===r){s.name_next=r.name_next;break}s=s.name_next}},lookupNode(r,i){var s=o.mayLookup(r);if(s)throw new o.ErrnoError(s);for(var d=o.hashName(r.id,i),f=o.nameTable[d];f;f=f.name_next){var h=f.name;if(f.parent.id===r.id&&h===i)return f}return o.lookup(r,i)},createNode(r,i,s,d){var f=new o.FSNode(r,i,s,d);return o.hashAddNode(f),f},destroyNode(r){o.hashRemoveNode(r)},isRoot(r){return r===r.parent},isMountpoint(r){return!!r.mounted},isFile(r){return(r&61440)===32768},isDir(r){return(r&61440)===16384},isLink(r){return(r&61440)===40960},isChrdev(r){return(r&61440)===8192},isBlkdev(r){return(r&61440)===24576},isFIFO(r){return(r&61440)===4096},isSocket(r){return(r&49152)===49152},flagsToPermissionString(r){var i=["r","w","rw"][r&3];return r&512&&(i+="w"),i},nodePermissions(r,i){return o.ignorePermissions?0:i.includes("r")&&!(r.mode&292)||i.includes("w")&&!(r.mode&146)||i.includes("x")&&!(r.mode&73)?2:0},mayLookup(r){if(!o.isDir(r.mode))return 54;var i=o.nodePermissions(r,"x");return i||(r.node_ops.lookup?0:2)},mayCreate(r,i){if(!o.isDir(r.mode))return 54;try{var s=o.lookupNode(r,i);return 20}catch{}return o.nodePermissions(r,"wx")},mayDelete(r,i,s){var d;try{d=o.lookupNode(r,i)}catch(h){return h.errno}var f=o.nodePermissions(r,"wx");if(f)return f;if(s){if(!o.isDir(d.mode))return 54;if(o.isRoot(d)||o.getPath(d)===o.cwd())return 10}else if(o.isDir(d.mode))return 31;return 0},mayOpen(r,i){return r?o.isLink(r.mode)?32:o.isDir(r.mode)&&(o.flagsToPermissionString(i)!=="r"||i&576)?31:o.nodePermissions(r,o.flagsToPermissionString(i)):44},checkOpExists(r,i){if(!r)throw new o.ErrnoError(i);return r},MAX_OPEN_FDS:4096,nextfd(){for(var r=0;r<=o.MAX_OPEN_FDS;r++)if(!o.streams[r])return r;throw new o.ErrnoError(33)},getStreamChecked(r){var i=o.getStream(r);if(!i)throw new o.ErrnoError(8);return i},getStream:r=>o.streams[r],createStream(r,i=-1){return r=Object.assign(new o.FSStream,r),i==-1&&(i=o.nextfd()),r.fd=i,o.streams[i]=r,r},closeStream(r){o.streams[r]=null},dupStream(r,i=-1){var d,f;var s=o.createStream(r,i);return(f=(d=s.stream_ops)==null?void 0:d.dup)==null||f.call(d,s),s},doSetAttr(r,i,s){var d=r==null?void 0:r.stream_ops.setattr,f=d?r:i;d??(d=i.node_ops.setattr),o.checkOpExists(d,63),d(f,s)},chrdev_stream_ops:{open(r){var s,d;var i=o.getDevice(r.node.rdev);r.stream_ops=i.stream_ops,(d=(s=r.stream_ops).open)==null||d.call(s,r)},llseek(){throw new o.ErrnoError(70)}},major:r=>r>>8,minor:r=>r&255,makedev:(r,i)=>r<<8|i,registerDevice(r,i){o.devices[r]={stream_ops:i}},getDevice:r=>o.devices[r],getMounts(r){for(var i=[],s=[r];s.length;){var d=s.pop();i.push(d),s.push(...d.mounts)}return i},syncfs(r,i){typeof r=="function"&&(i=r,r=!1),o.syncFSRequests++,o.syncFSRequests>1&&ce(`warning: ${o.syncFSRequests} FS.syncfs operations in flight at once, probably just doing extra work`);var s=o.getMounts(o.root.mount),d=0;function f(y){return o.syncFSRequests--,i(y)}function h(y){if(y)return h.errored?void 0:(h.errored=!0,f(y));++d>=s.length&&f(null)}s.forEach(y=>{if(!y.type.syncfs)return h(null);y.type.syncfs(y,r,h)})},mount(r,i,s){var d=s==="/",f=!s,h;if(d&&o.root)throw new o.ErrnoError(10);if(!d&&!f){var y=o.lookupPath(s,{follow_mount:!1});if(s=y.path,h=y.node,o.isMountpoint(h))throw new o.ErrnoError(10);if(!o.isDir(h.mode))throw new o.ErrnoError(54)}var b={type:r,opts:i,mountpoint:s,mounts:[]},E=r.mount(b);return E.mount=b,b.root=E,d?o.root=E:h&&(h.mounted=b,h.mount&&h.mount.mounts.push(b)),E},unmount(r){var i=o.lookupPath(r,{follow_mount:!1});if(!o.isMountpoint(i.node))throw new o.ErrnoError(28);var s=i.node,d=s.mounted,f=o.getMounts(d);Object.keys(o.nameTable).forEach(y=>{for(var b=o.nameTable[y];b;){var E=b.name_next;f.includes(b.mount)&&o.destroyNode(b),b=E}}),s.mounted=null;var h=s.mount.mounts.indexOf(d);s.mount.mounts.splice(h,1)},lookup(r,i){return r.node_ops.lookup(r,i)},mknod(r,i,s){var d=o.lookupPath(r,{parent:!0}),f=d.node,h=ie.basename(r);if(!h)throw new o.ErrnoError(28);if(h==="."||h==="..")throw new o.ErrnoError(20);var y=o.mayCreate(f,h);if(y)throw new o.ErrnoError(y);if(!f.node_ops.mknod)throw new o.ErrnoError(63);return f.node_ops.mknod(f,h,i,s)},statfs(r){return o.statfsNode(o.lookupPath(r,{follow:!0}).node)},statfsStream(r){return o.statfsNode(r.node)},statfsNode(r){var i={bsize:4096,frsize:4096,blocks:1e6,bfree:5e5,bavail:5e5,files:o.nextInode,ffree:o.nextInode-1,fsid:42,flags:2,namelen:255};return r.node_ops.statfs&&Object.assign(i,r.node_ops.statfs(r.mount.opts.root)),i},create(r,i=438){return i&=4095,i|=32768,o.mknod(r,i,0)},mkdir(r,i=511){return i&=1023,i|=16384,o.mknod(r,i,0)},mkdirTree(r,i){var s=r.split("/"),d="";for(var f of s)if(f){(d||ie.isAbs(r))&&(d+="/"),d+=f;try{o.mkdir(d,i)}catch(h){if(h.errno!=20)throw h}}},mkdev(r,i,s){return typeof s>"u"&&(s=i,i=438),i|=8192,o.mknod(r,i,s)},symlink(r,i){if(!Je.resolve(r))throw new o.ErrnoError(44);var s=o.lookupPath(i,{parent:!0}),d=s.node;if(!d)throw new o.ErrnoError(44);var f=ie.basename(i),h=o.mayCreate(d,f);if(h)throw new o.ErrnoError(h);if(!d.node_ops.symlink)throw new o.ErrnoError(63);return d.node_ops.symlink(d,f,r)},rename(r,i){var s=ie.dirname(r),d=ie.dirname(i),f=ie.basename(r),h=ie.basename(i),y,b,E;if(y=o.lookupPath(r,{parent:!0}),b=y.node,y=o.lookupPath(i,{parent:!0}),E=y.node,!b||!E)throw new o.ErrnoError(44);if(b.mount!==E.mount)throw new o.ErrnoError(75);var V=o.lookupNode(b,f),se=Je.relative(r,d);if(se.charAt(0)!==".")throw new o.ErrnoError(28);if(se=Je.relative(i,s),se.charAt(0)!==".")throw new o.ErrnoError(55);var ae;try{ae=o.lookupNode(E,h)}catch{}if(V!==ae){var oe=o.isDir(V.mode),G=o.mayDelete(b,f,oe);if(G)throw new o.ErrnoError(G);if(G=ae?o.mayDelete(E,h,oe):o.mayCreate(E,h),G)throw new o.ErrnoError(G);if(!b.node_ops.rename)throw new o.ErrnoError(63);if(o.isMountpoint(V)||ae&&o.isMountpoint(ae))throw new o.ErrnoError(10);if(E!==b&&(G=o.nodePermissions(b,"w"),G))throw new o.ErrnoError(G);o.hashRemoveNode(V);try{b.node_ops.rename(V,E,h),V.parent=E}catch(ne){throw ne}finally{o.hashAddNode(V)}}},rmdir(r){var i=o.lookupPath(r,{parent:!0}),s=i.node,d=ie.basename(r),f=o.lookupNode(s,d),h=o.mayDelete(s,d,!0);if(h)throw new o.ErrnoError(h);if(!s.node_ops.rmdir)throw new o.ErrnoError(63);if(o.isMountpoint(f))throw new o.ErrnoError(10);s.node_ops.rmdir(s,d),o.destroyNode(f)},readdir(r){var i=o.lookupPath(r,{follow:!0}),s=i.node,d=o.checkOpExists(s.node_ops.readdir,54);return d(s)},unlink(r){var i=o.lookupPath(r,{parent:!0}),s=i.node;if(!s)throw new o.ErrnoError(44);var d=ie.basename(r),f=o.lookupNode(s,d),h=o.mayDelete(s,d,!1);if(h)throw new o.ErrnoError(h);if(!s.node_ops.unlink)throw new o.ErrnoError(63);if(o.isMountpoint(f))throw new o.ErrnoError(10);s.node_ops.unlink(s,d),o.destroyNode(f)},readlink(r){var i=o.lookupPath(r),s=i.node;if(!s)throw new o.ErrnoError(44);if(!s.node_ops.readlink)throw new o.ErrnoError(28);return s.node_ops.readlink(s)},stat(r,i){var s=o.lookupPath(r,{follow:!i}),d=s.node,f=o.checkOpExists(d.node_ops.getattr,63);return f(d)},fstat(r){var i=o.getStreamChecked(r),s=i.node,d=i.stream_ops.getattr,f=d?i:s;return d??(d=s.node_ops.getattr),o.checkOpExists(d,63),d(f)},lstat(r){return o.stat(r,!0)},doChmod(r,i,s,d){o.doSetAttr(r,i,{mode:s&4095|i.mode&-4096,ctime:Date.now(),dontFollow:d})},chmod(r,i,s){var d;if(typeof r=="string"){var f=o.lookupPath(r,{follow:!s});d=f.node}else d=r;o.doChmod(null,d,i,s)},lchmod(r,i){o.chmod(r,i,!0)},fchmod(r,i){var s=o.getStreamChecked(r);o.doChmod(s,s.node,i,!1)},doChown(r,i,s){o.doSetAttr(r,i,{timestamp:Date.now(),dontFollow:s})},chown(r,i,s,d){var f;if(typeof r=="string"){var h=o.lookupPath(r,{follow:!d});f=h.node}else f=r;o.doChown(null,f,d)},lchown(r,i,s){o.chown(r,i,s,!0)},fchown(r,i,s){var d=o.getStreamChecked(r);o.doChown(d,d.node,!1)},doTruncate(r,i,s){if(o.isDir(i.mode))throw new o.ErrnoError(31);if(!o.isFile(i.mode))throw new o.ErrnoError(28);var d=o.nodePermissions(i,"w");if(d)throw new o.ErrnoError(d);o.doSetAttr(r,i,{size:s,timestamp:Date.now()})},truncate(r,i){if(i<0)throw new o.ErrnoError(28);var s;if(typeof r=="string"){var d=o.lookupPath(r,{follow:!0});s=d.node}else s=r;o.doTruncate(null,s,i)},ftruncate(r,i){var s=o.getStreamChecked(r);if(i<0||(s.flags&2097155)===0)throw new o.ErrnoError(28);o.doTruncate(s,s.node,i)},utime(r,i,s){var d=o.lookupPath(r,{follow:!0}),f=d.node,h=o.checkOpExists(f.node_ops.setattr,63);h(f,{atime:i,mtime:s})},open(r,i,s=438){if(r==="")throw new o.ErrnoError(44);i=typeof i=="string"?_n(i):i,i&64?s=s&4095|32768:s=0;var d,f;if(typeof r=="object")d=r;else{f=r.endsWith("/");var h=o.lookupPath(r,{follow:!(i&131072),noent_okay:!0});d=h.node,r=h.path}var y=!1;if(i&64)if(d){if(i&128)throw new o.ErrnoError(20)}else{if(f)throw new o.ErrnoError(31);d=o.mknod(r,s|511,0),y=!0}if(!d)throw new o.ErrnoError(44);if(o.isChrdev(d.mode)&&(i&=-513),i&65536&&!o.isDir(d.mode))throw new o.ErrnoError(54);if(!y){var b=o.mayOpen(d,i);if(b)throw new o.ErrnoError(b)}i&512&&!y&&o.truncate(d,0),i&=-131713;var E=o.createStream({node:d,path:o.getPath(d),flags:i,seekable:!0,position:0,stream_ops:d.stream_ops,ungotten:[],error:!1});return E.stream_ops.open&&E.stream_ops.open(E),y&&o.chmod(d,s&511),t.logReadFiles&&!(i&1)&&(r in o.readFiles||(o.readFiles[r]=1)),E},close(r){if(o.isClosed(r))throw new o.ErrnoError(8);r.getdents&&(r.getdents=null);try{r.stream_ops.close&&r.stream_ops.close(r)}catch(i){throw i}finally{o.closeStream(r.fd)}r.fd=null},isClosed(r){return r.fd===null},llseek(r,i,s){if(o.isClosed(r))throw new o.ErrnoError(8);if(!r.seekable||!r.stream_ops.llseek)throw new o.ErrnoError(70);if(s!=0&&s!=1&&s!=2)throw new o.ErrnoError(28);return r.position=r.stream_ops.llseek(r,i,s),r.ungotten=[],r.position},read(r,i,s,d,f){if(d<0||f<0)throw new o.ErrnoError(28);if(o.isClosed(r))throw new o.ErrnoError(8);if((r.flags&2097155)===1)throw new o.ErrnoError(8);if(o.isDir(r.node.mode))throw new o.ErrnoError(31);if(!r.stream_ops.read)throw new o.ErrnoError(28);var h=typeof f<"u";if(!h)f=r.position;else if(!r.seekable)throw new o.ErrnoError(70);var y=r.stream_ops.read(r,i,s,d,f);return h||(r.position+=y),y},write(r,i,s,d,f,h){if(d<0||f<0)throw new o.ErrnoError(28);if(o.isClosed(r))throw new o.ErrnoError(8);if((r.flags&2097155)===0)throw new o.ErrnoError(8);if(o.isDir(r.node.mode))throw new o.ErrnoError(31);if(!r.stream_ops.write)throw new o.ErrnoError(28);r.seekable&&r.flags&1024&&o.llseek(r,0,2);var y=typeof f<"u";if(!y)f=r.position;else if(!r.seekable)throw new o.ErrnoError(70);var b=r.stream_ops.write(r,i,s,d,f,h);return y||(r.position+=b),b},mmap(r,i,s,d,f){if((d&2)!==0&&(f&2)===0&&(r.flags&2097155)!==2)throw new o.ErrnoError(2);if((r.flags&2097155)===1)throw new o.ErrnoError(2);if(!r.stream_ops.mmap)throw new o.ErrnoError(43);if(!i)throw new o.ErrnoError(28);return r.stream_ops.mmap(r,i,s,d,f)},msync(r,i,s,d,f){return r.stream_ops.msync?r.stream_ops.msync(r,i,s,d,f):0},ioctl(r,i,s){if(!r.stream_ops.ioctl)throw new o.ErrnoError(59);return r.stream_ops.ioctl(r,i,s)},readFile(r,i={}){if(i.flags=i.flags||0,i.encoding=i.encoding||"binary",i.encoding!=="utf8"&&i.encoding!=="binary")throw new Error(`Invalid encoding type "${i.encoding}"`);var s,d=o.open(r,i.flags),f=o.stat(r),h=f.size,y=new Uint8Array(h);return o.read(d,y,0,h,0),i.encoding==="utf8"?s=Qe(y):i.encoding==="binary"&&(s=y),o.close(d),s},writeFile(r,i,s={}){s.flags=s.flags||577;var d=o.open(r,s.flags,s.mode);if(typeof i=="string"){var f=new Uint8Array(ri(i)+1),h=_r(i,f,0,f.length);o.write(d,f,0,h,void 0,s.canOwn)}else if(ArrayBuffer.isView(i))o.write(d,i,0,i.byteLength,void 0,s.canOwn);else throw new Error("Unsupported data type");o.close(d)},cwd:()=>o.currentPath,chdir(r){var i=o.lookupPath(r,{follow:!0});if(i.node===null)throw new o.ErrnoError(44);if(!o.isDir(i.node.mode))throw new o.ErrnoError(54);var s=o.nodePermissions(i.node,"x");if(s)throw new o.ErrnoError(s);o.currentPath=i.path},createDefaultDirectories(){o.mkdir("/tmp"),o.mkdir("/home"),o.mkdir("/home/web_user")},createDefaultDevices(){o.mkdir("/dev"),o.registerDevice(o.makedev(1,3),{read:()=>0,write:(d,f,h,y,b)=>y,llseek:()=>0}),o.mkdev("/dev/null",o.makedev(1,3)),dt.register(o.makedev(5,0),dt.default_tty_ops),dt.register(o.makedev(6,0),dt.default_tty1_ops),o.mkdev("/dev/tty",o.makedev(5,0)),o.mkdev("/dev/tty1",o.makedev(6,0));var r=new Uint8Array(1024),i=0,s=()=>(i===0&&($e(r),i=r.byteLength),r[--i]);o.createDevice("/dev","random",s),o.createDevice("/dev","urandom",s),o.mkdir("/dev/shm"),o.mkdir("/dev/shm/tmp")},createSpecialDirectories(){o.mkdir("/proc");var r=o.mkdir("/proc/self");o.mkdir("/proc/self/fd"),o.mount({mount(){var i=o.createNode(r,"fd",16895,73);return i.stream_ops={llseek:K.stream_ops.llseek},i.node_ops={lookup(s,d){var f=+d,h=o.getStreamChecked(f),y={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:()=>h.path},id:f+1};return y.parent=y,y},readdir(){return Array.from(o.streams.entries()).filter(([s,d])=>d).map(([s,d])=>s.toString())}},i}},{},"/proc/self/fd")},createStandardStreams(r,i,s){r?o.createDevice("/dev","stdin",r):o.symlink("/dev/tty","/dev/stdin"),i?o.createDevice("/dev","stdout",null,i):o.symlink("/dev/tty","/dev/stdout"),s?o.createDevice("/dev","stderr",null,s):o.symlink("/dev/tty1","/dev/stderr"),o.open("/dev/stdin",0),o.open("/dev/stdout",1),o.open("/dev/stderr",1)},staticInit(){o.nameTable=new Array(4096),o.mount(K,{},"/"),o.createDefaultDirectories(),o.createDefaultDevices(),o.createSpecialDirectories(),o.filesystems={MEMFS:K}},init(r,i,s){o.initialized=!0,r??(r=t.stdin),i??(i=t.stdout),s??(s=t.stderr),o.createStandardStreams(r,i,s)},quit(){o.initialized=!1;for(var r of o.streams)r&&o.close(r)},findObject(r,i){var s=o.analyzePath(r,i);return s.exists?s.object:null},analyzePath(r,i){try{var s=o.lookupPath(r,{follow:!i});r=s.path}catch{}var d={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var s=o.lookupPath(r,{parent:!0});d.parentExists=!0,d.parentPath=s.path,d.parentObject=s.node,d.name=ie.basename(r),s=o.lookupPath(r,{follow:!i}),d.exists=!0,d.path=s.path,d.object=s.node,d.name=s.node.name,d.isRoot=s.path==="/"}catch(f){d.error=f.errno}return d},createPath(r,i,s,d){r=typeof r=="string"?r:o.getPath(r);for(var f=i.split("/").reverse();f.length;){var h=f.pop();if(h){var y=ie.join2(r,h);try{o.mkdir(y)}catch(b){if(b.errno!=20)throw b}r=y}}return y},createFile(r,i,s,d,f){var h=ie.join2(typeof r=="string"?r:o.getPath(r),i),y=kr(d,f);return o.create(h,y)},createDataFile(r,i,s,d,f,h){var y=i;r&&(r=typeof r=="string"?r:o.getPath(r),y=i?ie.join2(r,i):r);var b=kr(d,f),E=o.create(y,b);if(s){if(typeof s=="string"){for(var V=new Array(s.length),se=0,ae=s.length;se<ae;++se)V[se]=s.charCodeAt(se);s=V}o.chmod(E,b|146);var oe=o.open(E,577);o.write(oe,s,0,s.length,0,h),o.close(oe),o.chmod(E,b)}},createDevice(r,i,s,d){var b;var f=ie.join2(typeof r=="string"?r:o.getPath(r),i),h=kr(!!s,!!d);(b=o.createDevice).major??(b.major=64);var y=o.makedev(o.createDevice.major++,0);return o.registerDevice(y,{open(E){E.seekable=!1},close(E){var V;(V=d==null?void 0:d.buffer)!=null&&V.length&&d(10)},read(E,V,se,ae,oe){for(var G=0,ne=0;ne<ae;ne++){var we;try{we=s()}catch{throw new o.ErrnoError(29)}if(we===void 0&&G===0)throw new o.ErrnoError(6);if(we==null)break;G++,V[se+ne]=we}return G&&(E.node.atime=Date.now()),G},write(E,V,se,ae,oe){for(var G=0;G<ae;G++)try{d(V[se+G])}catch{throw new o.ErrnoError(29)}return ae&&(E.node.mtime=E.node.ctime=Date.now()),G}}),o.mkdev(f,h,y)},forceLoadFile(r){if(r.isDevice||r.isFolder||r.link||r.contents)return!0;if(typeof XMLHttpRequest<"u")throw new Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");try{r.contents=U(r.url),r.usedBytes=r.contents.length}catch{throw new o.ErrnoError(29)}},createLazyFile(r,i,s,d,f){class h{constructor(){Pe(this,"lengthKnown",!1);Pe(this,"chunks",[])}get(G){if(!(G>this.length-1||G<0)){var ne=G%this.chunkSize,we=G/this.chunkSize|0;return this.getter(we)[ne]}}setDataGetter(G){this.getter=G}cacheLength(){var G=new XMLHttpRequest;if(G.open("HEAD",s,!1),G.send(null),!(G.status>=200&&G.status<300||G.status===304))throw new Error("Couldn't load "+s+". Status: "+G.status);var ne=Number(G.getResponseHeader("Content-length")),we,Le=(we=G.getResponseHeader("Accept-Ranges"))&&we==="bytes",Re=(we=G.getResponseHeader("Content-Encoding"))&&we==="gzip",Oe=1024*1024;Le||(Oe=ne);var Be=(He,St)=>{if(He>St)throw new Error("invalid range ("+He+", "+St+") or no bytes requested!");if(St>ne-1)throw new Error("only "+ne+" bytes available! programmer error!");var _e=new XMLHttpRequest;if(_e.open("GET",s,!1),ne!==Oe&&_e.setRequestHeader("Range","bytes="+He+"-"+St),_e.responseType="arraybuffer",_e.overrideMimeType&&_e.overrideMimeType("text/plain; charset=x-user-defined"),_e.send(null),!(_e.status>=200&&_e.status<300||_e.status===304))throw new Error("Couldn't load "+s+". Status: "+_e.status);return _e.response!==void 0?new Uint8Array(_e.response||[]):ii(_e.responseText||"")},Nt=this;Nt.setDataGetter(He=>{var St=He*Oe,_e=(He+1)*Oe-1;if(_e=Math.min(_e,ne-1),typeof Nt.chunks[He]>"u"&&(Nt.chunks[He]=Be(St,_e)),typeof Nt.chunks[He]>"u")throw new Error("doXHR failed!");return Nt.chunks[He]}),(Re||!ne)&&(Oe=ne=1,ne=this.getter(0).length,Oe=ne,fe("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=ne,this._chunkSize=Oe,this.lengthKnown=!0}get length(){return this.lengthKnown||this.cacheLength(),this._length}get chunkSize(){return this.lengthKnown||this.cacheLength(),this._chunkSize}}if(typeof XMLHttpRequest<"u"){if(!m)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";var y=new h,b={isDevice:!1,contents:y}}else var b={isDevice:!1,url:s};var E=o.createFile(r,i,b,d,f);b.contents?E.contents=b.contents:b.url&&(E.contents=null,E.url=b.url),Object.defineProperties(E,{usedBytes:{get:function(){return this.contents.length}}});var V={},se=Object.keys(E.stream_ops);se.forEach(oe=>{var G=E.stream_ops[oe];V[oe]=(...ne)=>(o.forceLoadFile(E),G(...ne))});function ae(oe,G,ne,we,Le){var Re=oe.node.contents;if(Le>=Re.length)return 0;var Oe=Math.min(Re.length-Le,we);if(Re.slice)for(var Be=0;Be<Oe;Be++)G[ne+Be]=Re[Le+Be];else for(var Be=0;Be<Oe;Be++)G[ne+Be]=Re.get(Le+Be);return Oe}return V.read=(oe,G,ne,we,Le)=>(o.forceLoadFile(E),ae(oe,G,ne,we,Le)),V.mmap=(oe,G,ne,we,Le)=>{o.forceLoadFile(E);var Re=ni();if(!Re)throw new o.ErrnoError(48);return ae(oe,S,Re,G,ne),{ptr:Re,allocated:!0}},E.stream_ops=V,E}},kn=(r,i)=>r?Qe(x,r,i):"",Ee={DEFAULT_POLLMASK:5,calculateAt(r,i,s){if(ie.isAbs(i))return i;var d;if(r===-100)d=o.cwd();else{var f=Ee.getStreamFromFD(r);d=f.path}if(i.length==0){if(!s)throw new o.ErrnoError(44);return d}return d+"/"+i},writeStat(r,i){g[r>>2]=i.dev,g[r+4>>2]=i.mode,w[r+8>>2]=i.nlink,g[r+12>>2]=i.uid,g[r+16>>2]=i.gid,g[r+20>>2]=i.rdev,T[r+24>>3]=BigInt(i.size),g[r+32>>2]=4096,g[r+36>>2]=i.blocks;var s=i.atime.getTime(),d=i.mtime.getTime(),f=i.ctime.getTime();return T[r+40>>3]=BigInt(Math.floor(s/1e3)),w[r+48>>2]=s%1e3*1e3*1e3,T[r+56>>3]=BigInt(Math.floor(d/1e3)),w[r+64>>2]=d%1e3*1e3*1e3,T[r+72>>3]=BigInt(Math.floor(f/1e3)),w[r+80>>2]=f%1e3*1e3*1e3,T[r+88>>3]=BigInt(i.ino),0},writeStatFs(r,i){g[r+4>>2]=i.bsize,g[r+40>>2]=i.bsize,g[r+8>>2]=i.blocks,g[r+12>>2]=i.bfree,g[r+16>>2]=i.bavail,g[r+20>>2]=i.files,g[r+24>>2]=i.ffree,g[r+28>>2]=i.fsid,g[r+44>>2]=i.flags,g[r+36>>2]=i.namelen},doMsync(r,i,s,d,f){if(!o.isFile(i.node.mode))throw new o.ErrnoError(43);if(d&2)return 0;var h=x.slice(r,r+s);o.msync(i,h,f,s,d)},getStreamFromFD(r){var i=o.getStreamChecked(r);return i},varargs:void 0,getStr(r){var i=kn(r);return i}};function Pn(r,i,s){Ee.varargs=s;try{var d=Ee.getStreamFromFD(r);switch(i){case 0:{var f=ze();if(f<0)return-28;for(;o.streams[f];)f++;var h;return h=o.dupStream(d,f),h.fd}case 1:case 2:return 0;case 3:return d.flags;case 4:{var f=ze();return d.flags|=f,0}case 12:{var f=Te(),y=0;return I[f+y>>1]=2,0}case 13:case 14:return 0}return-28}catch(b){if(typeof o>"u"||b.name!=="ErrnoError")throw b;return-b.errno}}function An(r,i,s){Ee.varargs=s;try{var d=Ee.getStreamFromFD(r);switch(i){case 21509:return d.tty?0:-59;case 21505:{if(!d.tty)return-59;if(d.tty.ops.ioctl_tcgets){var f=d.tty.ops.ioctl_tcgets(d),h=Te();g[h>>2]=f.c_iflag||0,g[h+4>>2]=f.c_oflag||0,g[h+8>>2]=f.c_cflag||0,g[h+12>>2]=f.c_lflag||0;for(var y=0;y<32;y++)S[h+y+17]=f.c_cc[y]||0;return 0}return 0}case 21510:case 21511:case 21512:return d.tty?0:-59;case 21506:case 21507:case 21508:{if(!d.tty)return-59;if(d.tty.ops.ioctl_tcsets){for(var h=Te(),b=g[h>>2],E=g[h+4>>2],V=g[h+8>>2],se=g[h+12>>2],ae=[],y=0;y<32;y++)ae.push(S[h+y+17]);return d.tty.ops.ioctl_tcsets(d.tty,i,{c_iflag:b,c_oflag:E,c_cflag:V,c_lflag:se,c_cc:ae})}return 0}case 21519:{if(!d.tty)return-59;var h=Te();return g[h>>2]=0,0}case 21520:return d.tty?-28:-59;case 21531:{var h=Te();return o.ioctl(d,i,h)}case 21523:{if(!d.tty)return-59;if(d.tty.ops.ioctl_tiocgwinsz){var oe=d.tty.ops.ioctl_tiocgwinsz(d.tty),h=Te();I[h>>1]=oe[0],I[h+2>>1]=oe[1]}return 0}case 21524:return d.tty?0:-59;case 21515:return d.tty?0:-59;default:return-28}}catch(G){if(typeof o>"u"||G.name!=="ErrnoError")throw G;return-G.errno}}function In(r,i,s,d){Ee.varargs=d;try{i=Ee.getStr(i),i=Ee.calculateAt(r,i);var f=d?ze():0;return o.open(i,s,f).fd}catch(h){if(typeof o>"u"||h.name!=="ErrnoError")throw h;return-h.errno}}var En=()=>Ie(""),Fn=r=>r%4===0&&(r%100!==0||r%400===0),Dn=[0,31,60,91,121,152,182,213,244,274,305,335],Rn=[0,31,59,90,120,151,181,212,243,273,304,334],si=r=>{var i=Fn(r.getFullYear()),s=i?Dn:Rn,d=s[r.getMonth()]+r.getDate()-1;return d},Tn=9007199254740992,Ln=-9007199254740992,oi=r=>r<Ln||r>Tn?NaN:Number(r);function Mn(r,i){r=oi(r);var s=new Date(r*1e3);g[i>>2]=s.getSeconds(),g[i+4>>2]=s.getMinutes(),g[i+8>>2]=s.getHours(),g[i+12>>2]=s.getDate(),g[i+16>>2]=s.getMonth(),g[i+20>>2]=s.getFullYear()-1900,g[i+24>>2]=s.getDay();var d=si(s)|0;g[i+28>>2]=d,g[i+36>>2]=-(s.getTimezoneOffset()*60);var f=new Date(s.getFullYear(),0,1),h=new Date(s.getFullYear(),6,1).getTimezoneOffset(),y=f.getTimezoneOffset(),b=(h!=y&&s.getTimezoneOffset()==Math.min(y,h))|0;g[i+32>>2]=b}var Nn=function(r){var i=(()=>{var s=new Date(g[r+20>>2]+1900,g[r+16>>2],g[r+12>>2],g[r+8>>2],g[r+4>>2],g[r>>2],0),d=g[r+32>>2],f=s.getTimezoneOffset(),h=new Date(s.getFullYear(),0,1),y=new Date(s.getFullYear(),6,1).getTimezoneOffset(),b=h.getTimezoneOffset(),E=Math.min(b,y);if(d<0)g[r+32>>2]=+(y!=b&&E==f);else if(d>0!=(E==f)){var V=Math.max(b,y),se=d>0?E:V;s.setTime(s.getTime()+(se-f)*6e4)}g[r+24>>2]=s.getDay();var ae=si(s)|0;g[r+28>>2]=ae,g[r>>2]=s.getSeconds(),g[r+4>>2]=s.getMinutes(),g[r+8>>2]=s.getHours(),g[r+12>>2]=s.getDate(),g[r+16>>2]=s.getMonth(),g[r+20>>2]=s.getYear();var oe=s.getTime();return isNaN(oe)?-1:oe/1e3})();return BigInt(i)},Yt=(r,i,s)=>_r(r,x,i,s),On=(r,i,s,d)=>{var f=new Date().getFullYear(),h=new Date(f,0,1),y=new Date(f,6,1),b=h.getTimezoneOffset(),E=y.getTimezoneOffset(),V=Math.max(b,E);w[r>>2]=V*60,g[i>>2]=+(b!=E);var se=G=>{var ne=G>=0?"-":"+",we=Math.abs(G),Le=String(Math.floor(we/60)).padStart(2,"0"),Re=String(we%60).padStart(2,"0");return`UTC${ne}${Le}${Re}`},ae=se(b),oe=se(E);E<b?(Yt(ae,s,17),Yt(oe,d,17)):(Yt(ae,d,17),Yt(oe,s,17))},Bn=()=>2147483648,Un=(r,i)=>Math.ceil(r/i)*i,jn=r=>{var i=ge.buffer,s=(r-i.byteLength+65535)/65536|0;try{return ge.grow(s),X(),1}catch{}},Gn=r=>{var i=x.length;r>>>=0;var s=Bn();if(r>s)return!1;for(var d=1;d<=4;d*=2){var f=i*(1+.2/d);f=Math.min(f,r+100663296);var h=Math.min(s,Un(Math.max(r,f),65536)),y=jn(h);if(y)return!0}return!1};function zn(r){try{var i=Ee.getStreamFromFD(r);return o.close(i),0}catch(s){if(typeof o>"u"||s.name!=="ErrnoError")throw s;return s.errno}}var Hn=(r,i,s,d)=>{for(var f=0,h=0;h<s;h++){var y=w[i>>2],b=w[i+4>>2];i+=8;var E=o.read(r,S,y,b,d);if(E<0)return-1;if(f+=E,E<b)break}return f};function Vn(r,i,s,d){try{var f=Ee.getStreamFromFD(r),h=Hn(f,i,s);return w[d>>2]=h,0}catch(y){if(typeof o>"u"||y.name!=="ErrnoError")throw y;return y.errno}}function Wn(r,i,s,d){i=oi(i);try{if(isNaN(i))return 61;var f=Ee.getStreamFromFD(r);return o.llseek(f,i,s),T[d>>3]=BigInt(f.position),f.getdents&&i===0&&s===0&&(f.getdents=null),0}catch(h){if(typeof o>"u"||h.name!=="ErrnoError")throw h;return h.errno}}var Xn=(r,i,s,d)=>{for(var f=0,h=0;h<s;h++){var y=w[i>>2],b=w[i+4>>2];i+=8;var E=o.write(r,S,y,b,d);if(E<0)return-1;if(f+=E,E<b)break}return f};function qn(r,i,s,d){try{var f=Ee.getStreamFromFD(r),h=Xn(f,i,s);return w[d>>2]=h,0}catch(y){if(typeof o>"u"||y.name!=="ErrnoError")throw y;return y.errno}}o.createPreloadedFile=Cn,o.staticInit(),K.doesNotExistError=new o.ErrnoError(44),K.doesNotExistError.stack="<generic error, no stack>",t.noExitRuntime&&t.noExitRuntime,t.preloadPlugins&&(ai=t.preloadPlugins),t.print&&(fe=t.print),t.printErr&&(ce=t.printErr),t.wasmBinary&&(xe=t.wasmBinary),t.arguments&&t.arguments,t.thisProgram&&t.thisProgram;var Kn={a:Ge,d:Pn,i:An,m:In,j:En,l:Mn,e:Nn,f:On,k:Gn,b:zn,h:Vn,g:Wn,c:qn},N=await st();N.o,t._libraw_init=N.p,t._libraw_version=N.q,t._libraw_strprogress=N.r,t._libraw_versionNumber=N.s,t._libraw_cameraList=N.t,t._libraw_cameraCount=N.u,t._libraw_unpack_function_name=N.v,t._libraw_subtract_black=N.w,t._libraw_get_iparams=N.x,t._libraw_get_lensinfo=N.y,t._libraw_get_imgother=N.z,t._libraw_open_buffer=N.A,t._libraw_unpack=N.B,t._libraw_unpack_thumb=N.C,t._libraw_unpack_thumb_ex=N.D,t._libraw_recycle=N.E,t._libraw_close=N.F,t._libraw_dcraw_process=N.G,t._libraw_dcraw_make_mem_image=N.H,t._libraw_dcraw_make_mem_thumb=N.I,t._libraw_dcraw_clear_mem=N.J,t._libraw_raw2image=N.K,t._libraw_get_decoder_info=N.L,t._libraw_COLOR=N.M,t._libraw_set_demosaic=N.N,t._libraw_set_output_color=N.O,t._libraw_set_adjust_maximum_thr=N.P,t._libraw_set_output_bps=N.Q,t._libraw_set_user_mul=N.R,t._libraw_set_gamma=N.S,t._libraw_set_no_auto_bright=N.T,t._libraw_set_bright=N.U,t._libraw_set_highlight=N.V,t._libraw_set_fbdd_noiserd=N.W,t._libraw_get_raw_height=N.X,t._libraw_get_raw_width=N.Y,t._libraw_get_iheight=N.Z,t._libraw_get_iwidth=N._,t._libraw_get_cam_mul=N.$,t._libraw_get_pre_mul=N.aa,t._libraw_get_rgb_cam=N.ba,t._libraw_get_color_maximum=N.ca,t._libraw_get_raw_image=N.da,t._libraw_set_use_camera_wb=N.ea,t._libraw_get_thumbnail=N.fa,t._libraw_get_shootinginfo=N.ga,t._libraw_get_makernotes=N.ha,t._libraw_get_canon_makernotes=N.ia,t._libraw_get_nikon_makernotes=N.ja,t._libraw_get_hasselblad_makernotes=N.ka,t._libraw_get_fuji_info=N.la,t._libraw_get_olympus_makernotes=N.ma,t._libraw_get_sony_info=N.na,t._libraw_get_kodak_makernotes=N.oa,t._libraw_get_panasonic_makernotes=N.pa,t._libraw_get_pentax_makernotes=N.qa,t._libraw_get_phaseone_makernotes=N.ra,t._libraw_get_ricoh_makernotes=N.sa,t._libraw_get_samsung_makernotes=N.ta,t._libraw_get_common_metadata=N.ua,t._free=N.va,t._malloc=N.wa,t._libraw_strerror=N.xa;function Pr(){if(M>0){z=Pr;return}if(H(),M>0){z=Pr;return}function r(){var i;t.calledRun=!0,!v&&(te(),a(t),(i=t.onRuntimeInitialized)==null||i.call(t),Q())}t.setStatus?(t.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>t.setStatus(""),1),r()},1)):r()}function Yn(){if(t.preInit)for(typeof t.preInit=="function"&&(t.preInit=[t.preInit]);t.preInit.length>0;)t.preInit.shift()()}return Yn(),Pr(),e=c,e};const R=class R{constructor(){Pe(this,"lr",0);Pe(this,"_status","loading");this.setup()}get status(){return this._status}static async initialize(e){if(R.modulePromise===void 0){const t=xo({instantiateWasm:R.createInstantiateWasm(e)});R.modulePromise=t,R.module=await t}return await R.modulePromise}static createInstantiateWasm(e){if(e!==void 0)return async(t,a)=>{const l=await e,c=await(l instanceof Response?WebAssembly.instantiateStreaming(l,t):WebAssembly.instantiate(l,t));a(c.instance,c.module)}}async waitUntilReady(){await R.modulePromise}async setup(){await R.initialize(),this._status="ready",this.lr||(this.lr=R.module._libraw_init(0))}open(e){const t=R.module._malloc(e.byteLength),a=new Uint8Array(R.module.HEAPU8.buffer,t,e.byteLength);a.set(new Uint8Array(e)),this.handleError(R.module._libraw_open_buffer(this.lr,a.byteOffset,e.byteLength))}unpack(){this.handleError(R.module._libraw_unpack(this.lr))}unpackThumb(){this.handleError(R.module._libraw_unpack_thumb(this.lr))}unpackThumbEx(e){this.handleError(R.module._libraw_unpack_thumb_ex(this.lr,e))}raw2image(){this.handleError(R.module._libraw_raw2image(this.lr))}dcrawProcess(){this.handleError(R.module._libraw_dcraw_process(this.lr))}dcrawMakeMemImage(){const e=R.module._malloc(4),t=R.module._libraw_dcraw_make_mem_image(this.lr,e);if(this.readI32(e),R.module._free(e),!t)throw new Error("Unexpected error");const a=this.readProcessedImage(t);return R.module._libraw_dcraw_clear_mem(t),a}dcrawMakeMemThumb(){const e=R.module._malloc(4),t=R.module._libraw_dcraw_make_mem_thumb(this.lr,e),a=this.readI32(e);if(R.module._free(e),this.handleError(a),!t)throw new Error("Unexpected error");const l=this.readProcessedImage(t);return R.module._libraw_dcraw_clear_mem(t),l}readProcessedImage(e){return mo().override("data",{size:1,read(t,a){const l=t.offset??0,c=a.data_size;return t.buf.slice(l,l+c)}}).read({buf:R.module.HEAPU8,offset:e})}getRawHeight(){return R.module._libraw_get_raw_height(this.lr)}getRawWidth(){return R.module._libraw_get_raw_width(this.lr)}getIHeight(){return R.module._libraw_get_iheight(this.lr)}getIWidth(){return R.module._libraw_get_iwidth(this.lr)}getCamMul(e){return R.module._libraw_get_cam_mul(this.lr,e)}getPreMul(e){return R.module._libraw_get_pre_mul(this.lr,e)}getRgbCam(e,t){return R.module._libraw_get_rgb_cam(this.lr,e,t)}getColorMaximum(){return R.module._libraw_get_color_maximum(this.lr)}setUserMul(e,t){R.module._libraw_set_user_mul(this.lr,e,t)}setDemosaic(e){R.module._libraw_set_demosaic(this.lr,e)}setAdjustMaximumThr(e){R.module._libraw_set_adjust_maximum_thr(this.lr,e)}setOutputColor(e){R.module._libraw_set_output_color(this.lr,e)}setOutputBps(e){R.module._libraw_set_output_bps(this.lr,e)}setGamma(e,t){R.module._libraw_set_gamma(this.lr,e,t)}setNoAutoBright(e){R.module._libraw_set_no_auto_bright(this.lr,e)}setBright(e){R.module._libraw_set_bright(this.lr,e)}setHighlight(e){R.module._libraw_set_highlight(this.lr,e)}setFbddNoiserd(e){R.module._libraw_set_fbdd_noiserd(this.lr,e)}static version(){if(R.module===void 0)throw new Error("Not initialized");const e=R.module._libraw_version();return me(Number.POSITIVE_INFINITY).read({buf:R.module.HEAPU8,offset:e},{})}static versionNumber(){if(R.module===void 0)throw new Error("Not initialized");return R.module._libraw_versionNumber()}static cameraCount(){if(R.module===void 0)throw new Error("Not initialized");return R.module._libraw_cameraCount()}static cameraList(){if(R.module===void 0)throw new Error("Not initialized");const e=R.module._libraw_cameraList(),t=R.cameraCount();return C(Nr(),t).read({buf:R.module.HEAPU8,offset:e},{})}unpackFunctionName(){return this.readString(R.module._libraw_unpack_function_name(this.lr))}color(e,t){return R.module._libraw_COLOR(this.lr,e,t)}recycle(){R.module._libraw_recycle(this.lr)}getRawImage(){const e=R.module._libraw_get_raw_image(this.lr);return new Uint16Array(R.module.HEAPU8.buffer,e)}getIParams(){return ro().override("make",me(64)).override("model",me(64)).override("software",me(64)).override("normalized_make",me(64)).override("normalized_model",me(64)).override("cdesc",me(5)).override("xmpdata",Nr()).read({buf:R.module.HEAPU8,offset:R.module._libraw_get_iparams(this.lr)})}getLensInfo(){const e=yn().override("Lens",me(128)).override("body",me(64)).override("FocalType",ti(Y,{unknown:0,"fixed focal":1,zoom:2})).override("LensFeatures_pre",me(16)).override("LensFeatures_suf",me(16)).override("Teleconverter",me(128)).override("Adapter",me(128)).override("Attachment",me(128));return no().override("LensMake",me(128)).override("Lens",me(128)).override("LensSerial",me(128)).override("InternalLensSerial",me(128)).override("makernotes",e).read({buf:R.module.HEAPU8,offset:R.module._libraw_get_lensinfo(this.lr)})}getImgOther(){return to().override("desc",me(512)).override("artist",me(64)).read({buf:R.module.HEAPU8,offset:R.module._libraw_get_imgother(this.lr)})}getThumbnail(){return So().override("thumb",Vs(j,"tlength")).read({buf:R.module.HEAPU8,offset:R.module._libraw_get_thumbnail(this.lr)})}getShootingInfo(){return wo().override("BodySerial",me(64)).override("InternalBodySerial",me(64)).read({buf:R.module.HEAPU8,offset:R.module._libraw_get_shootinginfo(this.lr)})}getMakernotes(){return ao().read({buf:R.module.HEAPU8,offset:R.module._libraw_get_makernotes(this.lr)})}handleError(e){if(e)throw Error(this.readString(R.module._libraw_strerror(e)))}readString(e){return Nr().read({buf:R.module.HEAPU8,offset:e},{})}readI32(e){return pn({buf:R.module.HEAPU8,offset:e})}dispose(){this._status!=="disposed"&&(R.module._libraw_close(this.lr),this._status="disposed")}[Symbol.dispose](){this.dispose()}};Pe(R,"modulePromise"),Pe(R,"module");let pr=R;var ar={exports:{}},Ni;function Co(){return Ni||(Ni=1,function(n,e){(function(){var t={};t.version="1.0.4",t.remove=function(v){var S=!1;if(v.slice(0,2)!="")if(v.slice(0,23)=="data:image/jpeg;base64,"||v.slice(0,22)=="data:image/jpg;base64,")v=L(v.split(",")[1]),S=!0;else throw new Error("Given data is not jpeg.");var x=de(v),I=x.filter(function(w){return!(w.slice(0,2)==""&&w.slice(4,10)=="Exif\0\0")}),g=I.join("");return S&&(g="data:image/jpeg;base64,"+F(g)),g},t.insert=function(v,S){var x=!1;if(v.slice(0,6)!="Exif\0\0")throw new Error("Given data is not exif.");if(S.slice(0,2)!="")if(S.slice(0,23)=="data:image/jpeg;base64,"||S.slice(0,22)=="data:image/jpg;base64,")S=L(S.split(",")[1]),x=!0;else throw new Error("Given data is not jpeg.");var I=""+D(">H",[v.length+2])+v,g=de(S),w=ce(g,I);return x&&(w="data:image/jpeg;base64,"+F(w)),w},t.load=function(v){var S;if(typeof v=="string")if(v.slice(0,2)=="")S=v;else if(v.slice(0,23)=="data:image/jpeg;base64,"||v.slice(0,22)=="data:image/jpg;base64,")S=L(v.split(",")[1]);else if(v.slice(0,4)=="Exif")S=v.slice(6);else throw new Error("'load' gots invalid file data.");else throw new Error("'load' gots invalid type argument.");var x={"0th":{},Exif:{},GPS:{},Interop:{},"1st":{},thumbnail:null},I=new k(S);if(I.tiftag===null)return x;I.tiftag.slice(0,2)=="II"?I.endian_mark="<":I.endian_mark=">";var g=U(I.endian_mark+"L",I.tiftag.slice(4,8))[0];x["0th"]=I.get_ifd(g,"0th");var w=x["0th"].first_ifd_pointer;if(delete x["0th"].first_ifd_pointer,34665 in x["0th"]&&(g=x["0th"][34665],x.Exif=I.get_ifd(g,"Exif")),34853 in x["0th"]&&(g=x["0th"][34853],x.GPS=I.get_ifd(g,"GPS")),40965 in x.Exif&&(g=x.Exif[40965],x.Interop=I.get_ifd(g,"Interop")),w!="\0\0\0\0"&&(g=U(I.endian_mark+"L",w)[0],x["1st"]=I.get_ifd(g,"1st"),513 in x["1st"]&&514 in x["1st"])){var T=x["1st"][513]+x["1st"][514],q=I.tiftag.slice(x["1st"][513],T);x.thumbnail=q}return x},t.dump=function(v){var S=8,x=a(v),I="Exif\0\0MM\0*\0\0\0\b",g=!1,w=!1,T=!1,q=!1,X,H,te,Q,M;"0th"in x?X=x["0th"]:X={},"Exif"in x&&Object.keys(x.Exif).length||"Interop"in x&&Object.keys(x.Interop).length?(X[34665]=1,g=!0,H=x.Exif,"Interop"in x&&Object.keys(x.Interop).length?(H[40965]=1,T=!0,te=x.Interop):Object.keys(H).indexOf(t.ExifIFD.InteroperabilityTag.toString())>-1&&delete H[40965]):Object.keys(X).indexOf(t.ImageIFD.ExifTag.toString())>-1&&delete X[34665],"GPS"in x&&Object.keys(x.GPS).length?(X[t.ImageIFD.GPSTag]=1,w=!0,Q=x.GPS):Object.keys(X).indexOf(t.ImageIFD.GPSTag.toString())>-1&&delete X[t.ImageIFD.GPSTag],"1st"in x&&"thumbnail"in x&&x.thumbnail!=null&&(q=!0,x["1st"][513]=1,x["1st"][514]=1,M=x["1st"]);var z=A(X,"0th",0),Z=z[0].length+g*12+w*12+4+z[1].length,re,Ie="",he=0,Ne,Ye="",Xe=0,Wt,Et="",Ft=0,st,Dt="",ot;if(g&&(re=A(H,"Exif",Z),he=re[0].length+T*12+re[1].length),w&&(Ne=A(Q,"GPS",Z+he),Ye=Ne.join(""),Xe=Ye.length),T){var Rt=Z+he+Xe;Wt=A(te,"Interop",Rt),Et=Wt.join(""),Ft=Et.length}if(q){var Rt=Z+he+Xe+Ft;if(st=A(M,"1st",Rt),ot=l(x.thumbnail),ot.length>64e3)throw new Error("Given thumbnail is too large. max 64kB")}var Tt="",Xt="",qt="",Lt="\0\0\0\0";if(g){var Ge=S+Z,ze=D(">L",[Ge]),Te=34665,ie=D(">H",[Te]),lt=D(">H",[xe.Long]),$e=D(">L",[1]);Tt=ie+lt+$e+ze}if(w){var Ge=S+Z+he,ze=D(">L",[Ge]),Te=34853,ie=D(">H",[Te]),lt=D(">H",[xe.Long]),$e=D(">L",[1]);Xt=ie+lt+$e+ze}if(T){var Ge=S+Z+he+Xe,ze=D(">L",[Ge]),Te=40965,ie=D(">H",[Te]),lt=D(">H",[xe.Long]),$e=D(">L",[1]);qt=ie+lt+$e+ze}if(q){var Ge=S+Z+he+Xe+Ft;Lt=D(">L",[Ge]);var Je=Ge+st[0].length+24+4+st[1].length,Kt="\0\0\0\0"+D(">L",[Je]),Qe="\0\0\0\0"+D(">L",[ot.length]);Dt=st[0]+Kt+Qe+"\0\0\0\0"+st[1]+ot}var Mt=z[0]+Tt+Xt+Lt+z[1];return g&&(Ie=re[0]+qt+re[1]),I+Mt+Ie+Ye+Et+Dt};function a(v){return JSON.parse(JSON.stringify(v))}function l(v){for(var S=de(v);""<=S[1].slice(0,2)&&S[1].slice(0,2)<="";)S=[S[0]].concat(S.slice(2));return S.join("")}function c(v){return D(">"+$("B",v.length),v)}function p(v){return D(">"+$("H",v.length),v)}function m(v){return D(">"+$("L",v.length),v)}function P(v,S,x){var I="",g="",w,T,q,X;if(S=="Byte")w=v.length,w<=4?g=c(v)+$("\0",4-w):(g=D(">L",[x]),I=c(v));else if(S=="Short")w=v.length,w<=2?g=p(v)+$("\0\0",2-w):(g=D(">L",[x]),I=p(v));else if(S=="Long")w=v.length,w<=1?g=m(v):(g=D(">L",[x]),I=m(v));else if(S=="Ascii")T=v+"\0",w=T.length,w>4?(g=D(">L",[x]),I=T):g=T+$("\0",4-w);else if(S=="Rational"){if(typeof v[0]=="number")w=1,q=v[0],X=v[1],T=D(">L",[q])+D(">L",[X]);else{w=v.length,T="";for(var H=0;H<w;H++)q=v[H][0],X=v[H][1],T+=D(">L",[q])+D(">L",[X])}g=D(">L",[x]),I=T}else if(S=="SRational"){if(typeof v[0]=="number")w=1,q=v[0],X=v[1],T=D(">l",[q])+D(">l",[X]);else{w=v.length,T="";for(var H=0;H<w;H++)q=v[H][0],X=v[H][1],T+=D(">l",[q])+D(">l",[X])}g=D(">L",[x]),I=T}else S=="Undefined"&&(w=v.length,w>4?(g=D(">L",[x]),I=v):g=v+$("\0",4-w));var te=D(">L",[w]);return[te,g,I]}function A(v,S,x){var I=8,g=Object.keys(v).length,w=D(">H",[g]),T;["0th","1st"].indexOf(S)>-1?T=2+g*12+4:T=2+g*12;var q="",X="",H;for(var H in v)if(typeof H=="string"&&(H=parseInt(H)),!(S=="0th"&&[34665,34853].indexOf(H)>-1)){{if(S=="Exif"&&H==40965)continue;if(S=="1st"&&[513,514].indexOf(H)>-1)continue}var te=v[H],Q=D(">H",[H]),M=ge[S][H].type,z=D(">H",[xe[M]]);typeof te=="number"&&(te=[te]);var Z=I+T+x+X.length,re=P(te,M,Z),Ie=re[0],he=re[1],Ne=re[2];q+=Q+z+Ie+he,X+=Ne}return[w+q,X]}function k(v){var S,x;if(v.slice(0,2)=="")S=de(v),x=fe(S),x?this.tiftag=x.slice(10):this.tiftag=null;else if(["II","MM"].indexOf(v.slice(0,2))>-1)this.tiftag=v;else if(v.slice(0,4)=="Exif")this.tiftag=v.slice(6);else throw new Error("Given file is neither JPEG nor TIFF.")}if(k.prototype={get_ifd:function(v,S){var x={},I=U(this.endian_mark+"H",this.tiftag.slice(v,v+2))[0],g=v+2,w;["0th","1st"].indexOf(S)>-1?w="Image":w=S;for(var T=0;T<I;T++){v=g+12*T;var q=U(this.endian_mark+"H",this.tiftag.slice(v,v+2))[0],X=U(this.endian_mark+"H",this.tiftag.slice(v+2,v+4))[0],H=U(this.endian_mark+"L",this.tiftag.slice(v+4,v+8))[0],te=this.tiftag.slice(v+8,v+12),Q=[X,H,te];q in ge[w]&&(x[q]=this.convert_value(Q))}return S=="0th"&&(v=g+12*I,x.first_ifd_pointer=this.tiftag.slice(v,v+4)),x},convert_value:function(v){var S=null,x=v[0],I=v[1],g=v[2],w;if(x==1)I>4?(w=U(this.endian_mark+"L",g)[0],S=U(this.endian_mark+$("B",I),this.tiftag.slice(w,w+I))):S=U(this.endian_mark+$("B",I),g.slice(0,I));else if(x==2)I>4?(w=U(this.endian_mark+"L",g)[0],S=this.tiftag.slice(w,w+I-1)):S=g.slice(0,I-1);else if(x==3)I>2?(w=U(this.endian_mark+"L",g)[0],S=U(this.endian_mark+$("H",I),this.tiftag.slice(w,w+I*2))):S=U(this.endian_mark+$("H",I),g.slice(0,I*2));else if(x==4)I>1?(w=U(this.endian_mark+"L",g)[0],S=U(this.endian_mark+$("L",I),this.tiftag.slice(w,w+I*4))):S=U(this.endian_mark+$("L",I),g);else if(x==5)if(w=U(this.endian_mark+"L",g)[0],I>1){S=[];for(var T=0;T<I;T++)S.push([U(this.endian_mark+"L",this.tiftag.slice(w+T*8,w+4+T*8))[0],U(this.endian_mark+"L",this.tiftag.slice(w+4+T*8,w+8+T*8))[0]])}else S=[U(this.endian_mark+"L",this.tiftag.slice(w,w+4))[0],U(this.endian_mark+"L",this.tiftag.slice(w+4,w+8))[0]];else if(x==7)I>4?(w=U(this.endian_mark+"L",g)[0],S=this.tiftag.slice(w,w+I)):S=g.slice(0,I);else if(x==9)I>1?(w=U(this.endian_mark+"L",g)[0],S=U(this.endian_mark+$("l",I),this.tiftag.slice(w,w+I*4))):S=U(this.endian_mark+$("l",I),g);else if(x==10)if(w=U(this.endian_mark+"L",g)[0],I>1){S=[];for(var T=0;T<I;T++)S.push([U(this.endian_mark+"l",this.tiftag.slice(w+T*8,w+4+T*8))[0],U(this.endian_mark+"l",this.tiftag.slice(w+4+T*8,w+8+T*8))[0]])}else S=[U(this.endian_mark+"l",this.tiftag.slice(w,w+4))[0],U(this.endian_mark+"l",this.tiftag.slice(w+4,w+8))[0]];else throw new Error("Exif might be wrong. Got incorrect value type to decode. type:"+x);return S instanceof Array&&S.length==1?S[0]:S}},typeof window<"u"&&typeof window.btoa=="function")var F=window.btoa;if(typeof F>"u")var F=function(S){for(var x="",I,g,w,T,q,X,H,te=0,Q="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";te<S.length;)I=S.charCodeAt(te++),g=S.charCodeAt(te++),w=S.charCodeAt(te++),T=I>>2,q=(I&3)<<4|g>>4,X=(g&15)<<2|w>>6,H=w&63,isNaN(g)?X=H=64:isNaN(w)&&(H=64),x=x+Q.charAt(T)+Q.charAt(q)+Q.charAt(X)+Q.charAt(H);return x};if(typeof window<"u"&&typeof window.atob=="function")var L=window.atob;if(typeof L>"u")var L=function(S){var x="",I,g,w,T,q,X,H,te=0,Q="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";for(S=S.replace(/[^A-Za-z0-9\+\/\=]/g,"");te<S.length;)T=Q.indexOf(S.charAt(te++)),q=Q.indexOf(S.charAt(te++)),X=Q.indexOf(S.charAt(te++)),H=Q.indexOf(S.charAt(te++)),I=T<<2|q>>4,g=(q&15)<<4|X>>2,w=(X&3)<<6|H,x=x+String.fromCharCode(I),X!=64&&(x=x+String.fromCharCode(g)),H!=64&&(x=x+String.fromCharCode(w));return x};function D(v,S){if(!(S instanceof Array))throw new Error("'pack' error. Got invalid type argument.");if(v.length-1!=S.length)throw new Error("'pack' error. "+(v.length-1)+" marks, "+S.length+" elements.");var x;if(v[0]=="<")x=!0;else if(v[0]==">")x=!1;else throw new Error("");for(var I="",g=1,w=null,T=null,q=null;T=v[g];){if(T.toLowerCase()=="b"){if(w=S[g-1],T=="b"&&w<0&&(w+=256),w>255||w<0)throw new Error("'pack' error.");q=String.fromCharCode(w)}else if(T=="H"){if(w=S[g-1],w>65535||w<0)throw new Error("'pack' error.");q=String.fromCharCode(Math.floor(w%65536/256))+String.fromCharCode(w%256),x&&(q=q.split("").reverse().join(""))}else if(T.toLowerCase()=="l"){if(w=S[g-1],T=="l"&&w<0&&(w+=4294967296),w>4294967295||w<0)throw new Error("'pack' error.");q=String.fromCharCode(Math.floor(w/16777216))+String.fromCharCode(Math.floor(w%16777216/65536))+String.fromCharCode(Math.floor(w%65536/256))+String.fromCharCode(w%256),x&&(q=q.split("").reverse().join(""))}else throw new Error("'pack' error.");I+=q,g+=1}return I}function U(v,S){if(typeof S!="string")throw new Error("'unpack' error. Got invalid type argument.");for(var x=0,I=1;I<v.length;I++)if(v[I].toLowerCase()=="b")x+=1;else if(v[I].toLowerCase()=="h")x+=2;else if(v[I].toLowerCase()=="l")x+=4;else throw new Error("'unpack' error. Got invalid mark.");if(x!=S.length)throw new Error("'unpack' error. Mismatch between symbol and string length. "+x+":"+S.length);var g;if(v[0]=="<")g=!0;else if(v[0]==">")g=!1;else throw new Error("'unpack' error.");for(var w=[],T=0,q=1,X=null,H=null,te=null,Q="";H=v[q];){if(H.toLowerCase()=="b")te=1,Q=S.slice(T,T+te),X=Q.charCodeAt(0),H=="b"&&X>=128&&(X-=256);else if(H=="H")te=2,Q=S.slice(T,T+te),g&&(Q=Q.split("").reverse().join("")),X=Q.charCodeAt(0)*256+Q.charCodeAt(1);else if(H.toLowerCase()=="l")te=4,Q=S.slice(T,T+te),g&&(Q=Q.split("").reverse().join("")),X=Q.charCodeAt(0)*16777216+Q.charCodeAt(1)*65536+Q.charCodeAt(2)*256+Q.charCodeAt(3),H=="l"&&X>=2147483648&&(X-=4294967296);else throw new Error("'unpack' error. "+H);w.push(X),T+=te,q+=1}return w}function $(v,S){for(var x="",I=0;I<S;I++)x+=v;return x}function de(v){if(v.slice(0,2)!="")throw new Error("Given data isn't JPEG.");for(var S=2,x=[""];;){if(v.slice(S,S+2)==""){x.push(v.slice(S));break}else{var I=U(">H",v.slice(S+2,S+4))[0],g=S+I+2;x.push(v.slice(S,g)),S=g}if(S>=v.length)throw new Error("Wrong JPEG data.")}return x}function fe(v){for(var S,x=0;x<v.length;x++)if(S=v[x],S.slice(0,2)==""&&S.slice(4,10)=="Exif\0\0")return S;return null}function ce(v,S){var x=!1,I=[];return v.forEach(function(g,w){g.slice(0,2)==""&&g.slice(4,10)=="Exif\0\0"&&(x?I.unshift(w):(v[w]=S,x=!0))}),I.forEach(function(g){v.splice(g,1)}),!x&&S&&(v=[v[0],S].concat(v.slice(1))),v.join("")}var xe={Byte:1,Ascii:2,Short:3,Long:4,Rational:5,Undefined:7,SLong:9,SRational:10},ge={Image:{11:{name:"ProcessingSoftware",type:"Ascii"},254:{name:"NewSubfileType",type:"Long"},255:{name:"SubfileType",type:"Short"},256:{name:"ImageWidth",type:"Long"},257:{name:"ImageLength",type:"Long"},258:{name:"BitsPerSample",type:"Short"},259:{name:"Compression",type:"Short"},262:{name:"PhotometricInterpretation",type:"Short"},263:{name:"Threshholding",type:"Short"},264:{name:"CellWidth",type:"Short"},265:{name:"CellLength",type:"Short"},266:{name:"FillOrder",type:"Short"},269:{name:"DocumentName",type:"Ascii"},270:{name:"ImageDescription",type:"Ascii"},271:{name:"Make",type:"Ascii"},272:{name:"Model",type:"Ascii"},273:{name:"StripOffsets",type:"Long"},274:{name:"Orientation",type:"Short"},277:{name:"SamplesPerPixel",type:"Short"},278:{name:"RowsPerStrip",type:"Long"},279:{name:"StripByteCounts",type:"Long"},282:{name:"XResolution",type:"Rational"},283:{name:"YResolution",type:"Rational"},284:{name:"PlanarConfiguration",type:"Short"},290:{name:"GrayResponseUnit",type:"Short"},291:{name:"GrayResponseCurve",type:"Short"},292:{name:"T4Options",type:"Long"},293:{name:"T6Options",type:"Long"},296:{name:"ResolutionUnit",type:"Short"},301:{name:"TransferFunction",type:"Short"},305:{name:"Software",type:"Ascii"},306:{name:"DateTime",type:"Ascii"},315:{name:"Artist",type:"Ascii"},316:{name:"HostComputer",type:"Ascii"},317:{name:"Predictor",type:"Short"},318:{name:"WhitePoint",type:"Rational"},319:{name:"PrimaryChromaticities",type:"Rational"},320:{name:"ColorMap",type:"Short"},321:{name:"HalftoneHints",type:"Short"},322:{name:"TileWidth",type:"Short"},323:{name:"TileLength",type:"Short"},324:{name:"TileOffsets",type:"Short"},325:{name:"TileByteCounts",type:"Short"},330:{name:"SubIFDs",type:"Long"},332:{name:"InkSet",type:"Short"},333:{name:"InkNames",type:"Ascii"},334:{name:"NumberOfInks",type:"Short"},336:{name:"DotRange",type:"Byte"},337:{name:"TargetPrinter",type:"Ascii"},338:{name:"ExtraSamples",type:"Short"},339:{name:"SampleFormat",type:"Short"},340:{name:"SMinSampleValue",type:"Short"},341:{name:"SMaxSampleValue",type:"Short"},342:{name:"TransferRange",type:"Short"},343:{name:"ClipPath",type:"Byte"},344:{name:"XClipPathUnits",type:"Long"},345:{name:"YClipPathUnits",type:"Long"},346:{name:"Indexed",type:"Short"},347:{name:"JPEGTables",type:"Undefined"},351:{name:"OPIProxy",type:"Short"},512:{name:"JPEGProc",type:"Long"},513:{name:"JPEGInterchangeFormat",type:"Long"},514:{name:"JPEGInterchangeFormatLength",type:"Long"},515:{name:"JPEGRestartInterval",type:"Short"},517:{name:"JPEGLosslessPredictors",type:"Short"},518:{name:"JPEGPointTransforms",type:"Short"},519:{name:"JPEGQTables",type:"Long"},520:{name:"JPEGDCTables",type:"Long"},521:{name:"JPEGACTables",type:"Long"},529:{name:"YCbCrCoefficients",type:"Rational"},530:{name:"YCbCrSubSampling",type:"Short"},531:{name:"YCbCrPositioning",type:"Short"},532:{name:"ReferenceBlackWhite",type:"Rational"},700:{name:"XMLPacket",type:"Byte"},18246:{name:"Rating",type:"Short"},18249:{name:"RatingPercent",type:"Short"},32781:{name:"ImageID",type:"Ascii"},33421:{name:"CFARepeatPatternDim",type:"Short"},33422:{name:"CFAPattern",type:"Byte"},33423:{name:"BatteryLevel",type:"Rational"},33432:{name:"Copyright",type:"Ascii"},33434:{name:"ExposureTime",type:"Rational"},34377:{name:"ImageResources",type:"Byte"},34665:{name:"ExifTag",type:"Long"},34675:{name:"InterColorProfile",type:"Undefined"},34853:{name:"GPSTag",type:"Long"},34857:{name:"Interlace",type:"Short"},34858:{name:"TimeZoneOffset",type:"Long"},34859:{name:"SelfTimerMode",type:"Short"},37387:{name:"FlashEnergy",type:"Rational"},37388:{name:"SpatialFrequencyResponse",type:"Undefined"},37389:{name:"Noise",type:"Undefined"},37390:{name:"FocalPlaneXResolution",type:"Rational"},37391:{name:"FocalPlaneYResolution",type:"Rational"},37392:{name:"FocalPlaneResolutionUnit",type:"Short"},37393:{name:"ImageNumber",type:"Long"},37394:{name:"SecurityClassification",type:"Ascii"},37395:{name:"ImageHistory",type:"Ascii"},37397:{name:"ExposureIndex",type:"Rational"},37398:{name:"TIFFEPStandardID",type:"Byte"},37399:{name:"SensingMethod",type:"Short"},40091:{name:"XPTitle",type:"Byte"},40092:{name:"XPComment",type:"Byte"},40093:{name:"XPAuthor",type:"Byte"},40094:{name:"XPKeywords",type:"Byte"},40095:{name:"XPSubject",type:"Byte"},50341:{name:"PrintImageMatching",type:"Undefined"},50706:{name:"DNGVersion",type:"Byte"},50707:{name:"DNGBackwardVersion",type:"Byte"},50708:{name:"UniqueCameraModel",type:"Ascii"},50709:{name:"LocalizedCameraModel",type:"Byte"},50710:{name:"CFAPlaneColor",type:"Byte"},50711:{name:"CFALayout",type:"Short"},50712:{name:"LinearizationTable",type:"Short"},50713:{name:"BlackLevelRepeatDim",type:"Short"},50714:{name:"BlackLevel",type:"Rational"},50715:{name:"BlackLevelDeltaH",type:"SRational"},50716:{name:"BlackLevelDeltaV",type:"SRational"},50717:{name:"WhiteLevel",type:"Short"},50718:{name:"DefaultScale",type:"Rational"},50719:{name:"DefaultCropOrigin",type:"Short"},50720:{name:"DefaultCropSize",type:"Short"},50721:{name:"ColorMatrix1",type:"SRational"},50722:{name:"ColorMatrix2",type:"SRational"},50723:{name:"CameraCalibration1",type:"SRational"},50724:{name:"CameraCalibration2",type:"SRational"},50725:{name:"ReductionMatrix1",type:"SRational"},50726:{name:"ReductionMatrix2",type:"SRational"},50727:{name:"AnalogBalance",type:"Rational"},50728:{name:"AsShotNeutral",type:"Short"},50729:{name:"AsShotWhiteXY",type:"Rational"},50730:{name:"BaselineExposure",type:"SRational"},50731:{name:"BaselineNoise",type:"Rational"},50732:{name:"BaselineSharpness",type:"Rational"},50733:{name:"BayerGreenSplit",type:"Long"},50734:{name:"LinearResponseLimit",type:"Rational"},50735:{name:"CameraSerialNumber",type:"Ascii"},50736:{name:"LensInfo",type:"Rational"},50737:{name:"ChromaBlurRadius",type:"Rational"},50738:{name:"AntiAliasStrength",type:"Rational"},50739:{name:"ShadowScale",type:"SRational"},50740:{name:"DNGPrivateData",type:"Byte"},50741:{name:"MakerNoteSafety",type:"Short"},50778:{name:"CalibrationIlluminant1",type:"Short"},50779:{name:"CalibrationIlluminant2",type:"Short"},50780:{name:"BestQualityScale",type:"Rational"},50781:{name:"RawDataUniqueID",type:"Byte"},50827:{name:"OriginalRawFileName",type:"Byte"},50828:{name:"OriginalRawFileData",type:"Undefined"},50829:{name:"ActiveArea",type:"Short"},50830:{name:"MaskedAreas",type:"Short"},50831:{name:"AsShotICCProfile",type:"Undefined"},50832:{name:"AsShotPreProfileMatrix",type:"SRational"},50833:{name:"CurrentICCProfile",type:"Undefined"},50834:{name:"CurrentPreProfileMatrix",type:"SRational"},50879:{name:"ColorimetricReference",type:"Short"},50931:{name:"CameraCalibrationSignature",type:"Byte"},50932:{name:"ProfileCalibrationSignature",type:"Byte"},50934:{name:"AsShotProfileName",type:"Byte"},50935:{name:"NoiseReductionApplied",type:"Rational"},50936:{name:"ProfileName",type:"Byte"},50937:{name:"ProfileHueSatMapDims",type:"Long"},50938:{name:"ProfileHueSatMapData1",type:"Float"},50939:{name:"ProfileHueSatMapData2",type:"Float"},50940:{name:"ProfileToneCurve",type:"Float"},50941:{name:"ProfileEmbedPolicy",type:"Long"},50942:{name:"ProfileCopyright",type:"Byte"},50964:{name:"ForwardMatrix1",type:"SRational"},50965:{name:"ForwardMatrix2",type:"SRational"},50966:{name:"PreviewApplicationName",type:"Byte"},50967:{name:"PreviewApplicationVersion",type:"Byte"},50968:{name:"PreviewSettingsName",type:"Byte"},50969:{name:"PreviewSettingsDigest",type:"Byte"},50970:{name:"PreviewColorSpace",type:"Long"},50971:{name:"PreviewDateTime",type:"Ascii"},50972:{name:"RawImageDigest",type:"Undefined"},50973:{name:"OriginalRawFileDigest",type:"Undefined"},50974:{name:"SubTileBlockSize",type:"Long"},50975:{name:"RowInterleaveFactor",type:"Long"},50981:{name:"ProfileLookTableDims",type:"Long"},50982:{name:"ProfileLookTableData",type:"Float"},51008:{name:"OpcodeList1",type:"Undefined"},51009:{name:"OpcodeList2",type:"Undefined"},51022:{name:"OpcodeList3",type:"Undefined"}},Exif:{33434:{name:"ExposureTime",type:"Rational"},33437:{name:"FNumber",type:"Rational"},34850:{name:"ExposureProgram",type:"Short"},34852:{name:"SpectralSensitivity",type:"Ascii"},34855:{name:"ISOSpeedRatings",type:"Short"},34856:{name:"OECF",type:"Undefined"},34864:{name:"SensitivityType",type:"Short"},34865:{name:"StandardOutputSensitivity",type:"Long"},34866:{name:"RecommendedExposureIndex",type:"Long"},34867:{name:"ISOSpeed",type:"Long"},34868:{name:"ISOSpeedLatitudeyyy",type:"Long"},34869:{name:"ISOSpeedLatitudezzz",type:"Long"},36864:{name:"ExifVersion",type:"Undefined"},36867:{name:"DateTimeOriginal",type:"Ascii"},36868:{name:"DateTimeDigitized",type:"Ascii"},37121:{name:"ComponentsConfiguration",type:"Undefined"},37122:{name:"CompressedBitsPerPixel",type:"Rational"},37377:{name:"ShutterSpeedValue",type:"SRational"},37378:{name:"ApertureValue",type:"Rational"},37379:{name:"BrightnessValue",type:"SRational"},37380:{name:"ExposureBiasValue",type:"SRational"},37381:{name:"MaxApertureValue",type:"Rational"},37382:{name:"SubjectDistance",type:"Rational"},37383:{name:"MeteringMode",type:"Short"},37384:{name:"LightSource",type:"Short"},37385:{name:"Flash",type:"Short"},37386:{name:"FocalLength",type:"Rational"},37396:{name:"SubjectArea",type:"Short"},37500:{name:"MakerNote",type:"Undefined"},37510:{name:"UserComment",type:"Ascii"},37520:{name:"SubSecTime",type:"Ascii"},37521:{name:"SubSecTimeOriginal",type:"Ascii"},37522:{name:"SubSecTimeDigitized",type:"Ascii"},40960:{name:"FlashpixVersion",type:"Undefined"},40961:{name:"ColorSpace",type:"Short"},40962:{name:"PixelXDimension",type:"Long"},40963:{name:"PixelYDimension",type:"Long"},40964:{name:"RelatedSoundFile",type:"Ascii"},40965:{name:"InteroperabilityTag",type:"Long"},41483:{name:"FlashEnergy",type:"Rational"},41484:{name:"SpatialFrequencyResponse",type:"Undefined"},41486:{name:"FocalPlaneXResolution",type:"Rational"},41487:{name:"FocalPlaneYResolution",type:"Rational"},41488:{name:"FocalPlaneResolutionUnit",type:"Short"},41492:{name:"SubjectLocation",type:"Short"},41493:{name:"ExposureIndex",type:"Rational"},41495:{name:"SensingMethod",type:"Short"},41728:{name:"FileSource",type:"Undefined"},41729:{name:"SceneType",type:"Undefined"},41730:{name:"CFAPattern",type:"Undefined"},41985:{name:"CustomRendered",type:"Short"},41986:{name:"ExposureMode",type:"Short"},41987:{name:"WhiteBalance",type:"Short"},41988:{name:"DigitalZoomRatio",type:"Rational"},41989:{name:"FocalLengthIn35mmFilm",type:"Short"},41990:{name:"SceneCaptureType",type:"Short"},41991:{name:"GainControl",type:"Short"},41992:{name:"Contrast",type:"Short"},41993:{name:"Saturation",type:"Short"},41994:{name:"Sharpness",type:"Short"},41995:{name:"DeviceSettingDescription",type:"Undefined"},41996:{name:"SubjectDistanceRange",type:"Short"},42016:{name:"ImageUniqueID",type:"Ascii"},42032:{name:"CameraOwnerName",type:"Ascii"},42033:{name:"BodySerialNumber",type:"Ascii"},42034:{name:"LensSpecification",type:"Rational"},42035:{name:"LensMake",type:"Ascii"},42036:{name:"LensModel",type:"Ascii"},42037:{name:"LensSerialNumber",type:"Ascii"},42240:{name:"Gamma",type:"Rational"}},GPS:{0:{name:"GPSVersionID",type:"Byte"},1:{name:"GPSLatitudeRef",type:"Ascii"},2:{name:"GPSLatitude",type:"Rational"},3:{name:"GPSLongitudeRef",type:"Ascii"},4:{name:"GPSLongitude",type:"Rational"},5:{name:"GPSAltitudeRef",type:"Byte"},6:{name:"GPSAltitude",type:"Rational"},7:{name:"GPSTimeStamp",type:"Rational"},8:{name:"GPSSatellites",type:"Ascii"},9:{name:"GPSStatus",type:"Ascii"},10:{name:"GPSMeasureMode",type:"Ascii"},11:{name:"GPSDOP",type:"Rational"},12:{name:"GPSSpeedRef",type:"Ascii"},13:{name:"GPSSpeed",type:"Rational"},14:{name:"GPSTrackRef",type:"Ascii"},15:{name:"GPSTrack",type:"Rational"},16:{name:"GPSImgDirectionRef",type:"Ascii"},17:{name:"GPSImgDirection",type:"Rational"},18:{name:"GPSMapDatum",type:"Ascii"},19:{name:"GPSDestLatitudeRef",type:"Ascii"},20:{name:"GPSDestLatitude",type:"Rational"},21:{name:"GPSDestLongitudeRef",type:"Ascii"},22:{name:"GPSDestLongitude",type:"Rational"},23:{name:"GPSDestBearingRef",type:"Ascii"},24:{name:"GPSDestBearing",type:"Rational"},25:{name:"GPSDestDistanceRef",type:"Ascii"},26:{name:"GPSDestDistance",type:"Rational"},27:{name:"GPSProcessingMethod",type:"Undefined"},28:{name:"GPSAreaInformation",type:"Undefined"},29:{name:"GPSDateStamp",type:"Ascii"},30:{name:"GPSDifferential",type:"Short"},31:{name:"GPSHPositioningError",type:"Rational"}},Interop:{1:{name:"InteroperabilityIndex",type:"Ascii"}}};ge["0th"]=ge.Image,ge["1st"]=ge.Image,t.TAGS=ge,t.ImageIFD={ProcessingSoftware:11,NewSubfileType:254,SubfileType:255,ImageWidth:256,ImageLength:257,BitsPerSample:258,Compression:259,PhotometricInterpretation:262,Threshholding:263,CellWidth:264,CellLength:265,FillOrder:266,DocumentName:269,ImageDescription:270,Make:271,Model:272,StripOffsets:273,Orientation:274,SamplesPerPixel:277,RowsPerStrip:278,StripByteCounts:279,XResolution:282,YResolution:283,PlanarConfiguration:284,GrayResponseUnit:290,GrayResponseCurve:291,T4Options:292,T6Options:293,ResolutionUnit:296,TransferFunction:301,Software:305,DateTime:306,Artist:315,HostComputer:316,Predictor:317,WhitePoint:318,PrimaryChromaticities:319,ColorMap:320,HalftoneHints:321,TileWidth:322,TileLength:323,TileOffsets:324,TileByteCounts:325,SubIFDs:330,InkSet:332,InkNames:333,NumberOfInks:334,DotRange:336,TargetPrinter:337,ExtraSamples:338,SampleFormat:339,SMinSampleValue:340,SMaxSampleValue:341,TransferRange:342,ClipPath:343,XClipPathUnits:344,YClipPathUnits:345,Indexed:346,JPEGTables:347,OPIProxy:351,JPEGProc:512,JPEGInterchangeFormat:513,JPEGInterchangeFormatLength:514,JPEGRestartInterval:515,JPEGLosslessPredictors:517,JPEGPointTransforms:518,JPEGQTables:519,JPEGDCTables:520,JPEGACTables:521,YCbCrCoefficients:529,YCbCrSubSampling:530,YCbCrPositioning:531,ReferenceBlackWhite:532,XMLPacket:700,Rating:18246,RatingPercent:18249,ImageID:32781,CFARepeatPatternDim:33421,CFAPattern:33422,BatteryLevel:33423,Copyright:33432,ExposureTime:33434,ImageResources:34377,ExifTag:34665,InterColorProfile:34675,GPSTag:34853,Interlace:34857,TimeZoneOffset:34858,SelfTimerMode:34859,FlashEnergy:37387,SpatialFrequencyResponse:37388,Noise:37389,FocalPlaneXResolution:37390,FocalPlaneYResolution:37391,FocalPlaneResolutionUnit:37392,ImageNumber:37393,SecurityClassification:37394,ImageHistory:37395,ExposureIndex:37397,TIFFEPStandardID:37398,SensingMethod:37399,XPTitle:40091,XPComment:40092,XPAuthor:40093,XPKeywords:40094,XPSubject:40095,PrintImageMatching:50341,DNGVersion:50706,DNGBackwardVersion:50707,UniqueCameraModel:50708,LocalizedCameraModel:50709,CFAPlaneColor:50710,CFALayout:50711,LinearizationTable:50712,BlackLevelRepeatDim:50713,BlackLevel:50714,BlackLevelDeltaH:50715,BlackLevelDeltaV:50716,WhiteLevel:50717,DefaultScale:50718,DefaultCropOrigin:50719,DefaultCropSize:50720,ColorMatrix1:50721,ColorMatrix2:50722,CameraCalibration1:50723,CameraCalibration2:50724,ReductionMatrix1:50725,ReductionMatrix2:50726,AnalogBalance:50727,AsShotNeutral:50728,AsShotWhiteXY:50729,BaselineExposure:50730,BaselineNoise:50731,BaselineSharpness:50732,BayerGreenSplit:50733,LinearResponseLimit:50734,CameraSerialNumber:50735,LensInfo:50736,ChromaBlurRadius:50737,AntiAliasStrength:50738,ShadowScale:50739,DNGPrivateData:50740,MakerNoteSafety:50741,CalibrationIlluminant1:50778,CalibrationIlluminant2:50779,BestQualityScale:50780,RawDataUniqueID:50781,OriginalRawFileName:50827,OriginalRawFileData:50828,ActiveArea:50829,MaskedAreas:50830,AsShotICCProfile:50831,AsShotPreProfileMatrix:50832,CurrentICCProfile:50833,CurrentPreProfileMatrix:50834,ColorimetricReference:50879,CameraCalibrationSignature:50931,ProfileCalibrationSignature:50932,AsShotProfileName:50934,NoiseReductionApplied:50935,ProfileName:50936,ProfileHueSatMapDims:50937,ProfileHueSatMapData1:50938,ProfileHueSatMapData2:50939,ProfileToneCurve:50940,ProfileEmbedPolicy:50941,ProfileCopyright:50942,ForwardMatrix1:50964,ForwardMatrix2:50965,PreviewApplicationName:50966,PreviewApplicationVersion:50967,PreviewSettingsName:50968,PreviewSettingsDigest:50969,PreviewColorSpace:50970,PreviewDateTime:50971,RawImageDigest:50972,OriginalRawFileDigest:50973,SubTileBlockSize:50974,RowInterleaveFactor:50975,ProfileLookTableDims:50981,ProfileLookTableData:50982,OpcodeList1:51008,OpcodeList2:51009,OpcodeList3:51022,NoiseProfile:51041},t.ExifIFD={ExposureTime:33434,FNumber:33437,ExposureProgram:34850,SpectralSensitivity:34852,ISOSpeedRatings:34855,OECF:34856,SensitivityType:34864,StandardOutputSensitivity:34865,RecommendedExposureIndex:34866,ISOSpeed:34867,ISOSpeedLatitudeyyy:34868,ISOSpeedLatitudezzz:34869,ExifVersion:36864,DateTimeOriginal:36867,DateTimeDigitized:36868,ComponentsConfiguration:37121,CompressedBitsPerPixel:37122,ShutterSpeedValue:37377,ApertureValue:37378,BrightnessValue:37379,ExposureBiasValue:37380,MaxApertureValue:37381,SubjectDistance:37382,MeteringMode:37383,LightSource:37384,Flash:37385,FocalLength:37386,SubjectArea:37396,MakerNote:37500,UserComment:37510,SubSecTime:37520,SubSecTimeOriginal:37521,SubSecTimeDigitized:37522,FlashpixVersion:40960,ColorSpace:40961,PixelXDimension:40962,PixelYDimension:40963,RelatedSoundFile:40964,InteroperabilityTag:40965,FlashEnergy:41483,SpatialFrequencyResponse:41484,FocalPlaneXResolution:41486,FocalPlaneYResolution:41487,FocalPlaneResolutionUnit:41488,SubjectLocation:41492,ExposureIndex:41493,SensingMethod:41495,FileSource:41728,SceneType:41729,CFAPattern:41730,CustomRendered:41985,ExposureMode:41986,WhiteBalance:41987,DigitalZoomRatio:41988,FocalLengthIn35mmFilm:41989,SceneCaptureType:41990,GainControl:41991,Contrast:41992,Saturation:41993,Sharpness:41994,DeviceSettingDescription:41995,SubjectDistanceRange:41996,ImageUniqueID:42016,CameraOwnerName:42032,BodySerialNumber:42033,LensSpecification:42034,LensMake:42035,LensModel:42036,LensSerialNumber:42037,Gamma:42240},t.GPSIFD={GPSVersionID:0,GPSLatitudeRef:1,GPSLatitude:2,GPSLongitudeRef:3,GPSLongitude:4,GPSAltitudeRef:5,GPSAltitude:6,GPSTimeStamp:7,GPSSatellites:8,GPSStatus:9,GPSMeasureMode:10,GPSDOP:11,GPSSpeedRef:12,GPSSpeed:13,GPSTrackRef:14,GPSTrack:15,GPSImgDirectionRef:16,GPSImgDirection:17,GPSMapDatum:18,GPSDestLatitudeRef:19,GPSDestLatitude:20,GPSDestLongitudeRef:21,GPSDestLongitude:22,GPSDestBearingRef:23,GPSDestBearing:24,GPSDestDistanceRef:25,GPSDestDistance:26,GPSProcessingMethod:27,GPSAreaInformation:28,GPSDateStamp:29,GPSDifferential:30,GPSHPositioningError:31},t.InteropIFD={InteroperabilityIndex:1},t.GPSHelper={degToDmsRational:function(v){var S=Math.abs(v),x=S%1*60,I=x%1*60,g=Math.floor(S),w=Math.floor(x),T=Math.round(I*100);return[[g,1],[w,1],[T,100]]},dmsRationalToDeg:function(v,S){var x=S==="S"||S==="W"?-1:1,I=v[0][0]/v[0][1]+v[1][0]/v[1][1]/60+v[2][0]/v[2][1]/3600;return I*x}},n.exports&&(e=n.exports=t),e.piexif=t})()}(ar,ar.exports)),ar.exports}Co();async function wn(n){return new Promise(async e=>{try{await pr.initialize();const t=new pr;await t.open(new Uint8Array(await n.arrayBuffer())),await t.unpackThumb();const a=await t.dcrawMakeMemThumb(),l=new File([a.data],n.name.replace(/\.\w+$/,".jpg"),{type:"image/jpeg",lastModified:Date.now()});e(l)}catch(t){console.error("Failed to start DNG conversion:",t),e(null)}})}async function _o(n){try{const e=await wn(n);return e?URL.createObjectURL(e):null}catch(e){return console.error("DNG preview creation failed:",e),null}}function zt(n){const e=[".dng",".raw",".cr2",".cr3",".nef",".arw",".orf",".rw2",".pef",".raf",".3fr",".ari",".bay",".braw",".cap",".crw",".dcr",".dcs",".drf",".eip",".erf",".fff",".gpr",".iiq",".k25",".kdc",".mdc",".mef",".mos",".mrw",".nrw",".obm",".ptx",".r3d",".rwl",".rwz",".sr2",".srf",".srw",".x3f"],t=n.name.toLowerCase();return e.some(a=>t.endsWith(a))}function _t(n){var e;return((e=n.type)==null?void 0:e.startsWith("image/"))&&!zt(n)&&!n.type.includes("tiff")}function Oi(n,e={}){return new Promise((t,a)=>{const{maxWidth:l=2048,maxHeight:c=2048,quality:p=.85}=e;if(!_t(n)){t(n);return}const m=document.createElement("canvas"),P=m.getContext("2d"),A=new Image;A.onload=()=>{try{let{width:k,height:F}=A;k>l&&(F=F*l/k,k=l),F>c&&(k=k*c/F,F=c),m.width=k,m.height=F,P==null||P.drawImage(A,0,0,k,F),m.toBlob(L=>{if(L){const D=new File([L],n.name,{type:n.type,lastModified:n.lastModified});t(D)}else a(new Error("Failed to resize image"))},n.type,p)}catch(k){a(k)}},A.onerror=()=>{a(new Error("Failed to load image for resizing"))},A.src=URL.createObjectURL(n)})}function Vr(n){var a;const t=`
    <svg width="200" height="200" xmlns="http://www.w3.org/2000/svg">
      <rect width="200" height="200" fill="#f3f4f6" stroke="#d1d5db" stroke-width="2"/>
      <text x="100" y="90" text-anchor="middle" font-family="system-ui" font-size="16" fill="#6b7280">
        ${((a=n.name.split(".").pop())==null?void 0:a.toUpperCase())||"RAW"}
      </text>
      <text x="100" y="110" text-anchor="middle" font-family="system-ui" font-size="12" fill="#9ca3af">
        Raw Image
      </text>
      <text x="100" y="130" text-anchor="middle" font-family="system-ui" font-size="10" fill="#9ca3af">
        ${(n.size/(1024*1024)).toFixed(1)} MB
      </text>
    </svg>
  `;return`data:image/svg+xml;base64,${btoa(t)}`}async function ko(n){if(_t(n))return URL.createObjectURL(n);if(zt(n)){const e=await _o(n);return e||Vr(n)}else return Vr(n)}function Po(n){return _t(n)?URL.createObjectURL(n):Vr(n)}function Ao(n){const[e,t]=le.useState(()=>Po(n)),[a,l]=le.useState(!1),[c,p]=le.useState(null);return le.useEffect(()=>{let m=!1;return(async()=>{l(!0),p(null);try{const A=await ko(n);m||t(A)}catch(A){m||p(A instanceof Error?A.message:"Failed to load image")}finally{m||l(!1)}})(),()=>{m=!0}},[n]),le.useEffect(()=>()=>{e&&e.startsWith("blob:")&&URL.revokeObjectURL(e)},[e]),{imageUrl:e,isLoading:a,error:c}}function Bi({file:n,alt:e,className:t,onLoad:a}){const{imageUrl:l,isLoading:c,error:p}=Ao(n);return c?u.jsx("div",{className:`flex items-center justify-center bg-muted ${t}`,children:u.jsx(fa,{className:"w-6 h-6 animate-spin text-muted-foreground"})}):p?u.jsxs("div",{className:`flex flex-col items-center justify-center bg-muted text-muted-foreground ${t}`,children:[u.jsx(Xi,{className:"w-6 h-6 mb-1"}),u.jsx("span",{className:"text-xs text-center",children:"Error loading image"})]}):u.jsx("img",{src:l,alt:e,className:t,onLoad:a})}function Io({files:n,tripId:e,onClose:t}){const[a,l]=le.useState(0),[c,p]=le.useState(0),[m,P]=le.useState([]),[A,k]=le.useState(new Set),[F,L]=le.useState(!1),[D,U]=le.useState(!1),{mutateAsync:$,isPending:de}=ua(),fe=async M=>{for(const z of M){const Z=await Li(z);let re=z,Ie=!1;if(_t(z))try{re=await Oi(z,{maxWidth:2048,maxHeight:2048,quality:.85}),Ie=re.size<z.size}catch(he){console.warn("Failed to resize image:",he),re=z}else if(zt(z)){const he=await wn(z);he&&(re=he,Ie=re.size<z.size)}P(he=>[...he,{file:re,originalFile:z,id:`file-${he.length}-${Date.now()}`,metadata:Z,isRaw:zt(z),isResized:Ie,originalSize:z.size}])}};le.useEffect(()=>{n&&fe(n)},[n]);const{watch:ce,setValue:xe,reset:ge,handleSubmit:v,formState:{isDirty:S,isValid:x}}=Hi({defaultValues:{value:{}}}),{value:I}=ce(),g=async()=>{if(m.length)try{const M=m.map(z=>({file:D?z.originalFile:z.file,metadata:{...z.metadata,fileName:z.file.name}}));await $({request:{tripId:e,files:M},progress:{onUploadProgress:l,onProcessProgress:p}}),Ke.success(`Successfully uploaded ${m.length} photo(s)!`),t()}catch(M){Ke.error(`Failed to upload photos: ${M instanceof Error?M.message:"Unknown error"}`)}},w=M=>{P(z=>z.filter(Z=>Z.id!==M)),k(z=>{const Z=new Set(z);return Z.delete(M),Z})},T=()=>{const M=document.createElement("input");M.type="file",M.multiple=!0,M.accept="image/*,.dng,.raw,.cr2,.nef,.arw,.orf,.rw2",M.onchange=async()=>{const z=M.files;if(z&&z.length>0){const Z=await Promise.all(Array.from(z).map(async(re,Ie)=>{const he=await Li(re);let Ne=re,Ye=!1;if(_t(re))try{Ne=await Oi(re,{maxWidth:2048,maxHeight:2048,quality:.85}),Ye=Ne.size<re.size}catch(Xe){console.warn("Failed to resize image:",Xe),Ne=re}return{file:Ne,originalFile:re,id:`file-${m.length+Ie}-${Date.now()}`,metadata:he,isRaw:zt(re),isResized:Ye,originalSize:re.size}}));P(re=>[...re,...Z])}},M.click()},q=M=>{k(z=>{const Z=new Set(z);return Z.has(M)?Z.delete(M):Z.add(M),Z})},X=()=>{A.size===m.length?k(new Set):k(new Set(m.map(M=>M.id)))},H=M=>{if(A.size===0){Ke.error("Please select files to apply batch metadata");return}P(z=>z.map(Z=>A.has(Z.id)?{...Z,metadata:{...Z.metadata,...M.value}}:Z)),Ke.success(`Applied metadata to ${A.size} file(s)`),k(new Set),L(!1)},te=M=>{if(M===0)return"0 Bytes";const z=1024,Z=["Bytes","KB","MB","GB"],re=Math.floor(Math.log(M)/Math.log(z));return parseFloat((M/Math.pow(z,re)).toFixed(2))+" "+Z[re]};le.useEffect(()=>{if(F){const M=m.find(z=>z.id&&z.id==Array.from(A).at(0));M&&ge({value:M.metadata})}},[F]);const Q=le.useMemo(()=>Math.round((a*.25+c*.75)*100),[a,c]);return u.jsx(u.Fragment,{children:u.jsx(Sa,{open:n!=null,onOpenChange:t,children:u.jsxs(ba,{className:"max-w-6xl max-h-[90vh] overflow-hidden flex flex-col",children:[u.jsxs(xa,{children:[u.jsxs(Ca,{className:"flex items-center gap-2",children:[u.jsx(pi,{className:"w-5 h-5"}),"Upload Photos"]}),u.jsxs(_a,{children:["Upload ",m.length," photo(s) to this trip"]})]}),u.jsxs("div",{className:"flex-1 overflow-hidden flex flex-col gap-4",children:[u.jsxs("div",{className:"flex flex-wrap items-center gap-2 p-3 bg-muted/50 rounded-lg",children:[u.jsxs(Fe,{variant:"outline",size:"sm",onClick:T,disabled:de,className:"gap-2 grow",children:[u.jsx(Or,{className:"w-4 h-4"}),"Add More Files"]}),u.jsxs(Fe,{variant:"outline",size:"sm",onClick:X,disabled:de,className:"gap-2 grow",children:[A.size===m.length?u.jsx(Va,{className:"w-4 h-4"}):u.jsx(ja,{className:"w-4 h-4"}),A.size===m.length?"Deselect All":"Select All"]}),A.size>0&&u.jsxs(Fe,{variant:"outline",size:"sm",onClick:()=>L(!F),disabled:de,className:"gap-2 grow",children:[u.jsx(na,{className:"w-4 h-4"}),F?"Editing":"Edit"," ",A.size," files"]}),m.some(M=>M.isResized)&&u.jsx(Fe,{variant:D?"outline":"secondary",size:"sm",onClick:()=>U(!D),disabled:de,className:"gap-2 grow",children:D?" Original":" Optimized"})]}),F&&A.size>0&&u.jsxs("div",{className:"p-4 border rounded-lg bg-blue-50 dark:bg-blue-950/20",children:[u.jsxs("h4",{className:"font-medium mb-3 text-sm",children:["Apply to ",A.size," selected file(s)"]}),u.jsx(la,{value:I,onChange:M=>xe("value",M)}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx(Fe,{size:"sm",onClick:v(H),disabled:de,children:"Apply Changes"}),u.jsx(Fe,{variant:"outline",size:"sm",onClick:()=>L(!1),children:"Cancel"})]})]}),de&&u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{className:"flex justify-between text-sm",children:[u.jsx("span",{children:Q<1?"Uploading...":"Processing..."}),u.jsxs("span",{children:[Q,"%"]})]}),u.jsx(Aa,{value:Q})]}),u.jsx("div",{className:"flex-1 overflow-auto",children:u.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4",children:m.map(M=>u.jsx("div",{className:"relative group",children:u.jsxs("div",{className:`aspect-square relative overflow-hidden rounded-lg border-2 transition-all ${A.has(M.id)?"border-blue-500":M.metadata.latitude&&M.metadata.longitude?"border-green-300":"border-orange-300"}`,children:[u.jsx("div",{className:"absolute top-2 left-2 z-10",children:u.jsx(_s,{checked:A.has(M.id),onCheckedChange:()=>q(M.id),disabled:de,className:"bg-white/90 border-gray-400"})}),u.jsx("div",{className:"absolute top-2 right-2 z-10",children:M.metadata.longitude&&M.metadata.latitude?u.jsx("div",{className:"p-1 bg-green-500 text-white rounded-full",children:u.jsx(ji,{className:"w-3 h-3"})}):u.jsx("div",{className:"p-1 bg-orange-500 text-white rounded-full",children:u.jsx(Xa,{className:"w-3 h-3"})})}),_t(M.originalFile)?u.jsx(Bi,{file:M.file,alt:M.originalFile.name,className:"w-full h-full object-cover transition-transform group-hover:scale-105",onLoad:z=>{const Z=z.target;Z.src.startsWith("blob:")&&setTimeout(()=>URL.revokeObjectURL(Z.src),1e3)}}):u.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center bg-muted relative",children:[u.jsx(Bi,{file:M.originalFile,alt:M.originalFile.name,className:"w-full h-full object-contain"}),M.isRaw&&u.jsx("div",{className:"absolute bottom-2 left-2 bg-blue-600 text-white px-2 py-1 rounded text-xs font-medium",children:"RAW"})]}),u.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-black/70 text-white p-2 text-xs opacity-0 group-hover:opacity-100 transition-opacity flex flex-col gap-1",children:[u.jsxs("div",{children:[u.jsx("div",{className:"truncate",children:M.originalFile.name}),u.jsx("div",{className:"flex justify-between",children:u.jsxs("span",{children:[te(M.file.size),M.isResized&&u.jsxs("span",{className:"text-green-300 ml-1",children:["(",Math.round((1-M.file.size/M.originalSize)*100),"%)"]})]})})]}),u.jsx("div",{className:"flex gap-2",children:u.jsx("button",{onClick:()=>w(M.id),disabled:de,className:"p-1 bg-red-600 hover:bg-red-700 text-white rounded text-xs disabled:opacity-50",title:"Remove",children:u.jsx(Fa,{className:"w-3 h-3"})})})]})]})},M.id))})}),m.length===0&&u.jsx("div",{className:"flex-1 flex items-center justify-center text-muted-foreground",children:u.jsxs("div",{className:"text-center",children:[u.jsx(Xi,{className:"w-12 h-12 mx-auto mb-2"}),u.jsx("p",{children:"No files selected"})]})})]}),u.jsx(ka,{children:u.jsxs("div",{className:"flex justify-between items-center w-full",children:[u.jsxs("span",{className:"text-sm text-muted-foreground",children:[m.length," file(s)  ",A.size," selected",m.length>0&&u.jsxs("span",{className:"ml-2",children:["Total:"," ",te(m.reduce((M,z)=>M+(D?z.originalSize:z.file.size),0))]})]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx(Pa,{asChild:!0,children:u.jsx(Fe,{variant:"outline",onClick:t,disabled:de,children:"Cancel"})}),u.jsxs(Ht,{loading:de,onClick:g,disabled:m.length===0,className:"gap-2",children:[u.jsx(pi,{className:"w-4 h-4"}),"Upload ",m.length," Photo(s)"]})]})]})})]})})})}const Eo=[{value:"driving-car",label:"Car",icon:""},{value:"driving-hgv",label:"Truck",icon:""},{value:"cycling-regular",label:"Bike",icon:""},{value:"cycling-road",label:"Road Bike",icon:""},{value:"cycling-mountain",label:"Mountain Bike",icon:""},{value:"cycling-electric",label:"E-Bike",icon:""},{value:"foot-walking",label:"Walking",icon:""},{value:"foot-hiking",label:"Hiking",icon:""},{value:"wheelchair",label:"Wheelchair",icon:""}];function Fo({tripId:n}){const e=aa(),t=ha(),a=ma(),{isLoading:l,error:c,data:p,refetch:m}=pa(n),P=L=>Eo.find(U=>U.value===L)||{value:L,label:L,icon:""},A=async L=>{try{e({to:"/admin/$tripId/$routeId",params:{routeId:L.id,tripId:L.trip_id}})}catch(D){const U=D instanceof Error?D.message:"Failed to load route details";Ke.error(U)}},k=async L=>{if(confirm("Are you sure you want to delete this route? This action cannot be undone."))try{await a.mutateAsync(L),Ke.success("Route deleted successfully")}catch(D){const U=D instanceof Error?D.message:"Failed to delete route";Ke.error(U)}},F=async()=>{const{id:L}=await t.mutateAsync({trip_id:n,title:"My New Route",description:"",profile:"driving-car",stops:[]})};return l?u.jsx(sr,{children:u.jsx(or,{className:"p-6",children:u.jsx("div",{className:"flex items-center justify-center",children:u.jsx("div",{className:"text-center",children:u.jsx(sa,{})})})})}):c?u.jsx(Ta,{variant:"destructive",children:u.jsxs(La,{children:[c.message,u.jsx(Fe,{variant:"outline",size:"sm",onClick:()=>m(),className:"ml-2",children:"Retry"})]})}):u.jsxs("div",{className:"space-y-4",children:[u.jsx("div",{children:u.jsxs(Ht,{onClick:F,size:"sm",loading:t.isPending,children:[u.jsx(Or,{className:"h-4 w-4 mr-1"}),"Create Route"]})}),(p==null?void 0:p.length)===0?u.jsx(sr,{children:u.jsx(or,{className:"p-6",children:u.jsxs("div",{className:"text-center",children:[u.jsx(zi,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),u.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No routes yet"}),u.jsx("p",{className:"text-gray-600 mb-4",children:"Create your first route to plan your journey with multiple stops."}),u.jsxs(Ht,{onClick:F,loading:t.isPending,children:[u.jsx(Or,{className:"h-4 w-4 mr-1"}),"Create First Route"]})]})})}):u.jsx("div",{className:"grid grid-cols-[repeat(auto-fill,minmax(200px,1fr))]",children:p==null?void 0:p.map(L=>{const D=P(L.profile);return u.jsxs(sr,{className:"hover:shadow-md transition-shadow-",children:[u.jsx(Vi,{className:"pb-3",children:u.jsxs(Wi,{className:"text-base flex items-start justify-between",children:[u.jsx("span",{className:"flex-1 text-nowrap",children:L.title}),u.jsxs("div",{className:"flex items-center gap-1 ml-2",children:[u.jsx(Fe,{variant:"ghost",size:"sm",onClick:()=>A(L),className:"h-8 w-8 p-0",children:u.jsx(za,{className:"h-4 w-4"})}),u.jsx(Fe,{variant:"ghost",size:"sm",onClick:()=>k(L.id),className:"h-8 w-8 p-0 text-red-600 hover:text-red-700 hover:bg-red-50",children:u.jsx(Gi,{className:"h-4 w-4"})})]})]})}),u.jsxs(or,{className:"space-y-3",children:[L.description&&u.jsx("p",{className:"text-sm text-gray-600",children:L.description}),u.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:u.jsxs(Ra,{variant:"outline",className:"flex items-center gap-1",children:[u.jsx("span",{children:D.icon}),D.label]})}),u.jsx("div",{className:"space-y-2",children:u.jsx("div",{className:"flex items-center gap-4 text-sm",children:u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx(ji,{className:"h-4 w-4 text-gray-500"}),u.jsxs("span",{className:"text-gray-600",children:[L.stops.length," Stops"]})]})})}),u.jsxs("div",{className:"text-xs text-gray-500 border-t pt-2",children:["Created: ",new Date(L.created_at).toLocaleDateString(),L.updated_at!==L.created_at&&u.jsxs(u.Fragment,{children:[" "," Updated:"," ",new Date(L.updated_at).toLocaleDateString()]})]})]})]},L.id)})})]})}const Do=()=>{const{tripId:n}=oa.useParams(),[e,t]=le.useState(null),[a,l]=le.useState(new Set),[c,p]=le.useState(!1),{data:m,isLoading:P}=ga(n),A=ya(),{data:k,isLoading:F}=wa(n),{mutateAsync:L,isPending:D}=va(),U=g=>({name:(g==null?void 0:g.name)||"",description:(g==null?void 0:g.description)||"",start_date:(g==null?void 0:g.start_date)||"",end_date:(g==null?void 0:g.end_date)||""}),$=Hi({defaultValues:U(m)}),{handleSubmit:de,reset:fe,formState:{isSubmitting:ce,isValid:xe,isDirty:ge}}=$;le.useEffect(()=>{m&&fe(U(m))},[m,fe]);const v=async g=>{if(!(!xe||!ge))try{await A.mutateAsync({id:n,data:g}),fe(g),p(!1),Ke.success("Trip updated successfully")}catch{Ke.error("Failed to update trip")}},S=async g=>{g.length!==0&&(await L(g),l(new Set),t(null))},x=async()=>{const g=document.createElement("input");g.type="file",g.multiple=!0,g.accept="image/*,.dng,.raw,.cr2,.nef,.arw,.orf,.rw2",g.onchange=async()=>{const w=g.files;!w||w.length===0||t(Array.from(w))},g.click()},I=()=>{k&&((a==null?void 0:a.size)===k.count?l==null||l(new Set):l==null||l(new Set(k==null?void 0:k.all.map(g=>g.id))))};return u.jsxs("div",{className:"grow flex w-full flex-col gap-4",children:[u.jsx(Ma,{...$,children:u.jsx("form",{onSubmit:de(v),className:"flex flex-col gap-4",children:u.jsxs(sr,{children:[u.jsx(Vi,{children:u.jsx(Wi,{children:c?"Editing trip":`Admin Panel for Trip ${m==null?void 0:m.name}`})}),u.jsxs(or,{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsx(Jt,{control:$.control,name:"name",render:({field:g})=>u.jsxs(Qt,{children:[u.jsx(Zt,{children:"Trip Name"}),c?u.jsxs(u.Fragment,{children:[u.jsx(er,{children:u.jsx(ui,{...g,className:"input",placeholder:"Trip name"})}),u.jsx(tr,{})]}):u.jsx("p",{className:"text-muted-foreground text-sm",children:m==null?void 0:m.name})]})}),u.jsx(Jt,{control:$.control,name:"description",render:({field:g})=>u.jsxs(Qt,{children:[u.jsx(Zt,{children:"Description"}),c?u.jsxs(u.Fragment,{children:[u.jsx(er,{children:u.jsx(ui,{...g,className:"input",placeholder:"Trip description"})}),u.jsx(tr,{})]}):u.jsx("p",{className:"text-muted-foreground text-sm",children:(m==null?void 0:m.description)||"No description available"})]})}),u.jsx(Jt,{control:$.control,name:"start_date",render:({field:g})=>u.jsxs(Qt,{children:[u.jsx(Zt,{children:"Start Date"}),c?u.jsxs(u.Fragment,{children:[u.jsx(er,{children:u.jsx(mi,{value:g.value?new Date(g.value):void 0,onChange:w=>g.onChange(w==null?void 0:w.toISOString()),className:"grow w-full"})}),u.jsx(tr,{})]}):u.jsx("p",{className:"text-muted-foreground text-sm",children:hi(m==null?void 0:m.start_date)})]})}),u.jsx(Jt,{control:$.control,name:"end_date",render:({field:g})=>u.jsxs(Qt,{children:[u.jsx(Zt,{children:"End Date"}),c?u.jsxs(u.Fragment,{children:[u.jsx(er,{children:u.jsx(mi,{value:g.value?new Date(g.value):void 0,onChange:w=>g.onChange(w==null?void 0:w.toISOString()),className:"grow w-full"})}),u.jsx(tr,{})]}):u.jsx("p",{className:"text-muted-foreground text-sm",children:hi(m==null?void 0:m.end_date)})]})})]}),u.jsx(Da,{className:"flex gap-2",children:c?u.jsxs(u.Fragment,{children:[u.jsx(Ht,{type:"submit",loading:ce,disabled:!xe||!ge,children:"Save Changes"}),u.jsx(Fe,{variant:"outline",onClick:()=>p(!1),disabled:ce,children:"Cancel"})]}):u.jsx(Fe,{variant:"outline",onClick:()=>p(!0),children:"Edit Trip"})})]})})}),u.jsxs("div",{className:"grow w-full flex flex-col gap-4",children:[u.jsx(Io,{files:e,tripId:n,onClose:()=>t(null)}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2",children:[u.jsxs("div",{className:"flex flex-col gap-2",children:[u.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[u.jsx(zi,{className:"h-5 w-5"}),"Routes"]}),u.jsx(Fo,{tripId:n})]}),u.jsxs("div",{className:"flex flex-col gap-2",children:[u.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[u.jsx(Oa,{className:"h-5 w-5"}),"Photos"]}),u.jsxs("div",{className:"flex items-center gap-4 z-10",children:[u.jsx(Fe,{onClick:x,children:"Upload"}),k&&u.jsx(Fe,{variant:"outline",size:"sm",onClick:I,children:(a==null?void 0:a.size)===k.count?"Deselect All":"Select All"}),(a==null?void 0:a.size)!=null&&a.size>0&&u.jsxs(Ht,{variant:"destructive",size:"sm",loading:D,onClick:()=>S(Array.from(a)),className:"gap-1",children:[u.jsx(Gi,{className:"w-4 h-4"}),"Delete (",(a==null?void 0:a.size)||0,")"]})]}),u.jsxs("div",{className:"text-sm text-muted-foreground",children:[(a==null?void 0:a.size)||0," of ",(k==null?void 0:k.count)||0," selected"]}),u.jsx(da,{onClickPhoto:()=>{},photos:k,loading:F,onSelectionChange:l,selectedPhotos:a})]})]})]})]})},$o=function(){return u.jsx(ca,{requireAdmin:!0,children:u.jsx(Do,{})})};export{$o as component};

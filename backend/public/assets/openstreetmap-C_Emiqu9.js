import{r as f,T as he,R as H,l as K,X as me,Y as ge,j as I,Z as ve,b as ye,w as be,$ as pe}from"./index-28yYTQYt.js";function Le(){const[e,n]=f.useState(window.navigator.onLine);return f.useEffect(()=>{const t=()=>{n(!0)},o=()=>{n(!1)};return window.addEventListener("online",t),window.addEventListener("offline",o),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",o)}},[]),e}function ie(e,n){const t=f.useRef(n);f.useEffect(function(){n!==t.current&&e.attributionControl!=null&&(t.current!=null&&e.attributionControl.removeAttribution(t.current),n!=null&&e.attributionControl.addAttribution(n)),t.current=n},[e,n])}const we=1;function Te(e){return Object.freeze({__version:we,map:e})}function xe(e,n){return Object.freeze({...e,...n})}const F=f.createContext(null);function J(){const e=f.use(F);if(e==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return e}function re(e){function n(t,o){const{instance:r,context:s}=e(t).current;f.useImperativeHandle(o,()=>r);const{children:a}=t;return a==null?null:H.createElement(F,{value:s},a)}return f.forwardRef(n)}function Se(e){function n(t,o){const[r,s]=f.useState(!1),{instance:a}=e(t,s).current;f.useImperativeHandle(o,()=>a),f.useEffect(function(){r&&a.update()},[a,r,t.children]);const y=a._contentNode;return y?he.createPortal(t.children,y):null}return f.forwardRef(n)}function Oe(e){function n(t,o){const{instance:r}=e(t).current;return f.useImperativeHandle(o,()=>r),null}return f.forwardRef(n)}function Y(e,n){const t=f.useRef(void 0);f.useEffect(function(){return n!=null&&e.instance.on(n),t.current=n,function(){t.current!=null&&e.instance.off(t.current),t.current=null}},[e,n])}function j(e,n){const t=e.pane??n.pane;return t?{...e,pane:t}:e}function Ee(e,n){return function(o,r){const s=J(),a=e(j(o,s),s);return ie(s.map,o.attribution),Y(a.current,o.eventHandlers),n(a.current,s,o,r),a}}function se(e,n,t){return Object.freeze({instance:e,context:n,container:t})}function z(e,n){return n==null?function(o,r){const s=f.useRef(void 0);return s.current||(s.current=e(o,r)),s}:function(o,r){const s=f.useRef(void 0);s.current||(s.current=e(o,r));const a=f.useRef(o),{instance:y}=s.current;return f.useEffect(function(){a.current!==o&&(n(y,o,a.current),a.current=o)},[y,o,n]),s}}function ae(e,n){f.useEffect(function(){return(n.layerContainer??n.map).addLayer(e.instance),function(){var s;(s=n.layerContainer)==null||s.removeLayer(e.instance),n.map.removeLayer(e.instance)}},[n,e])}function ce(e){return function(t){const o=J(),r=e(j(t,o),o);return ie(o.map,t.attribution),Y(r.current,t.eventHandlers),ae(r.current,o),r}}function _e(e,n){const t=f.useRef(void 0);f.useEffect(function(){if(n.pathOptions!==t.current){const r=n.pathOptions??{};e.instance.setStyle(r),t.current=r}},[e,n])}function Ce(e){return function(t){const o=J(),r=e(j(t,o),o);return Y(r.current,t.eventHandlers),ae(r.current,o),_e(r.current,t),r}}function Ie(e,n){const t=z(e,n),o=ce(t);return re(o)}function tt(e,n){const t=z(e),o=Ee(t,n);return Se(o)}function nt(e,n){const t=z(e,n),o=Ce(t);return re(o)}function Be(e,n){const t=z(e,n),o=ce(t);return Oe(o)}function De(e,n,t){const{opacity:o,zIndex:r}=n;o!=null&&o!==t.opacity&&e.setOpacity(o),r!=null&&r!==t.zIndex&&e.setZIndex(r)}function Re({bounds:e,boundsOptions:n,center:t,children:o,className:r,id:s,placeholder:a,style:y,whenReady:m,zoom:g,...x},E){const[S]=f.useState({className:r,id:s,style:y}),[p,O]=f.useState(null),_=f.useRef(void 0);f.useImperativeHandle(E,()=>(p==null?void 0:p.map)??null,[p]);const M=f.useCallback(C=>{if(C!==null&&!_.current){const w=new K.Map(C,x);_.current=w,t!=null&&g!=null?w.setView(t,g):e!=null&&w.fitBounds(e,n),m!=null&&w.whenReady(m),O(Te(w))}},[]);f.useEffect(()=>()=>{p==null||p.map.remove()},[p]);const P=p?H.createElement(F,{value:p},o):a??null;return H.createElement("div",{...S,ref:M},P)}const je=f.forwardRef(Re),ot=Ie(function({position:n,...t},o){const r=new K.Marker(n,t);return se(r,xe(o,{overlayContainer:r}))},function(n,t,o){t.position!==o.position&&n.setLatLng(t.position),t.icon!=null&&t.icon!==o.icon&&n.setIcon(t.icon),t.zIndexOffset!=null&&t.zIndexOffset!==o.zIndexOffset&&n.setZIndexOffset(t.zIndexOffset),t.opacity!=null&&t.opacity!==o.opacity&&n.setOpacity(t.opacity),n.dragging!=null&&t.draggable!==o.draggable&&(t.draggable===!0?n.dragging.enable():n.dragging.disable())}),ze=Be(function({url:n,...t},o){const r=new K.TileLayer(n,j(t,o));return se(r,o)},function(n,t,o){De(n,t,o);const{url:r}=t;r!=null&&r!==o.url&&n.setUrl(r)});var B={exports:{}};const Me=(e,n)=>n.some(t=>e instanceof t);let ee,te;function Pe(){return ee||(ee=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ke(){return te||(te=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const ue=new WeakMap,V=new WeakMap,le=new WeakMap,U=new WeakMap,$=new WeakMap;function Ae(e){const n=new Promise((t,o)=>{const r=()=>{e.removeEventListener("success",s),e.removeEventListener("error",a)},s=()=>{t(L(e.result)),r()},a=()=>{o(e.error),r()};e.addEventListener("success",s),e.addEventListener("error",a)});return n.then(t=>{t instanceof IDBCursor&&ue.set(t,e)}).catch(()=>{}),$.set(n,e),n}function Ue(e){if(V.has(e))return;const n=new Promise((t,o)=>{const r=()=>{e.removeEventListener("complete",s),e.removeEventListener("error",a),e.removeEventListener("abort",a)},s=()=>{t(),r()},a=()=>{o(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",s),e.addEventListener("error",a),e.addEventListener("abort",a)});V.set(e,n)}let W={get(e,n,t){if(e instanceof IDBTransaction){if(n==="done")return V.get(e);if(n==="objectStoreNames")return e.objectStoreNames||le.get(e);if(n==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return L(e[n])},set(e,n,t){return e[n]=t,!0},has(e,n){return e instanceof IDBTransaction&&(n==="done"||n==="store")?!0:n in e}};function Ze(e){W=e(W)}function Ne(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(n,...t){const o=e.call(R(this),n,...t);return le.set(o,n.sort?n.sort():[n]),L(o)}:ke().includes(e)?function(...n){return e.apply(R(this),n),L(ue.get(this))}:function(...n){return L(e.apply(R(this),n))}}function He(e){return typeof e=="function"?Ne(e):(e instanceof IDBTransaction&&Ue(e),Me(e,Pe())?new Proxy(e,W):e)}function L(e){if(e instanceof IDBRequest)return Ae(e);if(U.has(e))return U.get(e);const n=He(e);return n!==e&&(U.set(e,n),$.set(n,e)),n}const R=e=>$.get(e);function Ve(e,n,{blocked:t,upgrade:o,blocking:r,terminated:s}={}){const a=indexedDB.open(e,n),y=L(a);return o&&a.addEventListener("upgradeneeded",m=>{o(L(a.result),m.oldVersion,m.newVersion,L(a.transaction),m)}),t&&a.addEventListener("blocked",m=>t(m.oldVersion,m.newVersion,m)),y.then(m=>{s&&m.addEventListener("close",()=>s()),r&&m.addEventListener("versionchange",g=>r(g.oldVersion,g.newVersion,g))}).catch(()=>{}),y}function We(e,{blocked:n}={}){const t=indexedDB.deleteDatabase(e);return n&&t.addEventListener("blocked",o=>n(o.oldVersion,o)),L(t).then(()=>{})}const Ke=["get","getKey","getAll","getAllKeys","count"],Fe=["put","add","delete","clear"],Z=new Map;function ne(e,n){if(!(e instanceof IDBDatabase&&!(n in e)&&typeof n=="string"))return;if(Z.get(n))return Z.get(n);const t=n.replace(/FromIndex$/,""),o=n!==t,r=Fe.includes(t);if(!(t in(o?IDBIndex:IDBObjectStore).prototype)||!(r||Ke.includes(t)))return;const s=async function(a,...y){const m=this.transaction(a,r?"readwrite":"readonly");let g=m.store;return o&&(g=g.index(y.shift())),(await Promise.all([g[t](...y),r&&m.done]))[0]};return Z.set(n,s),s}Ze(e=>({...e,get:(n,t,o)=>ne(n,t)||e.get(n,t,o),has:(n,t)=>!!ne(n,t)||e.has(n,t)}));const Je=Object.freeze(Object.defineProperty({__proto__:null,deleteDB:We,openDB:Ve,unwrap:R,wrap:L},Symbol.toStringTag,{value:"Module"})),Ye=me(Je);var $e=B.exports,oe;function Ge(){return oe||(oe=1,function(e,n){(function(t,o){o(n,ge(),Ye)})($e,function(t,o,r){function s(d,i,c,u){function v(l){return l instanceof c?l:new c(function(h){h(l)})}return new(c||(c=Promise))(function(l,h){function b(T){try{k(u.next(T))}catch(A){h(A)}}function D(T){try{k(u.throw(T))}catch(A){h(A)}}function k(T){T.done?l(T.value):v(T.value).then(b,D)}k((u=u.apply(d,[])).next())})}const a="tileStore",y="urlTemplate";let m;function g(){return m||(m=r.openDB("leaflet.offline",2,{upgrade(d,i){if(r.deleteDB("leaflet_offline"),r.deleteDB("leaflet_offline_areas"),i<1){const c=d.createObjectStore(a,{keyPath:"key"});c.createIndex(y,"urlTemplate"),c.createIndex("z","z")}}}),m)}function x(){return s(this,void 0,void 0,function*(){return(yield g()).count(a)})}function E(d){return s(this,void 0,void 0,function*(){const i=IDBKeyRange.only(d);return(yield g()).getAllFromIndex(a,y,i)})}function S(d){return s(this,void 0,void 0,function*(){const i=yield fetch(d);if(!i.ok)throw new Error(`Request failed with status ${i.statusText}`);return i.blob()})}function p(d,i){return s(this,void 0,void 0,function*(){return(yield g()).put(a,Object.assign({blob:i},d))})}function O(d,i){return o.Util.template(d,Object.assign(Object.assign({},i),{r:o.Browser.retina?"@2x":""}))}function _(d,i){const c=[];if(!d.min||!d.max)return c;const u=d.min.divideBy(i.x).floor(),v=d.max.divideBy(i.x).floor();for(let l=u.y;l<=v.y;l+=1)for(let h=u.x;h<=v.x;h+=1)c.push(new o.Point(h,l));return c}function M(d,i){const c={type:"FeatureCollection",features:[]};for(let u=0;u<i.length;u+=1){const v=new o.Point(i[u].x*d.x,i[u].y*d.y),l=new o.Point(v.x+d.x,v.y+d.y),h=o.CRS.EPSG3857.pointToLatLng(v,i[u].z),b=o.CRS.EPSG3857.pointToLatLng(l,i[u].z);c.features.push({type:"Feature",properties:i[u],geometry:{type:"Polygon",coordinates:[[[h.lng,h.lat],[b.lng,h.lat],[b.lng,b.lat],[h.lng,b.lat],[h.lng,h.lat]]]}})}return c}function P(d){return s(this,void 0,void 0,function*(){return(yield g()).delete(a,d)})}function C(d){return s(this,void 0,void 0,function*(){return(yield g()).get(a,d).then(i=>i&&i.blob)})}function w(d){return s(this,void 0,void 0,function*(){return(yield(yield g()).getKey(a,d))!==void 0})}function G(){return s(this,void 0,void 0,function*(){return(yield g()).clear(a)})}function q(d,i){return s(this,void 0,void 0,function*(){if(!(yield w(d)))return i;const u=yield C(d);return URL.createObjectURL(u)})}class de extends o.TileLayer{createTile(i,c){const u=document.createElement("img");return o.DomEvent.on(u,"load",o.Util.bind(this._tileOnLoad,this,c,u)),o.DomEvent.on(u,"error",o.Util.bind(this._tileOnError,this,c,u)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(u.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),u.alt="",u.setAttribute("role","presentation"),q(this._getStorageKey(i),this.getTileUrl(i)).then(v=>u.src=v),u}_getStorageKey(i){return O(this._url,Object.assign(Object.assign(Object.assign({},i),this.options),{s:this.options.subdomains[0]}))}getTileUrls(i,c){var u;const v=[],l=_(i,this.getTileSize());for(let h=0;h<l.length;h+=1){const b=l[h],D=Object.assign(Object.assign({},this.options),{x:b.x,y:b.y,z:c+(this.options.zoomOffset||0)});v.push({key:O(this._url,Object.assign(Object.assign({},D),{s:(u=this.options.subdomains)===null||u===void 0?void 0:u[0]})),url:O(this._url,Object.assign(Object.assign({},D),{s:this._getSubdomain(b)})),z:c,x:b.x,y:b.y,urlTemplate:this._url,createdAt:Date.now()})}return v}}function X(d,i){return new de(d,i)}window.L&&(window.L.tileLayer.offline=X);class fe extends o.Control{constructor(i,c){super(c),this.status={storagesize:0,lengthToBeSaved:0,lengthSaved:0,lengthLoaded:0,_tilesforSave:[]},this._baseLayer=i,this.setStorageSize(),this.options=Object.assign({position:"topleft",saveText:"+",rmText:"-",maxZoom:19,saveWhatYouSee:!1,bounds:null,confirm:null,confirmRemoval:null,parallel:50,zoomlevels:void 0,alwaysDownload:!0},c)}setStorageSize(){return this.status.storagesize?Promise.resolve(this.status.storagesize):x().then(i=>(this.status.storagesize=i,this._baseLayer.fire("storagesize",this.status),i)).catch(()=>0)}getStorageSize(i){this.setStorageSize().then(c=>{i&&i(c)})}setLayer(i){this._baseLayer=i}onAdd(){const i=o.DomUtil.create("div","savetiles leaflet-bar"),{options:c}=this;return this._createButton(c.saveText,"savetiles",i,this._saveTiles),this._createButton(c.rmText,"rmtiles",i,this._rmTiles),i}_createButton(i,c,u,v){const l=o.DomUtil.create("a",c,u);return l.innerHTML=i,l.href="#",l.ariaRoleDescription="button",o.DomEvent.on(l,"mousedown dblclick",o.DomEvent.stopPropagation).on(l,"click",o.DomEvent.stop).on(l,"click",v,this).on(l,"click",this._refocusOnMap,this),l}_saveTiles(){const i=this._calculateTiles();this._resetStatus(i);const c=()=>s(this,void 0,void 0,function*(){this._baseLayer.fire("savestart",this.status);const u=()=>s(this,void 0,void 0,function*(){const l=i.shift();if(l===void 0)return Promise.resolve();const h=yield this._loadTile(l);return h&&(yield this._saveTile(l,h)),u()}),v=Math.min(i.length,this.options.parallel);for(let l=0;l<v;l+=1)u()});this.options.confirm?this.options.confirm(this.status,c):c()}_calculateTiles(){let i=[],u=[];if(this.options.saveWhatYouSee){const l=this._map.getZoom();if(l<5)throw new Error("It's not possible to save with zoom below level 5.");const{maxZoom:h}=this.options;for(let b=l;b<=h;b+=1)u.push(b)}else u=this.options.zoomlevels||[this._map.getZoom()];const v=this.options.bounds||this._map.getBounds();for(let l=0;l<u.length;l+=1){const h=o.bounds(this._map.project(v.getNorthWest(),u[l]),this._map.project(v.getSouthEast(),u[l]));i=i.concat(this._baseLayer.getTileUrls(h,u[l]))}return i}_resetStatus(i){this.status={lengthLoaded:0,lengthToBeSaved:i.length,lengthSaved:0,_tilesforSave:i,storagesize:this.status.storagesize}}_loadTile(i){return s(this,void 0,void 0,function*(){let c;return(this.options.alwaysDownload===!0||(yield w(i.key))===!1)&&(c=yield S(i.url),this.status.lengthLoaded+=1),this.status.lengthLoaded+=1,this._baseLayer.fire("loadtileend",this.status),this.status.lengthLoaded===this.status.lengthToBeSaved&&this._baseLayer.fire("loadend",this.status),c})}_saveTile(i,c){return s(this,void 0,void 0,function*(){yield p(i,c),this.status.lengthSaved+=1,this._baseLayer.fire("savetileend",this.status),this.status.lengthSaved===this.status.lengthToBeSaved&&(this._baseLayer.fire("saveend",this.status),this.setStorageSize())})}_rmTiles(){const i=()=>{G().then(()=>{this.status.storagesize=0,this._baseLayer.fire("tilesremoved"),this._baseLayer.fire("storagesize",this.status)})};this.options.confirmRemoval?this.options.confirmRemoval(this.status,i):i()}}function Q(d,i){return new fe(d,i)}window.L&&(window.L.control.savetiles=Q),t.downloadTile=S,t.getBlobByKey=C,t.getStorageInfo=E,t.getStorageLength=x,t.getStoredTilesAsJson=M,t.getTileImageSource=q,t.getTilePoints=_,t.getTileUrl=O,t.hasTile=w,t.removeTile=P,t.saveTile=p,t.savetiles=Q,t.tileLayerOffline=X,t.truncate=G})}(B,B.exports)),B.exports}var N=Ge();const qe=be("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function Xe({className:e,variant:n,asChild:t=!1,...o}){const r=t?ve:"span";return I.jsx(r,{"data-slot":"badge",className:ye(qe({variant:n}),e),...o})}const Qe="https://tiles.stadiamaps.com/tiles/outdoors/{z}/{x}/{y}{r}.{ext}";pe();function it({children:e,...n}){const t=Le(),o=r=>{const{tile:s}=r,a=s.src;s.src="",N.getBlobByKey(a).then(y=>{if(y){s.src=URL.createObjectURL(y);return}s.src=a;const{x:m,y:g,z:x}=r.coords,{_url:E}=r.target,S={key:a,url:a,x:m,y:g,z:x,urlTemplate:E,createdAt:Date.now()};N.downloadTile(a).then(p=>N.saveTile(S,p))})};return t?I.jsxs(je,{...n,zoomSnap:0,zoomAnimation:!0,zoomDelta:20,scrollWheelZoom:!1,smoothWheelZoom:!0,smoothSensitivity:5,children:[I.jsx(ze,{url:Qe,attribution:'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery &copy; <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:20,minZoom:0,eventHandlers:{tileloadstart:o},ext:"png",accessToken:"pk.eyJ1IjoiYXNrZTExMzEiLCJhIjoiY21lM3pjY2l0MGMzejJtc2Jra3llbTVudCJ9.hswgAAtfWRSwU1vZOhn6PA"}),!t&&I.jsx(Xe,{variant:"destructive",className:"z-999 absolute right-2 top-2",children:"Offline"}),e]}):I.jsx("div",{})}export{Xe as B,ot as M,it as O,ze as T,se as a,nt as b,tt as c,xe as e,J as u};
